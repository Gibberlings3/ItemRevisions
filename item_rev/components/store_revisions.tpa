INCLUDE ~item_rev/lib/compatibility.tpa~
INCLUDE ~item_rev/lib/identify_weapon.tpa~
INCLUDE ~item_rev/lib/store_rev_macros.tpa~

///////////////////////////////////////////////////////////////////

// use this detection check - 'FILE_EXISTS_IN_GAME ag#store_revisions.mrk'
COPY ag#dummy ~override/ag#store_revisions.mrk~

LAM buy_group
LAM spelldesc
LAF make_scrolls END


// increase bag capacity a little
ACTION_FOR_EACH file IN
  bag02 bag02b bag02c bag02d bag02e bag02f bag02g bag02h bag02i // gem bag
  bag03 bag03b bag03c bag03d bag03e bag03f bag03g bag03h bag03i // scroll case
BEGIN
  COPY_EXISTING ~%file%.sto~ override PATCH_IF SOURCE_SIZE>0x9b BEGIN
    WRITE_SHORT 0x22 50
  END BUT_ONLY
END


/*
//anybody tell me why i've been making them sellable?

COPY_EXISTING fireseed.itm override PATCH_IF SOURCE_SIZE>0x71 BEGIN
  WRITE_BYTE 0x18 (BYTE_AT 0x18)|1
  WRITE_LONG 0x34 75
END

COPY_EXISTING gberry.itm override PATCH_IF SOURCE_SIZE>0x71 BEGIN
  WRITE_BYTE 0x18 (BYTE_AT 0x18)|1
  WRITE_LONG 0x34 3
END
*/

///////////////////////////////////////////////////////////////////

// stores buy items at % of their real price:
//   innkeepers - 15
//   fences - 10
//   temples - don't buy
//   normal stores - 25
// 
// stores sell items at % of their real price:
//   innkeepers - 155
//   fences - 145
//   temples - 145
//   official city stores - 165
//   normal stores - 155
//   spell stores, artifact dealers, jewellers - plus 10-20%
//   countryside stores - minus 10-20%
// 
// and about 10-15 exceptions to the rule, but it pains me to make a detailed list. Will only do upon request

// temple services:
//   call_lightning       =5
//   cure_light_wounds    =25
//   dispel_magic         =200
//   remove_curse         =500
//   cure_medium_wounds   =50
//   cure_disease         =300
//   cure_serious_wounds  =75
//   neutralize_poison    =300
//   lesser_restoration   =750
//   cure_critical_wounds =100
//   raise_dead           =1000
//   mass_cure            =1000
//   heal                 =1000
//   resurrection         =2000
//   greater_restoration  =2000


/////////////////////////
// Waukeen's Promenade //
/////////////////////////

//////////////////

// RIBALD - Ribald
//
// loses scrolls, potions and mundane armor/weapons, and about half of his artifacts
// instead gains few uniques from Deidre/Joluv, and some other stuff

// receives potions back from Joluv, the latter is excluded from this component and is reserved for dumping mod-added items there

// 100% stock overwite

// Varscona
COPY_EXISTING ribald.cre override LPF FJ_CRE_VALIDITY RET valid=valid END PATCH_IF valid BEGIN
  REMOVE_CRE_ITEM sw1h06
END BUT_ONLY

// Ring of Fire Control
COPY_EXISTING uddwarf.cre override LPF FJ_CRE_VALIDITY RET valid=valid END PATCH_IF valid BEGIN
  REMOVE_CRE_ITEM ring27
END BUT_ONLY

COPY_EXISTING ribald.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 jewel=1 misc=1 potn=1 END
  REMOVE_STORE_ITEM
    AX1H01    // Battle Axe
    AX1H04    // Throwing Axe
    AX1H02    // Battle Axe +1
    BLUN01    // Club
    BLUN02    // Flail
    BLUN04    // Mace
    BLUN06    // Morning Star
    BLUN03    // Flail +1
    BLUN05    // Mace +1
    BLUN13    // Flail +2
    DAGG01    // Dagger
    DAGG05    // Throwing Dagger
    DAGG02    // Dagger +1
    DART01    // Dart
    DART02    // Dart +1
    HALB01    // Halberd
    HALB03    // Halberd +2
    HAMM01    // War Hammer
    HAMM05    // War Hammer +2
    HAMM02    // War Hammer +1
    HAMM08    // War Hammer +2
    SLNG01    // Sling 
    SLNG04    // Sling +2
    SPER01    // Spear
    SPER02    // Spear +1
    SPER05    // Spear +2
    STAF01    // Quarterstaff
    STAF18    // Quarter Staff +2
    STAF06    // Staff Mace
    STAF20    // Staff of Rynn +4
    SW1H01    // Bastard Sword 
    SW1H04    // Long Sword 
    SW1H07    // Short Sword 
    SW1H20    // Scimitar
    SW1H43    // Katana
    SW1H46    // Wakizashi
    SW1H48    // Ninja-To
    SW1H05    // Long Sword +1
    SW1H08    // Short Sword +1
    SW1H02    // Bastard Sword +1
    SW1H29    // Short Sword +2
    SW1H22    // Scimitar +1
    SW1H44    // Katana +1
    SW2H01    // Two Handed Sword
    SW2H02    // Two Handed Sword +1
    XBOW01    // Heavy Crossbow
    XBOW04    // Light Crossbow
    XBOW02    // Heavy Crossbow +1
    XBOW05    // Light Crossbow +1
    XBOW14    // Heavy Crossbow of Searing +1
    XBOW07    // Heavy Crossbow +2
    XBOW08    // Giant Hair Crossbow +3
    BOW05     // Short Bow
    BOW03     // Long Bow
    BOW01     // Composite Long Bow
    BOW04     // Long Bow +1
    BOW02     // Composite Long Bow +1
    BOW06     // Short Bow +1
    BOW18     // Short Bow +2
    BOW17     // Long Bow +2
    BOW11     // Strong Arm +2
    AROW01    // Arrows
    AROW11    // Arrow +2
    AROW02    // Arrows +1
    BOLT01    // Bolt
    BOLT02    // Bolt +1
    BOLT06    // Bolt +2
    BULL01    // Bullet
    BULL02    // Bullet +1
    BULL03    // Bullet +2
    CHAN01    // Chain Mail Armor
    CHAN04    // Splint Mail
    CHAN08    // Chain Mail +2
    CHAN05    // Splint Mail +1
    LEAT01    // Leather Armor
    LEAT04    // Studded Leather Armor
    LEAT11    // Leather Armor +2
    LEAT07    // Studded Leather Armor +2
    LEAT09    // Karajah's Leather Armor
    LEAT17    // Armor of Deep Night +4
    LEAT20    // Aeger's Hide +3
    PLAT01    // Plate Mail Armor
    PLAT04    // Full Plate Mail
    PLAT10    // Plate Mail +1
    SHLD01    // Small Shield
    SHLD03    // Medium Shield
    SHLD06    // Large Shield +1
    SHLD08    // Buckler
    SHLD02    // Small Shield +1
    SHLD04    // Medium Shield +1
    SHLD06    // Large Shield +1
    SHLD29    // Medium Shield +2
    SHLD23    // Fortress Shield +3
    SHLD24    // Reflection Shield +1
    RING06    // Ring of Protection +1
    RING20    // Ring of Energy
    HELM13    // Helmet
    BRAC15    // Bracers of Defense AC 3
    BRAC02    // Bracers of Defense AC 7
    AMUL14    // Amulet of Protection +1
    POTN02    // Potion of Fire Resistance
    POTN04    // Potion of Frost Giant Strength
    POTN09    // Potion of Heroism
    POTN10    // Potion of Invisibility
    POTN14    // Oil of Speed
    POTN17    // Elixir of Health
    POTN19    // Potion of Agility
    POTN20    // Antidote
    POTN22    // Potion of Cold Resistance
    POTN27    // Potion of Firebreath
    POTN31    // Potion of Insulation
    POTN36    // Potion of Master Thievery
    POTN39    // Potion of Perception
    POTN42    // Potion of Regeneration 
    POTN44    // Potion of Strength
    POTN45    // Potion of Freedom
    SCRL03    // Protection from Acid
    SCRL04    // Protection from Cold
    SCRL05    // Protection from Electricity
    SCRL06    // Protection from Fire
    SCRL07    // Protection from Magic
    SCRL08    // Protection from Poison
    SCRL09    // Protection from Undead
    SCRL15    // Protection from Petrification
    SCRLA5    // Melf's Minute Meteor
    SCRL6U    // Breach
    SCRL6O    // Secret Word
    SCRL6M    // Enchanted Weapon
    SCRL1M    // Non-Detection
    SCRL3G    // Vocalize
    RODS03    // Rod of Resurrection
    BAG02     // Gem bag
    RING28    // Ring of Air Control
    SW1H53    // Sword of Flame +1
    RING03    // Ring of Animal Friendship
    BRAC14    // Bracers of Defense AC 4
    BELT06    // Girdle of Hill Giant Strength
    CLCK12    // Knave's Robe
 // these are RR's additions
    ~RR#BOW02~  // Composite Short Bow
    ~RR#BOW03~  // Composite Short Bow +1
    ~RR#BOW04~  // Composite Short Bow +2
    ~RR#BUC02~  // Buckler +1

  LPF store INT_VAR
    sell=200
    buy=25
    steal=0
    fence=0
  END

  ADD_STORE_ITEM SW1H42   LAST #0 #0 #0 IDENTIFIED #1   // Bastard Sword +2
  ADD_STORE_ITEM SW1H41   LAST #0 #0 #0 IDENTIFIED #1   // Long Sword +2
  ADD_STORE_ITEM SW1H29   LAST #0 #0 #0 IDENTIFIED #1   // Short Sword +2
  ADD_STORE_ITEM SW1H22   LAST #0 #0 #0 IDENTIFIED #1   // Scimitar +1
  ADD_STORE_ITEM SW1H44   LAST #0 #0 #0 IDENTIFIED #1   // Katana +1
  ADD_STORE_ITEM SW1H47   LAST #0 #0 #0 IDENTIFIED #1   // Wakizashi +1
  ADD_STORE_ITEM SW1H49   LAST #0 #0 #0 IDENTIFIED #1   // Ninja-To +1
  ADD_STORE_ITEM SW2H11   LAST #0 #0 #0 IDENTIFIED #1   // Two Handed Sword +2
  ADD_STORE_ITEM DAGG15   LAST #0 #0 #0 IDENTIFIED #1   // Dagger +2
  ADD_STORE_ITEM AX1H11   LAST #0 #0 #0 IDENTIFIED #1   // Battle Axe +2
  ADD_STORE_ITEM SPER05   LAST #0 #0 #0 IDENTIFIED #1   // Spear +2
  ADD_STORE_ITEM HALB07   LAST #0 #0 #0 IDENTIFIED #1   // Halberd +2
  ADD_STORE_ITEM STAF18   LAST #0 #0 #0 IDENTIFIED #1   // Quarter Staff +2
  ADD_STORE_ITEM BLUN13   LAST #0 #0 #0 IDENTIFIED #1   // Flail +2
  ADD_STORE_ITEM BLUN21   LAST #0 #0 #0 IDENTIFIED #1   // Mace +2
  ADD_STORE_ITEM BLUN15   LAST #0 #0 #0 IDENTIFIED #1   // Morning Star +2
  ADD_STORE_ITEM HAMM08   LAST #0 #0 #0 IDENTIFIED #1   // War Hammer +2
  ADD_STORE_ITEM BOW02    LAST #0 #0 #0 IDENTIFIED #1   // Composite Long Bow +1
  ADD_STORE_ITEM BOW17    LAST #0 #0 #0 IDENTIFIED #1   // Long Bow +2
  ADD_STORE_ITEM BOW18    LAST #0 #0 #0 IDENTIFIED #1   // Short Bow +2
  ADD_STORE_ITEM XBOW07   LAST #0 #0 #0 IDENTIFIED #1   // Heavy Crossbow +2
  ADD_STORE_ITEM XBOW09   LAST #0 #0 #0 IDENTIFIED #1   // Light Crossbow +2
  ADD_STORE_ITEM LEAT11   LAST #0 #0 #0 IDENTIFIED #1   // Leather Armor +2
  ADD_STORE_ITEM LEAT07   LAST #0 #0 #0 IDENTIFIED #1   // Studded Leather Armor +2
  ADD_STORE_ITEM CHAN08   LAST #0 #0 #0 IDENTIFIED #1   // Chain Mail +2
  ADD_STORE_ITEM PLAT10   LAST #0 #0 #0 IDENTIFIED #1   // Plate Mail +2
  ADD_STORE_ITEM PLAT14   LAST #0 #0 #0 IDENTIFIED #1   // Full Plate Mail +1
  ADD_STORE_ITEM SHLD28   LAST #0 #0 #0 IDENTIFIED #1   // Small Shield +2
  ADD_STORE_ITEM SHLD29   LAST #0 #0 #0 IDENTIFIED #1   // Medium Shield +2
  ADD_STORE_ITEM SHLD30   LAST #0 #0 #0 IDENTIFIED #1   // Large Shield +2

  PATCH_IF comp_rr_equip BEGIN
    ADD_STORE_ITEM ~RR#BOW03~ LAST #0 #0 #0 IDENTIFIED #1  // Composite Short Bow +1
    ADD_STORE_ITEM ~RR#BUC03~ LAST #0 #0 #0 IDENTIFIED #1  // Buckler +2
  END

  ADD_STORE_ITEM AROW11   LAST #20 #0 #0 IDENTIFIED #3  // Arrow +2
  ADD_STORE_ITEM BOLT06   LAST #20 #0 #0 IDENTIFIED #3  // Bolt +2
  ADD_STORE_ITEM BULL03   LAST #20 #0 #0 IDENTIFIED #3  // Bullet +2

  ADD_STORE_ITEM CLCK13   LAST #0 #0 #0 IDENTIFIED #1   // Traveller's Robe
  ADD_STORE_ITEM CLCK14   LAST #0 #0 #0 IDENTIFIED #1   // Adventurer's Robe
  ADD_STORE_ITEM CLCK12   LAST #0 #0 #0 IDENTIFIED #1   // Knave's Robe
  PATCH_IF comp_ir BEGIN
    ADD_STORE_ITEM CLCK18   LAST #0 #0 #0 IDENTIFIED #1   // Knave Robe/Mage Robe of Acid Resistance
  END
  ADD_STORE_ITEM CLCK09   LAST #0 #0 #0 IDENTIFIED #1   // Mage Robe of Cold Resistance
  ADD_STORE_ITEM CLCK10   LAST #0 #0 #0 IDENTIFIED #1   // Mage Robe of Fire Resistance
  ADD_STORE_ITEM CLCK11   LAST #0 #0 #0 IDENTIFIED #1   // Mage Robe of Electric Resistance

  ADD_STORE_ITEM BOW11    LAST #0 #0 #0 IDENTIFIED #1   // Strong Arm +2
  ADD_STORE_ITEM XBOW14   LAST #0 #0 #0 IDENTIFIED #1   // Heavy Crossbow of Searing +1
  ADD_STORE_ITEM HALB03   LAST #0 #0 #0 IDENTIFIED #1   // Halberd +2/Suryris's Blade
  ADD_STORE_ITEM SW1H06   LAST #0 #0 #0 IDENTIFIED #1   // Long Sword +2/Varscona
  ADD_STORE_ITEM HAMM05   LAST #0 #0 #0 IDENTIFIED #1   // War Hammer +2/Ashideena

  ADD_STORE_ITEM SHLD24   LAST #0 #0 #0 IDENTIFIED #1   // Reflection Shield +1
  ADD_STORE_ITEM BRAC14   LAST #0 #0 #0 IDENTIFIED #1   // Bracers of Defense AC 4

  ADD_STORE_ITEM BELT02   LAST #0 #0 #0 IDENTIFIED #1   // Golden Girdle

  ADD_STORE_ITEM AMUL14   LAST #0 #0 #0 IDENTIFIED #1   // Amulet of Protection +1
  ADD_STORE_ITEM RING06   LAST #0 #0 #0 IDENTIFIED #1   // Ring of Protection +1
  PATCH_IF comp_ir BEGIN
    ADD_STORE_ITEM RING20   LAST #1 #0 #0 IDENTIFIED #1   // Ring of Energy
  END ELSE BEGIN
    ADD_STORE_ITEM RING20   LAST #50 #0 #0 IDENTIFIED #1  // Ring of Energy
  END
  ADD_STORE_ITEM RING27   LAST #1 #1 #0 IDENTIFIED #1   // Ring of Fire Control

  ADD_STORE_ITEM WA2DAK   LAST #0 #0 #0 IDENTIFIED #1   // Dak'kon's Zerth Blade
  ADD_STORE_ITEM WA2PLAT  LAST #0 #0 #0 IDENTIFIED #1   // Plate of Balduran
  PATCH_IF comp_ir BEGIN
    ADD_STORE_ITEM SHLD22   LAST #0 #0 #0 IDENTIFIED #1   // Sentinel +4 -> Shield of Balduran
  END ELSE BEGIN
    ADD_STORE_ITEM WA2SHIEL LAST #0 #0 #0 IDENTIFIED #1   // Shield of Balduran
  END
  PATCH_IF comp_ir BEGIN
    ADD_STORE_ITEM sw1h18   LAST #0 #0 #0 IDENTIFIED #1   // Sword of Balduran
  END
  ADD_STORE_ITEM BAG06D   LAST #0 #0 #0 IDENTIFIED #1   // Potion Case
  ADD_STORE_ITEM BAG31    LAST #0 #0 #0 IDENTIFIED #1   // Bag of Holding - from Lazarus the Librarian
  ADD_STORE_ITEM CLCK15   LAST #0 #0 #0 IDENTIFIED #1   // Robe of the Good Archmagi/Robe of the Weave
  ADD_STORE_ITEM CLCK16   LAST #0 #0 #0 IDENTIFIED #1   // Robe of the Neutral Archmagi/Robe of the Battlemage
  ADD_STORE_ITEM CLCK17   LAST #0 #0 #0 IDENTIFIED #1   // Robe of the Evil Archmagi/Robe of Arcane Might

  // potions moved here, previously they were assigned to Joluv
  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #112 // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #28  // Potion of Extra Healing
  ADD_STORE_ITEM POTN55   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Superior Healing
  ADD_STORE_ITEM POTN20   LAST #1 #0 #0 IDENTIFIED #11  // Antidote
  ADD_STORE_ITEM POTN17   LAST #1 #0 #0 IDENTIFIED #5   // Elixir of Health
  ADD_STORE_ITEM POTN42   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Regeneration 

  ADD_STORE_ITEM POTN44   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Strength
  ADD_STORE_ITEM POTN19   LAST #1 #0 #0 IDENTIFIED #4   // Potion of Agility
  ADD_STORE_ITEM POTN28   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Fortitude
  ADD_STORE_ITEM POTN29   LAST #1 #0 #0 IDENTIFIED #4   // Potion of Genius
  ADD_STORE_ITEM POTN43   LAST #1 #0 #0 IDENTIFIED #6   // Potion of Insight 
  ADD_STORE_ITEM POTN37   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Mind Focusing

  ADD_STORE_ITEM POTN03   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Hill Giant Strength
  ADD_STORE_ITEM POTN12   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Stone Giant Strength
  ADD_STORE_ITEM POTN04   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Frost Giant Strength
  ADD_STORE_ITEM POTN05   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Fire Giant Strength
  ADD_STORE_ITEM POTN06   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Cloud Giant Strength
  ADD_STORE_ITEM POTN07   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Storm Giant Strength

  ADD_STORE_ITEM POTN09   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Heroism
  ADD_STORE_ITEM POTN14   LAST #1 #0 #0 IDENTIFIED #4   // Oil of Speed
  ADD_STORE_ITEM POTN41   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Power

  ADD_STORE_ITEM POTN22   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Cold Resistance
  ADD_STORE_ITEM POTN31   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Insulation
  ADD_STORE_ITEM POTN02   LAST #1 #0 #0 IDENTIFIED #4   // Potion of Fire Resistance
  ADD_STORE_ITEM POTN34   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Magic Protection
  ADD_STORE_ITEM POTN35   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Magic Shielding
  PATCH_IF comp_ir_potions BEGIN
    ADD_STORE_ITEM potn33   LAST #1 #0 #0 IDENTIFIED #5   // potion of magic dispelling
  END ELSE BEGIN
    ADD_STORE_ITEM potn33   LAST #1 #0 #0 IDENTIFIED #2   // potion of magic blocking
  END

  ADD_STORE_ITEM potn38   LAST #1 #0 #0 IDENTIFIED #4   // potion of mirrored eyes
  ADD_STORE_ITEM POTN24   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Defense
  ADD_STORE_ITEM POTN11   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Invulnerability
  ADD_STORE_ITEM POTN46   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Stone Form
  ADD_STORE_ITEM POTN18   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Absorbtion 

  ADD_STORE_ITEM POTN30   LAST #1 #0 #0 IDENTIFIED #4   // Potion of Infravision
  ADD_STORE_ITEM POTN39   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Perception
  ADD_STORE_ITEM POTN36   LAST #1 #0 #0 IDENTIFIED #4   // Potion of Master Thievery
  ADD_STORE_ITEM POTN10   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Invisibility
  ADD_STORE_ITEM POTN21   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Clarity
  ADD_STORE_ITEM POTN45   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Freedom

  ADD_STORE_ITEM POTN13   LAST #1 #0 #0 IDENTIFIED #12  // Oil of Fiery Burning
  ADD_STORE_ITEM POTN27   LAST #1 #0 #0 IDENTIFIED #7   // Potion of Firebreath
  ADD_STORE_ITEM POTN26   LAST #1 #0 #0 IDENTIFIED #9   // Potion of Explosions

END BUT_ONLY

///////////////////////////////////

// RIBALD3 - Ribald's special stock
// 
// give him some more expendable stuff, also few uniques

// 100% stock overwrite

// Mana Bow
COPY_EXISTING ar2602.are override PATCH_IF SOURCE_SIZE>0x11c BEGIN
  LPF DELETE_AREA_ITEM STR_VAR item_to_delete=bow13 END
END BUT_ONLY

// Sling of Arvoreen
COPY_EXISTING ar2101.are override PATCH_IF SOURCE_SIZE>0x11c BEGIN
  LPF DELETE_AREA_ITEM STR_VAR item_to_delete=slng06 END
END BUT_ONLY

COPY_EXISTING ribald3.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy END // doesn't buy anything
  REMOVE_STORE_ITEM 
    HELM16    // Helm of Brilliance
    PLAT14    // Full Plate Mail +1
    PLAT17    // T'rahcie's Plate +5
    LEAT15    // Studded Leather Armor +2
    LEAT11    // Leather Armor +2
    LEAT12    // Leather Armor +3
    CHAN08    // Chain Mail +2
    CHAN11    // Crimson Chain +5
    SHLD28    // Small Shield +2
    SHLD29    // Medium Shield +2
    SHLD30    // Large Shield +2
    SW1H09    // Short Sword +2
    SW1H41    // Long Sword +2
    SW1H42    // Bastard Sword +2
    SW2H09    // Warblade +4
    SW2H11    // Two Handed Sword +2
    SPER05    // Spear +2
    SPER06    // Spear +3
    BLUN13    // Flail +2
    BLUN15    // Morning Star +2
    BLUN21    // Mace +2
    XBOW07    // Heavy Crossbow +2
    XBOW09    // Light Crossbow +2
    SLNG04    // Sling +2
    DAGG15    // Dagger +2
    HALB07    // Halberd +2
    DART01    // Dart
    DART03    // Dart of Stunning
    DART04    // Dart of Wounding
    DART05    // Asp's Nest
    BOW10     // Heartseeker +3
    BOW16     // Composite Long Bow +2
    BOW17     // Long Bow +2
    BOW18     // Short Bow +2
    AX1H11    // Battle Axe +2
    BOLT01    // Bolt
    BOLT03    // Bolt of Lightning
    BOLT04    // Bolt of Biting 
    AROW01    // Arrows
    AROW08    // Arrow of Fire
    AROW09    // Arrows of Ice
    AROW05    // Arrow of Biting
    BULL01    // Bullet
    POTN05    // Potion of Fire Giant Strength
    POTN11    // Potion of Invulnerability
    POTN42    // Potion of Regeneration 
    SCRL9X    // Black Blade of Disaster
    SCRL9Q    // Chain Contingency
    SCRL9W    // Energy Drain
    SCRL9Z    // Freedom
    SCRL9U    // Power Word Kill
    SCRL9Y    // Shapechange
    SCRL9M    // Spellstrike
    SCRL9L    // Spell Trap
    SCRL9R    // Time Stop
    SCRL9V    // Wail of the Banshee
    SCRL9E    // Incendiary Cloud
    SCRL9H    // Maze
    SCRL9A    // Pierce Shield
    SCRL9J    // Power Word Blind
    SCRL8Y    // Protection From Energy
 // these are RR's additions
    ~RR#BOW04~  // Composite Short Bow +2
    ~RR#BUC02~  // Buckler +1
    ~RR#BUC03~  // Buckler +2
    ~RR#BUC04~  // Buckler +3

  LPF store INT_VAR
    sell=225
    steal=0
  END


  ADD_STORE_ITEM SW1H72   LAST #0 #0 #0 IDENTIFIED #1   // Bastard Sword +3
  ADD_STORE_ITEM SW1H73   LAST #0 #0 #0 IDENTIFIED #1   // Long Sword +3
  ADD_STORE_ITEM SW1H74   LAST #0 #0 #0 IDENTIFIED #1   // Short Sword +3
  ADD_STORE_ITEM SW1H76   LAST #0 #0 #0 IDENTIFIED #1   // Scimitar +3
  ADD_STORE_ITEM SW1H55   LAST #0 #0 #0 IDENTIFIED #1   // Katana +2
  ADD_STORE_ITEM SW2H20   LAST #0 #0 #0 IDENTIFIED #1   // Two Handed Sword +3
  ADD_STORE_ITEM DAGG24   LAST #0 #0 #0 IDENTIFIED #1   // Dagger +3
  ADD_STORE_ITEM AX1H17   LAST #0 #0 #0 IDENTIFIED #1   // Battle Axe +3
  ADD_STORE_ITEM SPER06   LAST #0 #0 #0 IDENTIFIED #1   // Spear +3
  ADD_STORE_ITEM HALB12   LAST #0 #0 #0 IDENTIFIED #1   // Halberd +3
  ADD_STORE_ITEM STAF24   LAST #0 #0 #0 IDENTIFIED #1   // Quarter Staff +3
  ADD_STORE_ITEM BLUN31   LAST #0 #0 #0 IDENTIFIED #1   // Club +3
  ADD_STORE_ITEM BLUN32   LAST #0 #0 #0 IDENTIFIED #1   // Flail +3
  ADD_STORE_ITEM BLUN33   LAST #0 #0 #0 IDENTIFIED #1   // Mace +3
  ADD_STORE_ITEM BLUN34   LAST #0 #0 #0 IDENTIFIED #1   // Morning Star +3
  ADD_STORE_ITEM HAMM12   LAST #0 #0 #0 IDENTIFIED #1   // War Hammer +3
  ADD_STORE_ITEM BOW16    LAST #0 #0 #0 IDENTIFIED #1   // Composite Long Bow +2
  ADD_STORE_ITEM BOW25    LAST #0 #0 #0 IDENTIFIED #1   // Long Bow +3
  ADD_STORE_ITEM BOW26    LAST #0 #0 #0 IDENTIFIED #1   // Short Bow +3
  ADD_STORE_ITEM XBOW17   LAST #0 #0 #0 IDENTIFIED #1   // Heavy Crossbow +3
  ADD_STORE_ITEM XBOW18   LAST #0 #0 #0 IDENTIFIED #1   // Light Crossbow +3
  ADD_STORE_ITEM SLNG10   LAST #0 #0 #0 IDENTIFIED #1   // Sling +3
  ADD_STORE_ITEM LEAT12   LAST #0 #0 #0 IDENTIFIED #1   // Leather Armor +3
  ADD_STORE_ITEM LEAT15   LAST #0 #0 #0 IDENTIFIED #1   // Studded Leather Armor +3
  PATCH_IF comp_ir BEGIN
    ADD_STORE_ITEM CHAN07   LAST #0 #0 #0 IDENTIFIED #1   // Chain Mail +3
  END
  PATCH_IF comp_ir BEGIN
    ADD_STORE_ITEM PLAT19   LAST #0 #0 #0 IDENTIFIED #1   // Full Plate Mail +2
  END ELSE BEGIN
    ADD_STORE_ITEM PLAT23   LAST #0 #0 #0 IDENTIFIED #1   // Full Plate Mail +2 - it is +3 in IR
  END

  PATCH_IF comp_rr_equip BEGIN
    ADD_STORE_ITEM ~RR#BOW04~ LAST #0 #0 #0 IDENTIFIED #1  // Composite Short Bow +2
    ADD_STORE_ITEM ~RR#BUC04~ LAST #0 #0 #0 IDENTIFIED #1  // Buckler +3
  END

  ADD_STORE_ITEM AROW11   LAST #20 #0 #0 IDENTIFIED #2  // Arrow +2
  ADD_STORE_ITEM AROW15   LAST #20 #0 #0 IDENTIFIED #1  // Arrow +3
  ADD_STORE_ITEM BOLT06   LAST #20 #0 #0 IDENTIFIED #2  // Bolt +2
  ADD_STORE_ITEM BOLT09   LAST #20 #0 #0 IDENTIFIED #1  // Bolt +3
  ADD_STORE_ITEM BULL03   LAST #20 #0 #0 IDENTIFIED #2  // Bullet +2
  ADD_STORE_ITEM BULL05   LAST #20 #0 #0 IDENTIFIED #1  // Bullet +3
  ADD_STORE_ITEM bull04   LAST #20 #0 #0 IDENTIFIED #2  // sunstone bullet
  ADD_STORE_ITEM DART05   LAST #20 #0 #0 IDENTIFIED #10 // Asp's Nest
  ADD_STORE_ITEM DART03   LAST #20 #0 #0 IDENTIFIED #4  // Dart of Stunning
  ADD_STORE_ITEM DART04   LAST #20 #0 #0 IDENTIFIED #4  // Dart of Wounding
  ADD_STORE_ITEM BOLT03   LAST #20 #0 #0 IDENTIFIED #4  // Bolt of Lightning
  ADD_STORE_ITEM BOLT04   LAST #20 #0 #0 IDENTIFIED #4  // Bolt of Biting 
  ADD_STORE_ITEM AROW05   LAST #20 #0 #0 IDENTIFIED #4  // Arrow of Biting
  PATCH_IF comp_nodispel=0 BEGIN
    ADD_STORE_ITEM arow07   LAST #5 #0 #0 IDENTIFIED #4   // arrow of dispelling
  END
  ADD_STORE_ITEM arow06   LAST #5 #0 #0 IDENTIFIED #1   // arrow of detonation
  ADD_STORE_ITEM AROW10   LAST #20 #0 #0 IDENTIFIED #4  // Arrows of Piercing
  ADD_STORE_ITEM AROW04   LAST #20 #0 #0 IDENTIFIED #4  // Acid Arrows
  PATCH_IF comp_ir BEGIN
    ADD_STORE_ITEM AROW03   LAST #5  #0 #0 IDENTIFIED #1  // Arrow of Slaying
    ADD_STORE_ITEM BOLT05   LAST #5  #0 #0 IDENTIFIED #1  // Bolt or Polymorphing
    ADD_STORE_ITEM BOLT08   LAST #10 #0 #0 IDENTIFIED #2  // Blessed Bolt
    ADD_STORE_ITEM BULL06   LAST #20 #0 #0 IDENTIFIED #2  // Bullet of Smiting (Bullet +4)
  END

  ADD_STORE_ITEM potn55   LAST #1 #0 #0 IDENTIFIED #3   // super healing
  ADD_STORE_ITEM potn06   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Cloud Giant Strength
  ADD_STORE_ITEM potn07   LAST #1 #0 #0 IDENTIFIED #1   // storm
  ADD_STORE_ITEM POTN11   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Invulnerability
  ADD_STORE_ITEM potn18   LAST #1 #0 #0 IDENTIFIED #1   // absorbtion
  ADD_STORE_ITEM potn41   LAST #1 #0 #0 IDENTIFIED #1   // power
  ADD_STORE_ITEM potn34   LAST #1 #0 #0 IDENTIFIED #1   // magic protection
  ADD_STORE_ITEM potn35   LAST #1 #0 #0 IDENTIFIED #1   // magic shielding
  PATCH_IF comp_ir_potions=0 BEGIN
    ADD_STORE_ITEM potn33   LAST #1 #0 #0 IDENTIFIED #1   // magic blocking
  END

  ADD_STORE_ITEM SCRL07   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Magic

  ADD_STORE_ITEM SCRL9G   LAST #1 #0 #0 IDENTIFIED #1   // Abi Dalzim's Horrid Wilting
  ADD_STORE_ITEM SCRLB1   LAST #1 #0 #0 IDENTIFIED #1   // Bigby's Clenched Fist
  PATCH_IF comp_sr BEGIN
    ADD_STORE_ITEM scrlw801 LAST #1 #0 #0 IDENTIFIED #1   // ghost form
  END
  ADD_STORE_ITEM SCRL9C   LAST #1 #0 #0 IDENTIFIED #1   // Improved Mantle
  ADD_STORE_ITEM SCRL9E   LAST #1 #0 #0 IDENTIFIED #1   // Incendiary Cloud
  ADD_STORE_ITEM SCRL9H   LAST #1 #0 #0 IDENTIFIED #1   // Maze
  ADD_STORE_ITEM SCRL9A   LAST #1 #0 #0 IDENTIFIED #1   // Pierce Shield
  ADD_STORE_ITEM SCRL9J   LAST #1 #0 #0 IDENTIFIED #1   // Power Word Blind
  ADD_STORE_ITEM SCRL8Y   LAST #1 #0 #0 IDENTIFIED #1   // Protection From Energy
  ADD_STORE_ITEM SCRL8Z   LAST #1 #0 #0 IDENTIFIED #1   // Simulacrum
  ADD_STORE_ITEM SCRL9D   LAST #1 #0 #0 IDENTIFIED #1   // Spell Trigger
  ADD_STORE_ITEM SCRL9B   LAST #1 #0 #0 IDENTIFIED #1   // Summon Fiend
  ADD_STORE_ITEM SCRLAO   LAST #1 #0 #0 IDENTIFIED #1   // Symbol Death
  ADD_STORE_ITEM SCRL9F   LAST #1 #0 #0 IDENTIFIED #1   // Symbol Fear
  ADD_STORE_ITEM SCRLAP   LAST #1 #0 #0 IDENTIFIED #1   // Symbol Stun
  PATCH_IF comp_sr BEGIN
    ADD_STORE_ITEM SCRL8X   LAST #0 #0 #0 IDENTIFIED #1   // Spell Shield
  END

  ADD_STORE_ITEM SCRL9X   LAST #1 #0 #0 IDENTIFIED #1   // Black Blade of Disaster
  ADD_STORE_ITEM SCRL9Q   LAST #1 #0 #0 IDENTIFIED #1   // Chain Contingency
  ADD_STORE_ITEM SCRL9W   LAST #1 #0 #0 IDENTIFIED #1   // Energy Drain
  ADD_STORE_ITEM SCRL9Z   LAST #1 #0 #0 IDENTIFIED #1   // Freedom
  ADD_STORE_ITEM SCRL9U   LAST #1 #0 #0 IDENTIFIED #1   // Power Word Kill
  ADD_STORE_ITEM SCRL9Y   LAST #1 #0 #0 IDENTIFIED #1   // Shapechange
  ADD_STORE_ITEM SCRL9M   LAST #1 #0 #0 IDENTIFIED #1   // Spellstrike
  ADD_STORE_ITEM SCRL9L   LAST #1 #0 #0 IDENTIFIED #1   // Spell Trap
  ADD_STORE_ITEM SCRL9R   LAST #1 #0 #0 IDENTIFIED #1   // Time Stop
  ADD_STORE_ITEM SCRL9V   LAST #1 #0 #0 IDENTIFIED #1   // Wail of the Banshee

  ADD_STORE_ITEM xbow08   LAST #0 #0 #0 IDENTIFIED #1   // giant hair crossbow
  ADD_STORE_ITEM BRAC15   LAST #0 #0 #0 IDENTIFIED #1   // Bracers of Defense AC 3
  ADD_STORE_ITEM HELM16   LAST #1 #1 #1 IDENTIFIED #1   // Helm of Brilliance
  PATCH_IF comp_cursed=0 BEGIN
    ADD_STORE_ITEM PLAT17   LAST #0 #0 #0 IDENTIFIED #1   // T'rahcie's Plate +5/Armor of the Hart +3
  END
  ADD_STORE_ITEM CHAN11   LAST #0 #0 #0 IDENTIFIED #1   // Crimson Chain +5
  ADD_STORE_ITEM SW2H09   LAST #0 #0 #0 IDENTIFIED #1   // Warblade +4
  ADD_STORE_ITEM clck05   LAST #0 #0 #0 IDENTIFIED #1   // cloak of balduran
  ADD_STORE_ITEM LEAT17   LAST #0 #0 #0 IDENTIFIED #1   // Armor of Deep Night +5
  ADD_STORE_ITEM bow13    LAST #0 #0 #0 IDENTIFIED #1   // Mana Bow +4
  ADD_STORE_ITEM slng06   LAST #0 #0 #0 IDENTIFIED #1   // Sling of Arvoreen +4

END BUT_ONLY

//////////////////

// WMART2 - Deidre
// 
// she says about being a member of magic emporium and how she's got lots of magical treasure to
// trade, hence she sells damn lots of magic. Deidre has every single spell you could buy prior
// Spellhold, but her prices are topping themselves

// 100% stock overwrite

COPY_EXISTING wmart2.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR magic=1 END
  REMOVE_STORE_ITEM 
    WA2DAK    // Dak'kon's Zerth Blade
    WA2AMU    // Sensate Amulet
    WA2HARP   // Harp of Pandemonium
    WA2HALB   // Harmonium Halberd
    WA2HELM   // Vhailor's Helm
    WA2PLAT   // Plate of Balduran
    WA2RING   // Mercykiller Ring
    WA2ROBE   // Robe of Vecna
    WA2S1H    // Sword of Balduran
    WA2SHIEL  // Shield of Balduran

  LPF store INT_VAR
    sell=250
    buy=25
    steal=0
    fence=0
  END

  SAY 0xc @200107 // Magic Emporium

  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM wand02   LAST #10 #0 #0 IDENTIFIED #1  // fear
    ADD_STORE_ITEM wand03   LAST #10 #0 #0 IDENTIFIED #1  // mm
    ADD_STORE_ITEM wand04   LAST #10 #0 #0 IDENTIFIED #1  // paralyze
    ADD_STORE_ITEM wand05   LAST #10 #0 #0 IDENTIFIED #1  // fire
    ADD_STORE_ITEM wand06   LAST #10 #0 #0 IDENTIFIED #1  // frost
    ADD_STORE_ITEM wand07   LAST #10 #0 #0 IDENTIFIED #1  // lightning
    ADD_STORE_ITEM wand08   LAST #10 #0 #0 IDENTIFIED #1  // sleep
    ADD_STORE_ITEM wand09   LAST #10 #0 #0 IDENTIFIED #1  // polymorph
    ADD_STORE_ITEM wand10   LAST #10 #0 #0 IDENTIFIED #1  // monster
    ADD_STORE_ITEM wand13   LAST #10 #0 #0 IDENTIFIED #1  // cloudkill
  END ELSE BEGIN
    ADD_STORE_ITEM wand02   LAST #50 #0 #0 IDENTIFIED #1  // fear
    ADD_STORE_ITEM wand03   LAST #50 #0 #0 IDENTIFIED #1  // mm
    ADD_STORE_ITEM wand04   LAST #50 #0 #0 IDENTIFIED #1  // paralyze
    ADD_STORE_ITEM wand05   LAST #50 #50 #0 IDENTIFIED #1 // fire
    ADD_STORE_ITEM wand06   LAST #50 #0 #0 IDENTIFIED #1  // frost
    ADD_STORE_ITEM wand07   LAST #50 #0 #0 IDENTIFIED #1  // lightning
    ADD_STORE_ITEM wand08   LAST #50 #0 #0 IDENTIFIED #1  // sleep
    ADD_STORE_ITEM wand09   LAST #50 #0 #0 IDENTIFIED #1  // polymorph
    ADD_STORE_ITEM wand10   LAST #50 #0 #0 IDENTIFIED #1  // monster
    ADD_STORE_ITEM wand13   LAST #50 #0 #0 IDENTIFIED #1  // cloudkill
  END

  ADD_STORE_ITEM SCRL03   LAST #1 #0 #0 IDENTIFIED #5   // Protection from Acid
  ADD_STORE_ITEM SCRL04   LAST #1 #0 #0 IDENTIFIED #5   // Protection from Cold
  ADD_STORE_ITEM SCRL05   LAST #1 #0 #0 IDENTIFIED #5   // Protection from Electricity
  ADD_STORE_ITEM SCRL06   LAST #1 #0 #0 IDENTIFIED #5   // Protection from Fire
  ADD_STORE_ITEM SCRL07   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Magic
  ADD_STORE_ITEM SCRL08   LAST #1 #0 #0 IDENTIFIED #5   // Protection from Poison
  ADD_STORE_ITEM SCRL09   LAST #1 #0 #0 IDENTIFIED #5   // Protection from Undead
  ADD_STORE_ITEM SCRL15   LAST #1 #0 #0 IDENTIFIED #5   // Protection from Petrification

  ADD_STORE_ITEM BAG03    LAST #0 #0 #0 IDENTIFIED #1   // Scroll Case
  ADD_STORE_ITEM BAG03C   LAST #0 #0 #0 IDENTIFIED #1   // Scroll Case
  ADD_STORE_ITEM BAG03F   LAST #0 #0 #0 IDENTIFIED #1   // Scroll Case

  ADD_STORE_ITEM SCRL67   LAST #1 #0 #0 IDENTIFIED #5   // Armor
  ADD_STORE_ITEM SCRL71   LAST #1 #0 #0 IDENTIFIED #5   // Blindness
  ADD_STORE_ITEM SCRL68   LAST #1 #0 #0 IDENTIFIED #5   // Burning Hands
  ADD_STORE_ITEM SCRL69   LAST #1 #0 #0 IDENTIFIED #5   // Charm Person
  ADD_STORE_ITEM SCRL82   LAST #1 #0 #0 IDENTIFIED #5   // Chill Touch
  ADD_STORE_ITEM SCRL83   LAST #1 #0 #0 IDENTIFIED #5   // Chromatic Orb
  ADD_STORE_ITEM SCRL70   LAST #1 #0 #0 IDENTIFIED #5   // Color Spray
  ADD_STORE_ITEM SCRL66   LAST #1 #0 #0 IDENTIFIED #5   // Grease
  ADD_STORE_ITEM SCRL6D   LAST #1 #0 #0 IDENTIFIED #5   // Find Familiar
  ADD_STORE_ITEM SCRL72   LAST #1 #0 #0 IDENTIFIED #5   // Friends
  ADD_STORE_ITEM SCRL75   LAST #1 #0 #0 IDENTIFIED #5   // Identify
  ADD_STORE_ITEM SCRL76   LAST #1 #0 #0 IDENTIFIED #5   // Infravision
  ADD_STORE_ITEM SCRL84   LAST #1 #0 #0 IDENTIFIED #5   // Larloch's Minor Drain
  ADD_STORE_ITEM SCRL77   LAST #1 #0 #0 IDENTIFIED #5   // Magic Missile
  ADD_STORE_ITEM SCRL78   LAST #1 #0 #0 IDENTIFIED #5   // Protection From Evil
  ADD_STORE_ITEM SCRL73   LAST #1 #0 #0 IDENTIFIED #5   // Protection From Petrification
  ADD_STORE_ITEM SCRL5U   LAST #1 #0 #0 IDENTIFIED #5   // Reflected Image
  ADD_STORE_ITEM SCRL79   LAST #1 #0 #0 IDENTIFIED #5   // Shield
  ADD_STORE_ITEM SCRL80   LAST #1 #0 #0 IDENTIFIED #5   // Shocking Grasp
  ADD_STORE_ITEM SCRL81   LAST #1 #0 #0 IDENTIFIED #5   // Sleep
  ADD_STORE_ITEM SCRLA6   LAST #1 #0 #0 IDENTIFIED #5   // Spook

  ADD_STORE_ITEM SCRL1B   LAST #1 #0 #0 IDENTIFIED #5   // Agannazar's Scorcher
  ADD_STORE_ITEM SCRL85   LAST #1 #0 #0 IDENTIFIED #5   // Blur
  ADD_STORE_ITEM SCRLA2   LAST #1 #0 #0 IDENTIFIED #5   // Deafness
  ADD_STORE_ITEM SCRL86   LAST #1 #0 #0 IDENTIFIED #5   // Detect Evil
  ADD_STORE_ITEM SCRL87   LAST #1 #0 #0 IDENTIFIED #5   // Detect Invisibilty
  ADD_STORE_ITEM SCRL1C   LAST #1 #0 #0 IDENTIFIED #5   // Ghoul Touch
  ADD_STORE_ITEM SCRLA3   LAST #1 #0 #0 IDENTIFIED #5   // Glitterdust
  ADD_STORE_ITEM SCRL89   LAST #1 #0 #0 IDENTIFIED #5   // Horror
  ADD_STORE_ITEM SCRL90   LAST #1 #0 #0 IDENTIFIED #5   // Invisibilty
  ADD_STORE_ITEM SCRL91   LAST #1 #0 #0 IDENTIFIED #5   // Knock
  ADD_STORE_ITEM SCRL92   LAST #1 #0 #0 IDENTIFIED #5   // Know Alignment
  ADD_STORE_ITEM SCRL93   LAST #1 #0 #0 IDENTIFIED #5   // Luck
  ADD_STORE_ITEM SCRL95   LAST #1 #0 #0 IDENTIFIED #5   // Melf's Acid Arrow
  ADD_STORE_ITEM SCRL96   LAST #1 #0 #0 IDENTIFIED #5   // Mirror Image
  ADD_STORE_ITEM SCRL6E   LAST #1 #0 #0 IDENTIFIED #5   // Power Word Sleep
  ADD_STORE_ITEM SCRL6F   LAST #1 #0 #0 IDENTIFIED #5   // Ray of Enfeeblement
  ADD_STORE_ITEM SCRL94   LAST #1 #0 #0 IDENTIFIED #5   // Resist Fear
  ADD_STORE_ITEM SCRL97   LAST #1 #0 #0 IDENTIFIED #5   // Stinking Cloud
  ADD_STORE_ITEM SCRL98   LAST #1 #0 #0 IDENTIFIED #5   // Strength
  ADD_STORE_ITEM SCRL99   LAST #1 #0 #0 IDENTIFIED #5   // Web
  ADD_STORE_ITEM SCRL3G   LAST #1 #0 #0 IDENTIFIED #5   // Vocalize

  ADD_STORE_ITEM SCRL1D   LAST #1 #0 #0 IDENTIFIED #3   // Clairvoyance
  ADD_STORE_ITEM SCRL6K   LAST #1 #0 #0 IDENTIFIED #3   // Detect Illusion
  ADD_STORE_ITEM SCRL1S   LAST #1 #0 #0 IDENTIFIED #3   // Dire Charm
  ADD_STORE_ITEM SCRL1E   LAST #1 #0 #0 IDENTIFIED #3   // Dispel Magic
  ADD_STORE_ITEM SCRL1G   LAST #1 #0 #0 IDENTIFIED #3   // Fireball
  ADD_STORE_ITEM SCRL1F   LAST #1 #0 #0 IDENTIFIED #3   // Flame Arrow
  ADD_STORE_ITEM SCRL1T   LAST #1 #0 #0 IDENTIFIED #3   // Ghost Armor
  ADD_STORE_ITEM SCRL1H   LAST #1 #0 #0 IDENTIFIED #3   // Haste
  ADD_STORE_ITEM SCRL1I   LAST #1 #0 #0 IDENTIFIED #3   // Hold Person
  ADD_STORE_ITEM SCRL6L   LAST #1 #0 #0 IDENTIFIED #3   // Hold Undead
  ADD_STORE_ITEM SCRL1J   LAST #1 #0 #0 IDENTIFIED #3   // Invisibility 10' Radius
  ADD_STORE_ITEM SCRL1K   LAST #1 #0 #0 IDENTIFIED #3   // Lightning Bolt
  ADD_STORE_ITEM SCRLA5   LAST #1 #0 #0 IDENTIFIED #3   // Melf's Minute Meteor
  ADD_STORE_ITEM SCRL6G   LAST #1 #0 #0 IDENTIFIED #3   // Minor Spell Deflection
  ADD_STORE_ITEM SCRL1L   LAST #1 #0 #0 IDENTIFIED #3   // Monster Summoning I
  ADD_STORE_ITEM SCRL1M   LAST #1 #0 #0 IDENTIFIED #3   // Non-Detection
  PATCH_IF comp_sr=0 BEGIN
    ADD_STORE_ITEM SCRL6I   LAST #1 #0 #0 IDENTIFIED #3   // Protection from Cold
    ADD_STORE_ITEM SCRL6H   LAST #1 #0 #0 IDENTIFIED #3   // Protection from Fire
  END
  ADD_STORE_ITEM SCRL1N   LAST #1 #0 #0 IDENTIFIED #3   // Protection From Normal Missiles
  ADD_STORE_ITEM SCRL1P   LAST #1 #0 #0 IDENTIFIED #3   // Skull Trap
  ADD_STORE_ITEM SCRL1O   LAST #1 #0 #0 IDENTIFIED #3   // Slow
  ADD_STORE_ITEM SCRL6J   LAST #1 #0 #0 IDENTIFIED #3   // Spell Thrust
  ADD_STORE_ITEM SCRL1Q   LAST #1 #0 #0 IDENTIFIED #3   // Vampiric Touch
  ADD_STORE_ITEM SCRLA7   LAST #1 #0 #0 IDENTIFIED #3   // Remove Magic

  ADD_STORE_ITEM SCRL1U   LAST #1 #0 #0 IDENTIFIED #3   // Confusion
  ADD_STORE_ITEM SCRLA8   LAST #1 #0 #0 IDENTIFIED #3   // Contagion
  PATCH_IF comp_sr=1 BEGIN
    ADD_STORE_ITEM scrl1v   LAST #1 #0 #0 IDENTIFIED #3   // dimension door
  END
  ADD_STORE_ITEM SCRL5H   LAST #1 #0 #0 IDENTIFIED #3   // Emotion
  ADD_STORE_ITEM SCRL6M   LAST #1 #0 #0 IDENTIFIED #3   // Enchanted Weapon
  ADD_STORE_ITEM SCRLAQ   LAST #1 #0 #0 IDENTIFIED #3   // Farsight
  ADD_STORE_ITEM SCRL1W   LAST #1 #0 #0 IDENTIFIED #3   // Fireshield (Blue)
  ADD_STORE_ITEM SCRL6N   LAST #1 #0 #0 IDENTIFIED #3   // Fireshield (Red)
  ADD_STORE_ITEM SCRL5I   LAST #1 #0 #0 IDENTIFIED #3   // Greater Malison
  ADD_STORE_ITEM SCRL1X   LAST #1 #0 #0 IDENTIFIED #3   // Ice Storm
  ADD_STORE_ITEM SCRL1Y   LAST #1 #0 #0 IDENTIFIED #3   // Improved Invisibility
  ADD_STORE_ITEM SCRL1Z   LAST #1 #0 #0 IDENTIFIED #3   // Minor Globe of Invulnerability
  ADD_STORE_ITEM SCRL6P   LAST #1 #0 #0 IDENTIFIED #3   // Minor Sequencer
  ADD_STORE_ITEM SCRL2A   LAST #1 #0 #0 IDENTIFIED #3   // Monster Summoning II
  ADD_STORE_ITEM SCRL5J   LAST #1 #0 #0 IDENTIFIED #3   // Oliluke's Resilient Sphere
  ADD_STORE_ITEM SCRL5L   LAST #1 #0 #0 IDENTIFIED #3   // Polymorph Other
  ADD_STORE_ITEM SCRL5M   LAST #1 #0 #0 IDENTIFIED #3   // Polymorph Self
  ADD_STORE_ITEM SCRL5G   LAST #1 #0 #0 IDENTIFIED #3   // Remove Curse
  ADD_STORE_ITEM SCRL6O   LAST #1 #0 #0 IDENTIFIED #3   // Secret Word
  ADD_STORE_ITEM SCRL6R   LAST #1 #0 #0 IDENTIFIED #3   // Spider Spawn
  ADD_STORE_ITEM SCRL5K   LAST #1 #0 #0 IDENTIFIED #3   // Spirit Armor
  ADD_STORE_ITEM SCRL2B   LAST #1 #0 #0 IDENTIFIED #3   // Stoneskin
  ADD_STORE_ITEM SCRL6Q   LAST #1 #0 #0 IDENTIFIED #3   // Teleport Field
  ADD_STORE_ITEM SCRLA1   LAST #1 #0 #0 IDENTIFIED #3   // Wizard Eye

  ADD_STORE_ITEM SCRL6U   LAST #1 #0 #0 IDENTIFIED #2   // Breach
  ADD_STORE_ITEM SCRL5P   LAST #1 #0 #0 IDENTIFIED #2   // Chaos
  ADD_STORE_ITEM SCRL2E   LAST #1 #0 #0 IDENTIFIED #2   // Cloudkill
  ADD_STORE_ITEM SCRL2F   LAST #1 #0 #0 IDENTIFIED #2   // Cone of Cold
  ADD_STORE_ITEM SCRL7B   LAST #1 #0 #0 IDENTIFIED #2   // Conjure Lesser Air Elemental
  ADD_STORE_ITEM SCRL7C   LAST #1 #0 #0 IDENTIFIED #2   // Conjure Lesser Earth Elemental
  ADD_STORE_ITEM SCRL6X   LAST #1 #0 #0 IDENTIFIED #2   // Conjure Lesser Fire Elemental
  ADD_STORE_ITEM SCRL5N   LAST #1 #0 #0 IDENTIFIED #2   // Domination
  ADD_STORE_ITEM SCRL5Q   LAST #1 #0 #0 IDENTIFIED #2   // Feeblemind
  ADD_STORE_ITEM SCRL5O   LAST #1 #0 #0 IDENTIFIED #2   // Hold Monster
  ADD_STORE_ITEM SCRL6V   LAST #1 #0 #0 IDENTIFIED #2   // Lower Resistance
  ADD_STORE_ITEM SCRL7D   LAST #1 #0 #0 IDENTIFIED #2   // Minor Spell Turning
  ADD_STORE_ITEM SCRL2G   LAST #1 #0 #0 IDENTIFIED #2   // Monster Summoning III
  ADD_STORE_ITEM SCRL6W   LAST #1 #0 #0 IDENTIFIED #2   // Oracle
  ADD_STORE_ITEM SCRL6Z   LAST #0 #0 #0 IDENTIFIED #2   // Phantom Blade
  ADD_STORE_ITEM SCRL6Y   LAST #1 #0 #0 IDENTIFIED #2   // Protection from Acid
  PATCH_IF comp_sr=1 BEGIN
    ADD_STORE_ITEM SCRL6I   LAST #1 #0 #0 IDENTIFIED #2   // Protection from Cold
    ADD_STORE_ITEM SCRL6H   LAST #1 #0 #0 IDENTIFIED #2   // Protection from Fire
  END
  ADD_STORE_ITEM SCRL5T   LAST #1 #0 #0 IDENTIFIED #2   // Protection from Electricity
  ADD_STORE_ITEM SCRL6T   LAST #1 #0 #0 IDENTIFIED #2   // Protection From Normal Weapons
  ADD_STORE_ITEM SCRL2H   LAST #1 #0 #0 IDENTIFIED #2   // Shadow Door
  ADD_STORE_ITEM SCRL6S   LAST #1 #0 #0 IDENTIFIED #2   // Spell Immunity
  PATCH_IF comp_sr=0 BEGIN
    ADD_STORE_ITEM SCRL8X   LAST #0 #0 #0 IDENTIFIED #2   // Spell Shield
  END
  ADD_STORE_ITEM SCRL2D   LAST #1 #0 #0 IDENTIFIED #2   // Animate Dead/Summon Shadow
  ADD_STORE_ITEM SCRLAR   LAST #1 #0 #0 IDENTIFIED #2   // Sunfire

  ADD_STORE_ITEM SCRL7R   LAST #1 #0 #0 IDENTIFIED #2   // Death Fog/Acid Fog
  ADD_STORE_ITEM SCRL7I   LAST #1 #0 #0 IDENTIFIED #2   // Death Spell
  ADD_STORE_ITEM SCRL7S   LAST #1 #0 #0 IDENTIFIED #2   // Chain Lightning
  ADD_STORE_ITEM SCRL7U   LAST #1 #0 #0 IDENTIFIED #2   // Contingency
  ADD_STORE_ITEM SCRL8A   LAST #1 #0 #0 IDENTIFIED #2   // Carrion Summons/Create Undead
  ADD_STORE_ITEM SCRL7T   LAST #1 #0 #0 IDENTIFIED #2   // Disintegrate
  ADD_STORE_ITEM SCRL7F   LAST #1 #0 #0 IDENTIFIED #2   // Globe of Invunerability
  ADD_STORE_ITEM SCRL7Q   LAST #1 #0 #0 IDENTIFIED #2   // Improved Haste
  ADD_STORE_ITEM SCRL7E   LAST #1 #0 #0 IDENTIFIED #2   // Invisible Stalker
  ADD_STORE_ITEM SCRL7K   LAST #1 #0 #0 IDENTIFIED #2   // Mislead
  ADD_STORE_ITEM SCRL7L   LAST #1 #0 #0 IDENTIFIED #2   // Pierce Magic
  ADD_STORE_ITEM SCRL7P   LAST #1 #0 #0 IDENTIFIED #2   // Power Word Silence
  ADD_STORE_ITEM SCRL7J   LAST #1 #0 #0 IDENTIFIED #2   // Protection From Magic Energy
  ADD_STORE_ITEM SCRL7O   LAST #1 #0 #0 IDENTIFIED #2   // Protection From Magic Weapons
  ADD_STORE_ITEM SCRL7V   LAST #1 #0 #0 IDENTIFIED #2   // Spell Deflection
  ADD_STORE_ITEM SCRL8C   LAST #1 #0 #0 IDENTIFIED #2   // Stone to Flesh
  ADD_STORE_ITEM SCRL7M   LAST #1 #0 #0 IDENTIFIED #2   // True Sight
  ADD_STORE_ITEM SCRL7W   LAST #1 #0 #0 IDENTIFIED #2   // Wyvern Call
//tenser
//flesh to stone
//fire elem
//air elem
//earth elem
//nishruu

  ADD_STORE_ITEM SCRL8V   LAST #1 #0 #0 IDENTIFIED #1   // Control Undead
  ADD_STORE_ITEM SCRLA4   LAST #1 #0 #0 IDENTIFIED #1   // Limited Wish
  ADD_STORE_ITEM SCRL8J   LAST #1 #0 #0 IDENTIFIED #1   // Mantle
  ADD_STORE_ITEM SCRL8W   LAST #1 #0 #0 IDENTIFIED #1   // Mass Invisibility
  ADD_STORE_ITEM SCRL8R   LAST #1 #0 #0 IDENTIFIED #1   // Mordenkainen's Sword
  ADD_STORE_ITEM SCRL8P   LAST #1 #0 #0 IDENTIFIED #1   // Prismatic Spray
  ADD_STORE_ITEM SCRL8F   LAST #1 #0 #0 IDENTIFIED #1   // Project Image
  ADD_STORE_ITEM SCRL8E   LAST #1 #0 #0 IDENTIFIED #1   // Protection From The Elements
  ADD_STORE_ITEM SCRL8G   LAST #1 #0 #0 IDENTIFIED #1   // Ruby Ray of Reversal
  ADD_STORE_ITEM SCRL8L   LAST #1 #0 #0 IDENTIFIED #1   // Spell Sequencer
  ADD_STORE_ITEM SCRL8D   LAST #1 #0 #0 IDENTIFIED #1   // Spell Turning
  ADD_STORE_ITEM SCRL8T   LAST #1 #0 #0 IDENTIFIED #1   // Summon Djinni
//cacofiend
//summon efreet
//khelben's warding whip
//sphere of chaos
//delayed blast fireball
//finger of death
//summon hakeashar
//power word stun

  ADD_STORE_ITEM SCRL9G   LAST #1 #0 #0 IDENTIFIED #1   // Abi Dalzim's Horrid Wilting
  PATCH_IF comp_sr=1 BEGIN
    ADD_STORE_ITEM scrlw801 LAST #1 #0 #0 IDENTIFIED #1   // ghost form
  END
  ADD_STORE_ITEM SCRL9H   LAST #1 #0 #0 IDENTIFIED #1   // Maze
  ADD_STORE_ITEM SCRL9A   LAST #1 #0 #0 IDENTIFIED #1   // Pierce Shield
  ADD_STORE_ITEM SCRL9J   LAST #1 #0 #0 IDENTIFIED #1   // Power Word Blind
  ADD_STORE_ITEM SCRL9D   LAST #1 #0 #0 IDENTIFIED #1   // Spell Trigger
  ADD_STORE_ITEM SCRL9F   LAST #1 #0 #0 IDENTIFIED #1   // Symbol Fear
  ADD_STORE_ITEM SCRLAN   LAST #1 #0 #0 IDENTIFIED #1   // Symbol Stun
//greater globe of invulnerability (SR v4)
//protection from energy
//simulacrum
//summon fiend
//improved mantle
//symbol of death
//bigby's clenched fist
//incendiary cloud

  ADD_STORE_ITEM SCRL9Z   LAST #1 #0 #0 IDENTIFIED #1   // Freedom

END BUT_ONLY

////////////////

// SHOP01 - Mira
// 
// fat woman, resides near the circus tent. Aurora's Boots and Shoes mod makes an interjection
// here, which may result in Mira selling a unique potion, so why not to keep the direction and
// make her a lesser potionmistress

// 100% stock overwrite

COPY_EXISTING shop01.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR potn=1 jewel=1 END
  REMOVE_STORE_ITEM 
    AX1H01    // Battle Axe
    AX1H04    // Throwing Axe
    BLUN02    // Flail
    BLUN06    // Morning Star
    BOW03     // Long Bow
    BOW05     // Short Bow
    DAGG01    // Dagger
    DART01    // Dart
    HAMM01    // War Hammer
    SLNG01    // Sling 
    STAF01    // Quarterstaff
    SW1H04    // Long Sword 
    SW1H07    // Short Sword 
    SW1H20    // Scimitar
    SW1H46    // Wakizashi
    SW2H01    // Two Handed Sword
    XBOW01    // Heavy Crossbow
    XBOW04    // Light Crossbow
    CHAN04    // Splint Mail
    LEAT01    // Leather Armor
    LEAT04    // Studded Leather Armor
    PLAT01    // Plate Mail Armor
    SHLD01    // Small Shield
    SHLD03    // Medium Shield
    SHLD05    // Large Shield
    SHLD08    // Buckler
    AROW01    // Arrows
    AROW02    // Arrows +1
    BOLT01    // Bolt
    BOLT02    // Bolt +1
    BULL01    // Bullet
    BULL02    // Bullet +1
    POTN08    // Potion of Healing
    POTN09    // Potion of Heroism
 // these are RR's additions
    ~RR#BOW02~  // Composite Short Bow

  LPF store INT_VAR
    sell=165
    buy=25
    steal=30
    fence=0
  END

  SAY 0xc @200109 // Potion Store

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #23  // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Extra Healing
  ADD_STORE_ITEM POTN20   LAST #1 #0 #0 IDENTIFIED #3   // Antidote
  ADD_STORE_ITEM POTN17   LAST #1 #0 #0 IDENTIFIED #1   // Elixir of Health

  ADD_STORE_ITEM POTN44   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Strength
  ADD_STORE_ITEM POTN19   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Agility
  ADD_STORE_ITEM POTN28   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Fortitude
  ADD_STORE_ITEM POTN43   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Insight 

  ADD_STORE_ITEM POTN03   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Hill Giant Strength
  ADD_STORE_ITEM POTN12   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Stone Giant Strength

  ADD_STORE_ITEM POTN09   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Heroism
  ADD_STORE_ITEM POTN14   LAST #1 #0 #0 IDENTIFIED #1   // Oil of Speed

  ADD_STORE_ITEM POTN31   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Insulation
  ADD_STORE_ITEM POTN02   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Fire Resistance

  ADD_STORE_ITEM potn38   LAST #1 #0 #0 IDENTIFIED #1   // potion of mirrored eyes
  ADD_STORE_ITEM POTN24   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Defense

  ADD_STORE_ITEM POTN30   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Infravision
  ADD_STORE_ITEM POTN36   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Master Thievery
  ADD_STORE_ITEM POTN10   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Invisibility
  ADD_STORE_ITEM POTN21   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Clarity
  ADD_STORE_ITEM POTN45   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Freedom

END BUT_ONLY

/////////////////////

// SHOP02 - Arnolinus
// 
// dwarf, claims to be an armorer

// 100% stock overwrite

COPY_EXISTING shop02.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR dwarf=1 armor=1 END
  REMOVE_STORE_ITEM 
    CHAN01    // Chain Mail Armor
    CHAN04    // Splint Mail
    LEAT01    // Leather Armor
    LEAT04    // Studded Leather Armor
    LEAT10    // Hide Armor
    PLAT01    // Plate Mail Armor
    PLAT04    // Full Plate Mail
    PLAT10    // Plate Mail +1
    SHLD01    // Small Shield
    SHLD03    // Medium Shield
    SHLD06    // Large Shield +1
    SHLD08    // Buckler
    SHLD09    // Buckler
    SHLD10    // Buckler
    SHLD11    // Small Shield
    SHLD12    // Small Shield
    SHLD13    // Medium Shield
    SHLD14    // Medium Shield
    SHLD15    // Large Shield
    SHLD16    // Large Shield
    SHLD02    // Small Shield +1
    SHLD04    // Medium Shield +1
    SHLD06    // Large Shield +1
    SHLD28    // Small Shield +2
    SHLD29    // Medium Shield +2
    SHLD30    // Large Shield +2
    HELM13    // Helmet
    HELM01    // Helmet
 // these are RR's additions
    ~RR#BUC02~  // Buckler +1
    ~RR#BUC03~  // Buckler +2

  LPF store INT_VAR
    sell=165
    buy=25
    steal=60
    fence=0
  END

  SAY 0xc @200110 // Arnolinus the Armorsmith

  ADD_STORE_ITEM AX1H01   LAST #0 #0 #0 IDENTIFIED #5   // Battle Axe
  ADD_STORE_ITEM AX1H02   LAST #0 #0 #0 IDENTIFIED #1   // Battle Axe +1
  ADD_STORE_ITEM AX1H04   LAST #10 #0 #0 IDENTIFIED #1 UNLIMITED  // Throwing Axe
  ADD_STORE_ITEM HAMM01   LAST #0 #0 #0 IDENTIFIED #5   // War Hammer
  ADD_STORE_ITEM HAMM02   LAST #0 #0 #0 IDENTIFIED #1   // War Hammer +1

  ADD_STORE_ITEM CHAN01   LAST #0 #0 #0 IDENTIFIED #5   // Chain Mail Armor
  ADD_STORE_ITEM CHAN02   LAST #0 #0 #0 IDENTIFIED #1   // Chain Mail +1
  ADD_STORE_ITEM CHAN04   LAST #0 #0 #0 IDENTIFIED #5   // Splint Mail
  ADD_STORE_ITEM CHAN05   LAST #0 #0 #0 IDENTIFIED #1   // Splint Mail +1
  ADD_STORE_ITEM PLAT01   LAST #0 #0 #0 IDENTIFIED #3   // Plate Mail Armor
  ADD_STORE_ITEM PLAT02   LAST #0 #0 #0 IDENTIFIED #1   // Plate Mail +1
  ADD_STORE_ITEM PLAT04   LAST #0 #0 #0 IDENTIFIED #1   // Full Plate Mail
  ADD_STORE_ITEM PLAT14   LAST #0 #0 #0 IDENTIFIED #1   // Full Plate Mail +1

  ADD_STORE_ITEM SHLD08   LAST #0 #0 #0 IDENTIFIED #5   // Buckler
  ADD_STORE_ITEM SHLD17   LAST #0 #0 #0 IDENTIFIED #1   // Buckler +1
  ADD_STORE_ITEM SHLD01   LAST #0 #0 #0 IDENTIFIED #5   // Small Shield
  ADD_STORE_ITEM SHLD02   LAST #0 #0 #0 IDENTIFIED #1   // Small Shield +1
  ADD_STORE_ITEM SHLD13   LAST #0 #0 #0 IDENTIFIED #5   // Medium Shield
  ADD_STORE_ITEM SHLD04   LAST #0 #0 #0 IDENTIFIED #1   // Medium Shield +1
  ADD_STORE_ITEM SHLD16   LAST #0 #0 #0 IDENTIFIED #3   // Large Shield
  ADD_STORE_ITEM SHLD06   LAST #0 #0 #0 IDENTIFIED #1   // Large Shield +1

  ADD_STORE_ITEM SHLD20   LAST #0 #0 #0 IDENTIFIED #1   // Kiel's Buckler
  ADD_STORE_ITEM HAMM06   LAST #0 #0 #0 IDENTIFIED #1   // Dwarven Thrower +3
  ADD_STORE_ITEM SHLD19   LAST #0 #0 #0 IDENTIFIED #1   // Dwarven Large Shield +2

  ADD_STORE_ITEM HELM08   LAST #0 #0 #0 IDENTIFIED #5   // Helmet
  ADD_STORE_ITEM HELM01   LAST #0 #0 #0 IDENTIFIED #5   // Helmet

END BUT_ONLY

/////////////////////

// SHOP03 - Storekeep
// 
// calls himself Maheer, talks about weaponry, will trade mainly in blunt and leather
// iirc he can also make a special cloak for Tashia

// 100% stock overwrite

COPY_EXISTING shop03.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR blunt=1 armor=1 END
  REMOVE_STORE_ITEM 
    AX1H01    // Battle Axe
    AX1H04    // Throwing Axe
    BLUN01    // Club
    BLUN02    // Flail
    BLUN04    // Mace
    BLUN06    // Morning Star
    BOW03     // Long Bow
    BOW01     // Composite Long Bow
    DAGG01    // Dagger
    DAGG16    // Poisoned Throwing Dagger
    HALB01    // Halberd
    HAMM01    // War Hammer
    HAMM02    // War Hammer +1
    SLNG01    // Sling 
    SLNG02    // Sling +1
    SPER01    // Spear
    SPER02    // Spear +1
    STAF01    // Quarterstaff
    STAF02    // Quarterstaff +1
    SW1H01    // Bastard Sword 
    SW1H04    // Long Sword 
    SW1H07    // Short Sword 
    SW1H20    // Scimitar
    SW1H43    // Katana
    SW1H46    // Wakizashi
    SW1H48    // Ninja-To
    SW2H01    // Two Handed Sword
    XBOW01    // Heavy Crossbow
    XBOW04    // Light Crossbow
    DART01    // Dart
    DART02    // Dart +1
    AROW01    // Arrows
    AROW02    // Arrows +1
    AROW11    // Arrow +2
    AROW08    // Arrow of Fire
    BOLT01    // Bolt
    BOLT02    // Bolt +1
    BOLT06    // Bolt +2
    BULL01    // Bullet
    BULL02    // Bullet +1
    BULL03    // Bullet +2

  LPF store INT_VAR
    sell=165
    buy=25
    steal=45
    fence=0
  END

  SAY 0xc @200111 // Maheer's Wares

  ADD_STORE_ITEM SPER01   LAST #0 #0 #0 IDENTIFIED #7   // Spear
  ADD_STORE_ITEM SPER02   LAST #0 #0 #0 IDENTIFIED #1   // Spear +1
  ADD_STORE_ITEM STAF01   LAST #0 #0 #0 IDENTIFIED #8   // Quarterstaff
  ADD_STORE_ITEM STAF02   LAST #0 #0 #0 IDENTIFIED #1   // Quarterstaff +1
  ADD_STORE_ITEM BLUN01   LAST #0 #0 #0 IDENTIFIED #5   // Club
  ADD_STORE_ITEM BLUN02   LAST #0 #0 #0 IDENTIFIED #3   // Flail
  ADD_STORE_ITEM BLUN03   LAST #0 #0 #0 IDENTIFIED #1   // Flail +1
  ADD_STORE_ITEM BLUN04   LAST #0 #0 #0 IDENTIFIED #4   // Mace
  ADD_STORE_ITEM BLUN05   LAST #0 #0 #0 IDENTIFIED #1   // Mace +1
  ADD_STORE_ITEM BLUN06   LAST #0 #0 #0 IDENTIFIED #3   // Morning Star
  ADD_STORE_ITEM BLUN07   LAST #0 #0 #0 IDENTIFIED #1   // Morning Star +1
  ADD_STORE_ITEM LEAT01   LAST #0 #0 #0 IDENTIFIED #3   // Leather Armor
  ADD_STORE_ITEM LEAT02   LAST #0 #0 #0 IDENTIFIED #1   // Leather Armor +1
  ADD_STORE_ITEM LEAT04   LAST #0 #0 #0 IDENTIFIED #3   // Studded Leather Armor
  ADD_STORE_ITEM LEAT05   LAST #0 #0 #0 IDENTIFIED #1   // Studded Leather Armor +1
  ADD_STORE_ITEM LEAT10   LAST #0 #0 #0 IDENTIFIED #2   // Hide Armor

  ADD_STORE_ITEM LEAT20   LAST #0 #0 #0 IDENTIFIED #1   // Aeger's Hide +3

END BUT_ONLY

/////////////////

// SHOP04    Enge
// 
// seemingly foreign dude, give him foreign stuff - in our case that can only be orient. some darts too

// 100% stock overwrite

COPY_EXISTING shop04.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    HALB01    // Halberd
    STAF01    // Quarterstaff
    BLUN02    // Flail
    BLUN04    // Mace
    BLUN06    // Morning Star
    DAGG01    // Dagger
    DART01    // Dart
    HAMM01    // War Hammer
    AX1H01    // Battle Axe
    AX1H04    // Throwing Axe
    SPER01    // Spear
    SW1H01    // Bastard Sword 
    SW1H04    // Long Sword 
    SW1H07    // Short Sword 
    SW1H20    // Scimitar
    SW1H43    // Katana
    SW1H46    // Wakizashi
    SW1H48    // Ninja-To
    SW2H01    // Two Handed Sword
    CHAN01    // Chain Mail Armor
    CHAN04    // Splint Mail
    LEAT01    // Leather Armor
    LEAT04    // Studded Leather Armor
    PLAT01    // Plate Mail Armor
    SHLD01    // Small Shield
    SHLD03    // Medium Shield
    SHLD06    // Large Shield +1
    POTN08    // Potion of Healing

  LPF store INT_VAR
    sell=180
    buy=25
    steal=40
    fence=0
  END

  SAY 0xc @200112 // Enge's Shop

  ADD_STORE_ITEM STAF01   LAST #0 #0 #0 IDENTIFIED #5   // Quarterstaff
  ADD_STORE_ITEM DART01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED  // Dart
  ADD_STORE_ITEM SPER01   LAST #0 #0 #0 IDENTIFIED #5   // Spear
  ADD_STORE_ITEM SW1H20   LAST #0 #0 #0 IDENTIFIED #4   // Scimitar
  ADD_STORE_ITEM SW1H43   LAST #0 #0 #0 IDENTIFIED #1   // Katana
  ADD_STORE_ITEM SW1H46   LAST #0 #0 #0 IDENTIFIED #1   // Wakizashi
  ADD_STORE_ITEM SW1H48   LAST #0 #0 #0 IDENTIFIED #1   // Ninja-To
  ADD_STORE_ITEM DART02   LAST #20 #0 #0 IDENTIFIED #5  // Dart +1
  ADD_STORE_ITEM DART03   LAST #10 #0 #0 IDENTIFIED #4  // Dart of Stunning
  ADD_STORE_ITEM DART04   LAST #10 #0 #0 IDENTIFIED #4  // Dart of Wounding
  ADD_STORE_ITEM DART05   LAST #5 #0 #0 IDENTIFIED #4   // Asp's Nest
  ADD_STORE_ITEM STAF02   LAST #0 #0 #0 IDENTIFIED #1   // Quarterstaff +1
  ADD_STORE_ITEM SW1H22   LAST #0 #0 #0 IDENTIFIED #1   // Scimitar +1
  ADD_STORE_ITEM SW1H44   LAST #0 #0 #0 IDENTIFIED #1   // Katana +1
  ADD_STORE_ITEM SW1H47   LAST #0 #0 #0 IDENTIFIED #1   // Wakizashi +1
  ADD_STORE_ITEM SW1H49   LAST #0 #0 #0 IDENTIFIED #1   // Ninja-To +1

  ADD_STORE_ITEM wawak    LAST #0 #0 #0 IDENTIFIED #1   // Malakar's Companion +2

END BUT_ONLY

//////////////////

// SHOP05 - Perter
// 
// fletcher

// 100% stock overwrite

COPY_EXISTING shop05.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR rang=1 END
  REMOVE_STORE_ITEM 
    BOW01     // Composite Long Bow
    BOW03     // Long Bow
    BOW05     // Short Bow
    DAGG05    // Throwing Dagger
    AX1H04    // Throwing Axe
    DART01    // Dart
    SLNG01    // Sling 
    XBOW01    // Heavy Crossbow
    XBOW04    // Light Crossbow
    AROW01    // Arrows
    AROW02    // Arrows +1
    AROW05    // Arrow of Biting
    AROW07    // Arrows of Dispelling
    AROW08    // Arrow of Fire
    AROW09    // Arrows of Ice
    AROW11    // Arrow +2
    BOLT01    // Bolt
    BOLT04    // Bolt of Biting 
    BULL01    // Bullet
    LEAT04    // Studded Leather Armor
    SHLD08    // Buckler
    POTN30    // Potion of Infravision
    POTN44    // Potion of Strength
 // these are RR's additions
    ~RR#BOW02~  // Composite Short Bow

  LPF store INT_VAR
    sell=165
    buy=25
    steal=35
    fence=0
  END

  SAY 0xc @200113 // Perter the Fletcher

  ADD_STORE_ITEM BOW01    LAST #0 #0 #0 IDENTIFIED #3   // Composite Long Bow
  ADD_STORE_ITEM BOW03    LAST #0 #0 #0 IDENTIFIED #3   // Long Bow
  ADD_STORE_ITEM BOW05    LAST #0 #0 #0 IDENTIFIED #3   // Short Bow
  ADD_STORE_ITEM SLNG01   LAST #0 #0 #0 IDENTIFIED #3   // Sling 
  ADD_STORE_ITEM XBOW01   LAST #0 #0 #0 IDENTIFIED #3   // Heavy Crossbow
  ADD_STORE_ITEM XBOW04   LAST #0 #0 #0 IDENTIFIED #3   // Light Crossbow

  ADD_STORE_ITEM XBOW02   LAST #0 #0 #0 IDENTIFIED #1   // Heavy Crossbow +1
  ADD_STORE_ITEM XBOW05   LAST #0 #0 #0 IDENTIFIED #1   // Light Crossbow +1
  ADD_STORE_ITEM BOW04    LAST #0 #0 #0 IDENTIFIED #1   // Long Bow +1
  ADD_STORE_ITEM BOW02    LAST #0 #0 #0 IDENTIFIED #1   // Composite Long Bow +1
  ADD_STORE_ITEM BOW06    LAST #0 #0 #0 IDENTIFIED #1   // Short Bow +1
  ADD_STORE_ITEM SLNG02   LAST #0 #0 #0 IDENTIFIED #1   // Sling +1

  PATCH_IF comp_rr_equip=1 BEGIN
    ADD_STORE_ITEM ~RR#BOW02~ LAST #0 #0 #0 IDENTIFIED #3  // Composite Short Bow
    ADD_STORE_ITEM ~RR#BOW03~ LAST #0 #0 #0 IDENTIFIED #1  // Composite Short Bow +1
  END

  ADD_STORE_ITEM AROW01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED // Arrows
  ADD_STORE_ITEM BOLT01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED // Bolt
  ADD_STORE_ITEM BULL01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED // Bullet

  ADD_STORE_ITEM AROW02   LAST #40 #0 #0 IDENTIFIED #10 // Arrows +1
  ADD_STORE_ITEM AROW11   LAST #20 #0 #0 IDENTIFIED #5  // Arrow +2
  ADD_STORE_ITEM BOLT02   LAST #40 #0 #0 IDENTIFIED #10 // Bolt +1
  ADD_STORE_ITEM BOLT06   LAST #20 #0 #0 IDENTIFIED #5  // Bolt +2
  ADD_STORE_ITEM BULL02   LAST #40 #0 #0 IDENTIFIED #10 // Bullet +1
  ADD_STORE_ITEM BULL03   LAST #20 #0 #0 IDENTIFIED #5  // Bullet +2
  ADD_STORE_ITEM AROW05   LAST #20 #0 #0 IDENTIFIED #3  // Arrow of Biting
  PATCH_IF comp_nodispel=0 BEGIN
    ADD_STORE_ITEM AROW07   LAST #5 #0 #0 IDENTIFIED #4   // Arrows of Dispelling
  END
  ADD_STORE_ITEM AROW08   LAST #20 #0 #0 IDENTIFIED #5  // Arrow of Fire
  ADD_STORE_ITEM AROW09   LAST #20 #0 #0 IDENTIFIED #5  // Arrows of Ice
  ADD_STORE_ITEM BOLT04   LAST #20 #0 #0 IDENTIFIED #2  // Bolt of Biting 

  ADD_STORE_ITEM bull04   LAST #10 #0 #0 IDENTIFIED #2  // sunstone bullet
  ADD_STORE_ITEM BOLT03   LAST #20 #0 #0 IDENTIFIED #2  // Bolt of Lightning
  ADD_STORE_ITEM AROW04   LAST #20 #0 #0 IDENTIFIED #2  // Acid Arrows
  ADD_STORE_ITEM AROW10   LAST #20 #0 #0 IDENTIFIED #2  // Arrows of Piercing
  ADD_STORE_ITEM arow06   LAST #5 #0 #0 IDENTIFIED #1   // arrow of detonation
  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM AROW03   LAST #5  #0 #0 IDENTIFIED #1  // Arrow of Slaying
    ADD_STORE_ITEM BOLT05   LAST #5  #0 #0 IDENTIFIED #1  // Bolt or Polymorphing
    ADD_STORE_ITEM BOLT08   LAST #10 #0 #0 IDENTIFIED #1  // Blessed Bolt
    ADD_STORE_ITEM BULL06   LAST #10 #0 #0 IDENTIFIED #2  // Bullet of Smiting (Bullet +4)
  END

END BUT_ONLY

///////////////

// SHOP06 - Hes
// 
// stands near Galoomp, jeweler

// 100% stock overwrite

COPY_EXISTING shop06.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR jewel=1 END
  REMOVE_STORE_ITEM 
    POTN08    // Potion of Healing
    POTN20    // Antidote
    LEAT04    // Studded Leather Armor
    CHAN01    // Chain Mail Armor
    CHAN04    // Splint Mail
    PLAT01    // Plate Mail Armor
    SHLD01    // Small Shield
    SHLD03    // Medium Shield
    AROW01    // Arrows
    BOLT01    // Bolt
    BULL01    // Bullet
    AX1H04    // Throwing Axe
    BLUN02    // Flail
    BOW01     // Composite Long Bow
    BOW03     // Long Bow
    BOW05     // Short Bow
    DAGG01    // Dagger
    DAGG05    // Throwing Dagger
    DART01    // Dart
    HAMM01    // War Hammer
    SLNG01    // Sling 
    SW1H04    // Long Sword 
    SW1H07    // Short Sword 
    SW1H20    // Scimitar
    SW2H01    // Two Handed Sword
    XBOW01    // Heavy Crossbow
    XBOW04    // Light Crossbow
 // these are RR's additions
    ~RR#BOW02~  // Composite Short Bow

  LPF store INT_VAR
    sell=180
    buy=25
    steal=95 // he should be very wary of thieves, else he can't prosper as a jeweler
    fence=0
  END

  SAY 0xc @200114 // Hes the Jeweller

  ADD_STORE_ITEM amul05   LAST #0 #0 #0 IDENTIFIED #14  // bluestone
  ADD_STORE_ITEM amul06   LAST #0 #0 #0 IDENTIFIED #9   // anti-magnie
  ADD_STORE_ITEM amul07   LAST #0 #0 #0 IDENTIFIED #11  // rainbow obsidian
  ADD_STORE_ITEM amul09   LAST #0 #0 #0 IDENTIFIED #21  // silver
  ADD_STORE_ITEM amul10   LAST #0 #0 #0 IDENTIFIED #12  // gold
  ADD_STORE_ITEM amul11   LAST #0 #0 #0 IDENTIFIED #8   // pearl
  ADD_STORE_ITEM amul12   LAST #0 #0 #0 IDENTIFIED #3   // laeral's tear
  ADD_STORE_ITEM amul13   LAST #0 #0 #0 IDENTIFIED #5   // bloodstone
  ADD_STORE_ITEM ring10   LAST #0 #0 #0 IDENTIFIED #17  // gold
  ADD_STORE_ITEM ring11   LAST #0 #0 #0 IDENTIFIED #13  // silver
  ADD_STORE_ITEM ring12   LAST #0 #0 #0 IDENTIFIED #4   // onyx
  ADD_STORE_ITEM ring17   LAST #0 #0 #0 IDENTIFIED #2   // flamedance
  ADD_STORE_ITEM ring06   LAST #0 #0 #0 IDENTIFIED #1   // of protection +1
  ADD_STORE_ITEM ring18   LAST #0 #0 #0 IDENTIFIED #1   // fire opal
  ADD_STORE_ITEM ring19   LAST #0 #0 #0 IDENTIFIED #1   // ruby
  ADD_STORE_ITEM misc18   LAST #0 #0 #0 IDENTIFIED #1   // sunstone
  ADD_STORE_ITEM misc20   LAST #0 #0 #0 IDENTIFIED #3   // bloodstone
  ADD_STORE_ITEM misc25   LAST #0 #0 #0 IDENTIFIED #4   // zircone
  ADD_STORE_ITEM misc27   LAST #0 #0 #0 IDENTIFIED #12  // moonstone
  ADD_STORE_ITEM misc29   LAST #0 #0 #0 IDENTIFIED #8   // ziose
  ADD_STORE_ITEM misc33   LAST #0 #0 #0 IDENTIFIED #1   // aquamarine
  ADD_STORE_ITEM misc35   LAST #0 #0 #0 IDENTIFIED #3   // horn coral
  ADD_STORE_ITEM misc36   LAST #0 #0 #0 IDENTIFIED #3   // pearl
  ADD_STORE_ITEM misc41   LAST #0 #0 #0 IDENTIFIED #1   // star sapphire
  ADD_STORE_ITEM misc42   LAST #0 #0 #0 IDENTIFIED #3   // diamond
  ADD_STORE_ITEM misc43   LAST #0 #0 #0 IDENTIFIED #2   // emerald
  ADD_STORE_ITEM misc44   LAST #0 #0 #0 IDENTIFIED #1   // king's tears
  ADD_STORE_ITEM misc45   LAST #0 #0 #0 IDENTIFIED #1   // rogue stone

  ADD_STORE_ITEM BAG02    LAST  #0 #0 #0 IDENTIFIED #1   // Gem bag
  ADD_STORE_ITEM BAG02D   LAST  #0 #0 #0 IDENTIFIED #1   // Gem bag
  ADD_STORE_ITEM BAG02B   LAST  #0 #0 #0 IDENTIFIED #1   // Gem bag

END BUT_ONLY

/////////////////////

// SHOP07 - Storekeep
// 
// fatman weaponsmith somewhere in the midst, give him bladed non-exotic weapons

// 100% stock overwrite

COPY_EXISTING shop07.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR blade=1 END
  REMOVE_STORE_ITEM 
    CHAN01    // Chain Mail Armor
    CHAN04    // Splint Mail
    LEAT01    // Leather Armor
    LEAT04    // Studded Leather Armor
    PLAT01    // Plate Mail Armor
    AX1H01    // Battle Axe
    AX1H04    // Throwing Axe
    BLUN01    // Club
    BLUN02    // Flail
    BLUN04    // Mace
    BLUN06    // Morning Star
    BOW01     // Composite Long Bow
    BOW03     // Long Bow
    BOW05     // Short Bow
    DAGG01    // Dagger
    DAGG05    // Throwing Dagger
    DART01    // Dart
    HALB01    // Halberd
    HAMM01    // War Hammer
    SLNG01    // Sling 
    SPER01    // Spear
    STAF01    // Quarterstaff
    SW1H01    // Bastard Sword 
    SW1H04    // Long Sword 
    SW1H07    // Short Sword 
    SW1H20    // Scimitar
    SW1H43    // Katana
    SW1H46    // Wakizashi
    SW1H48    // Ninja-To
    SW2H01    // Two Handed Sword
    XBOW01    // Heavy Crossbow
    XBOW04    // Light Crossbow
    AROW01    // Arrows
    AROW02    // Arrows +1
    BOLT01    // Bolt
    BOLT02    // Bolt +1
    BULL01    // Bullet
    BULL02    // Bullet +1
    SHLD01    // Small Shield
    SHLD03    // Medium Shield
    SHLD05    // Large Shield
    SHLD08    // Buckler
    POTN44    // Potion of Strength
    POTN09    // Potion of Heroism
 // these are RR's additions
    ~RR#BOW02~  // Composite Short Bow

  LPF store INT_VAR
    sell=165
    buy=25
    steal=55
    fence=0
  END

  SAY 0xc @200115 // Storekeep the Weaponsmith :)

  ADD_STORE_ITEM SW1H01   LAST #0 #0 #0 IDENTIFIED #3   // Bastard Sword 
  ADD_STORE_ITEM SW1H02   LAST #0 #0 #0 IDENTIFIED #1   // Bastard Sword +1
  ADD_STORE_ITEM SW1H04   LAST #0 #0 #0 IDENTIFIED #4   // Long Sword 
  ADD_STORE_ITEM SW1H05   LAST #0 #0 #0 IDENTIFIED #1   // Long Sword +1
  ADD_STORE_ITEM SW1H07   LAST #0 #0 #0 IDENTIFIED #5   // Short Sword 
  ADD_STORE_ITEM SW1H08   LAST #0 #0 #0 IDENTIFIED #1   // Short Sword +1
  ADD_STORE_ITEM SW2H01   LAST #0 #0 #0 IDENTIFIED #2   // Two Handed Sword
  ADD_STORE_ITEM SW2H02   LAST #0 #0 #0 IDENTIFIED #1   // Two Handed Sword +1
  ADD_STORE_ITEM AX1H01   LAST #0 #0 #0 IDENTIFIED #2   // Battle Axe
  ADD_STORE_ITEM AX1H02   LAST #0 #0 #0 IDENTIFIED #1   // Battle Axe +1
  ADD_STORE_ITEM HALB01   LAST #0 #0 #0 IDENTIFIED #2   // Halberd
  ADD_STORE_ITEM HALB02   LAST #0 #0 #0 IDENTIFIED #1   // Halberd +1

END BUT_ONLY

//////////////////////////////////

// SHOP08 - Galoomp the Bookkeeper
// 
// map note says 'spellstore'
// Questpack has a quest for him, halfling stealing scrolls of 'Friends'
// make him a librarian, with books and non-violent spell selection

// 100% stock overwrite

COPY_EXISTING shop08.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR magic=1 potn=1 jewel=1 END
  REMOVE_STORE_ITEM 
    SCRL03    // Protection from Acid
    SCRL04    // Protection from Cold
    SCRL05    // Protection from Electricity
    SCRL06    // Protection from Fire
    SCRL08    // Protection from Poison
    SCRL09    // Protection from Undead
    SCRL15    // Protection from Petrification
    SCRL66    // Grease
    SCRL67    // Armor
    SCRL68    // Burning Hands
    SCRL69    // Charm Person
    SCRL70    // Color Spray
    SCRL71    // Blindness
    SCRL72    // Friends
    SCRL73    // Protection From Petrification
    SCRL75    // Identify
    SCRL76    // Infravision
    SCRL77    // Magic Missile
    SCRL78    // Protection From Evil
    SCRL79    // Shield
    SCRL80    // Shocking Grasp
    SCRL81    // Sleep
    SCRL82    // Chill Touch
    SCRL83    // Chromatic Orb
    SCRL84    // Larloch's Minor Drain
    SCRL85    // Blur
    SCRL86    // Detect Evil
    SCRL87    // Detect Invisibilty
    SCRL89    // Horror
    SCRL90    // Invisibilty
    SCRL91    // Knock
    SCRL92    // Know Alignment
    SCRL93    // Luck
    SCRL94    // Resist Fear
    SCRL95    // Melf's Acid Arrow
    SCRL96    // Mirror Image
    SCRL97    // Stinking Cloud
    SCRL98    // Strength
    SCRL99    // Web
    SCRL1B    // Agannazar's Scorcher
    SCRL3G    // Vocalize
    SCRL1C    // Ghoul Touch
    SCRL1D    // Clairvoyance
    SCRL1E    // Dispel Magic
    SCRL1F    // Flame Arrow
    SCRL1G    // Fireball
    SCRL1H    // Haste
    SCRL1I    // Hold Person
    SCRL1K    // Lightning Bolt
    SCRL1L    // Monster Summoning I
    SCRL1M    // Non-Detection
    SCRL1N    // Protection From Normal Missiles
    SCRL1O    // Slow
    SCRL1P    // Skull Trap
    SCRL1Q    // Vampiric Touch
    SCRL1S    // Dire Charm
    SCRL1T    // Ghost Armor
    SCRL1U    // Confusion
    SCRL1Y    // Improved Invisibility
    SCRL1Z    // Minor Globe of Invulnerability
    SCRL2A    // Monster Summoning II
    SCRL5G    // Remove Curse
    SCRL5H    // Emotion
    SCRL5I    // Greater Malison
    SCRL5J    // Oliluke's Resilient Sphere
    SCRL5K    // Spirit Armor
    SCRL5L    // Polymorph Other
    SCRL5M    // Polymorph Self
    SCRL2D    // Animate Dead
    SCRL2E    // Cloudkill
    SCRL2F    // Cone of Cold
    SCRL2G    // Monster Summoning III
    SCRL2H    // Shadow Door
    SCRL5N    // Domination
    SCRL5O    // Hold Monster
    SCRL5P    // Chaos
    SCRL5Q    // Feeblemind
    SCRL6M    // Enchanted Weapon
    SCRL5H    // Emotion
    SCRLA1    // Wizard Eye
    SCRLA5    // Melf's Minute Meteor
    BAG03D    // Scroll Case

  LPF store INT_VAR
    sell=200
    buy=25
    steal=30
    fence=0
  END

  WRITE_LONG 0xc 46422

  ADD_STORE_ITEM SCRL67   LAST #1 #0 #0 IDENTIFIED #2   // Armor
  ADD_STORE_ITEM SCRL69   LAST #1 #0 #0 IDENTIFIED #2   // Charm Person
  ADD_STORE_ITEM SCRL83   LAST #1 #0 #0 IDENTIFIED #2   // Chromatic Orb
  ADD_STORE_ITEM SCRL70   LAST #1 #0 #0 IDENTIFIED #2   // Color Spray
  ADD_STORE_ITEM SCRL66   LAST #1 #0 #0 IDENTIFIED #2   // Grease
  ADD_STORE_ITEM SCRL6D   LAST #1 #0 #0 IDENTIFIED #2   // Find Familiar
 // ADD_STORE_ITEM SCRL72   LAST #1 #0 #0 IDENTIFIED #2   // Friends    <-- that QuestPack's halfling has stolen all of them!
  ADD_STORE_ITEM SCRL75   LAST #1 #0 #0 IDENTIFIED #2   // Identify
  ADD_STORE_ITEM SCRL76   LAST #1 #0 #0 IDENTIFIED #2   // Infravision
  ADD_STORE_ITEM SCRL77   LAST #1 #0 #0 IDENTIFIED #2   // Magic Missile
  ADD_STORE_ITEM SCRL78   LAST #1 #0 #0 IDENTIFIED #2   // Protection From Evil
  ADD_STORE_ITEM SCRL73   LAST #1 #0 #0 IDENTIFIED #2   // Protection From Petrification
  ADD_STORE_ITEM SCRL79   LAST #1 #0 #0 IDENTIFIED #2   // Shield
  ADD_STORE_ITEM SCRL81   LAST #1 #0 #0 IDENTIFIED #2   // Sleep

  ADD_STORE_ITEM SCRL86   LAST #1 #0 #0 IDENTIFIED #1   // Detect Evil
  ADD_STORE_ITEM SCRL90   LAST #1 #0 #0 IDENTIFIED #1   // Invisibilty
  ADD_STORE_ITEM SCRL91   LAST #1 #0 #0 IDENTIFIED #1   // Knock
  ADD_STORE_ITEM SCRL92   LAST #1 #0 #0 IDENTIFIED #1   // Know Alignment
  ADD_STORE_ITEM SCRL93   LAST #1 #0 #0 IDENTIFIED #1   // Luck
  ADD_STORE_ITEM SCRL96   LAST #1 #0 #0 IDENTIFIED #1   // Mirror Image
  ADD_STORE_ITEM SCRL94   LAST #1 #0 #0 IDENTIFIED #1   // Resist Fear
  ADD_STORE_ITEM SCRL98   LAST #1 #0 #0 IDENTIFIED #1   // Strength
  ADD_STORE_ITEM SCRL99   LAST #1 #0 #0 IDENTIFIED #1   // Web
  ADD_STORE_ITEM SCRL3G   LAST #1 #0 #0 IDENTIFIED #1   // Vocalize

  ADD_STORE_ITEM SCRL1D   LAST #1 #0 #0 IDENTIFIED #1   // Clairvoyance
  ADD_STORE_ITEM SCRL6K   LAST #1 #0 #0 IDENTIFIED #1   // Detect Illusion
  ADD_STORE_ITEM SCRL1E   LAST #1 #0 #0 IDENTIFIED #1   // Dispel Magic
  ADD_STORE_ITEM SCRL6G   LAST #1 #0 #0 IDENTIFIED #1   // Minor Spell Deflection
  ADD_STORE_ITEM SCRL1M   LAST #1 #0 #0 IDENTIFIED #1   // Non-Detection
  ADD_STORE_ITEM SCRL1N   LAST #1 #0 #0 IDENTIFIED #1   // Protection From Normal Missiles

  ADD_STORE_ITEM SCRLAQ   LAST #1 #0 #0 IDENTIFIED #1   // Farsight
  ADD_STORE_ITEM SCRL1Z   LAST #1 #0 #0 IDENTIFIED #1   // Minor Globe of Invulnerability
  ADD_STORE_ITEM SCRL5M   LAST #1 #0 #0 IDENTIFIED #1   // Polymorph Self
  ADD_STORE_ITEM SCRL5G   LAST #1 #0 #0 IDENTIFIED #1   // Remove Curse
  ADD_STORE_ITEM SCRLA1   LAST #1 #0 #0 IDENTIFIED #1   // Wizard Eye

  ADD_STORE_ITEM BAG03D   LAST #0 #0 #0 IDENTIFIED #1   // Scroll Case

  ADD_STORE_ITEM book32   LAST #0 #0 #0 IDENTIFIED #3   // misc books
  ADD_STORE_ITEM book34   LAST #0 #0 #0 IDENTIFIED #5   // 
  ADD_STORE_ITEM book37   LAST #0 #0 #0 IDENTIFIED #3   // 
  ADD_STORE_ITEM book42   LAST #0 #0 #0 IDENTIFIED #3   // 
  ADD_STORE_ITEM book53   LAST #0 #0 #0 IDENTIFIED #1   // 
  ADD_STORE_ITEM book54   LAST #0 #0 #0 IDENTIFIED #4   // 
  ADD_STORE_ITEM book57   LAST #0 #0 #0 IDENTIFIED #2   // 
  ADD_STORE_ITEM book60   LAST #0 #0 #0 IDENTIFIED #7   // 
  ADD_STORE_ITEM book61   LAST #0 #0 #0 IDENTIFIED #10  // 

  ADD_STORE_ITEM book43   LAST #0 #0 #0 IDENTIFIED #2   // history of north
  ADD_STORE_ITEM book44   LAST #0 #0 #0 IDENTIFIED #2   // 
  ADD_STORE_ITEM book45   LAST #0 #0 #0 IDENTIFIED #2   // 
  ADD_STORE_ITEM book46   LAST #0 #0 #0 IDENTIFIED #2   // 
  ADD_STORE_ITEM book47   LAST #0 #0 #0 IDENTIFIED #2   // 
  ADD_STORE_ITEM book48   LAST #0 #0 #0 IDENTIFIED #2   // 
  ADD_STORE_ITEM book49   LAST #0 #0 #0 IDENTIFIED #2   // 
  ADD_STORE_ITEM book50   LAST #0 #0 #0 IDENTIFIED #2   // 
  ADD_STORE_ITEM book51   LAST #0 #0 #0 IDENTIFIED #2   // 
  ADD_STORE_ITEM book52   LAST #0 #0 #0 IDENTIFIED #2   // 

  ADD_STORE_ITEM book62   LAST #0 #0 #0 IDENTIFIED #2   // history of waterdeep
  ADD_STORE_ITEM book63   LAST #0 #0 #0 IDENTIFIED #2   // 
  ADD_STORE_ITEM book64   LAST #0 #0 #0 IDENTIFIED #2   // 
  ADD_STORE_ITEM book66   LAST #0 #0 #0 IDENTIFIED #2   // first 66, then 65
  ADD_STORE_ITEM book65   LAST #0 #0 #0 IDENTIFIED #2   // 
  ADD_STORE_ITEM book67   LAST #0 #0 #0 IDENTIFIED #2   // 

END BUT_ONLY

/////////////////////////
// Trademeet merchants //
/////////////////////////

/////////////////////////////

// TRCAR04 - Caravan Merchant
// 
// potions

// 100% stock overwrite

COPY_EXISTING trcar04.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    BLUN01    // Club
    BLUN02    // Flail
    BLUN06    // Morning Star
    BOW05     // Short Bow
    BOW06     // Short Bow +1
    DAGG05    // Throwing Dagger
    DART01    // Dart
    STAF07    // Staff Spear +2
    SW1H04    // Long Sword 
    SW1H07    // Short Sword 
    SW1H22    // Scimitar +1
    SW1H43    // Katana
    XBOW01    // Heavy Crossbow
    XBOW05    // Light Crossbow +1
    XBOW09    // Light Crossbow +2
    AROW01    // Arrows
    AROW11    // Arrow +2
    BOLT01    // Bolt
    BOLT06    // Bolt +2
    BULL01    // Bullet
    LEAT05    // Studded Leather Armor +1
    LEAT02    // Leather Armor +1
    AMUL01    // Necklace of Missiles
    SCRL04    // Protection from Cold
    POTN08    // Potion of Healing
    POTN20    // Antidote
    POTN41    // Potion of Power
    POTN42    // Potion of Regeneration 
    POTN36    // Potion of Master Thievery
    WAND05    // Wand of Fire
    SCRL6I    // Protection from Cold
    SCRL6J    // Spell Thrust
    SCRL6K    // Detect Illusion
    SCRL6L    // Hold Undead
    SCRL6M    // Enchanted Weapon
    SCRL6N    // Fireshield (Red)
    SCRL6O    // Secret Word
    SCRL6P    // Minor Sequencer
    SCRL6Q    // Teleport Field
    SCRL6R    // Spider Spawn
    SCRL6S    // Spell Immunity
    SCRL7O    // Protection From Magic Weapons
    SCRL7P    // Power Word Silence
    SCRL7Q    // Improved Haste
    SCRL7R    // Death Fog
    RESTORE   // Restoration
 // these are RR's additions
    ~RR#BOW02~  // Composite Short Bow
    ~RR#BOW03~  // Composite Short Bow +1

  LPF store INT_VAR
    sell=155
    buy=25
    steal=30
    fence=0
  END

  SAY 0xc @200117 // Caravan Master

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #34  // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #7   // Potion of Extra Healing
  ADD_STORE_ITEM POTN20   LAST #1 #0 #0 IDENTIFIED #2   // Antidote
  ADD_STORE_ITEM POTN17   LAST #1 #0 #0 IDENTIFIED #1   // Elixir of Health

  ADD_STORE_ITEM POTN19   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Agility
  ADD_STORE_ITEM POTN28   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Fortitude
  ADD_STORE_ITEM POTN29   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Genius
  ADD_STORE_ITEM POTN43   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Insight 

  ADD_STORE_ITEM POTN03   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Hill Giant Strength
  ADD_STORE_ITEM POTN12   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Stone Giant Strength
  ADD_STORE_ITEM POTN06   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Cloud Giant Strength

  ADD_STORE_ITEM POTN09   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Heroism

  ADD_STORE_ITEM POTN22   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Cold Resistance
  ADD_STORE_ITEM POTN31   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Insulation
  ADD_STORE_ITEM POTN34   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Magic Protection

  ADD_STORE_ITEM potn38   LAST #1 #0 #0 IDENTIFIED #2   // potion of mirrored eyes
  ADD_STORE_ITEM POTN24   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Defense
  ADD_STORE_ITEM POTN11   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Invulnerability
  ADD_STORE_ITEM POTN46   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Stone Form
  ADD_STORE_ITEM POTN18   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Absorbtion 

  ADD_STORE_ITEM POTN30   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Infravision
  ADD_STORE_ITEM POTN39   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Perception
  ADD_STORE_ITEM POTN36   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Master Thievery
  ADD_STORE_ITEM POTN10   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Invisibility
  ADD_STORE_ITEM POTN21   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Clarity
  ADD_STORE_ITEM POTN45   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Freedom

  ADD_STORE_ITEM POTN13   LAST #1 #0 #0 IDENTIFIED #2   // Oil of Fiery Burning
  ADD_STORE_ITEM POTN27   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Firebreath
  ADD_STORE_ITEM POTN26   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Explosions

END BUT_ONLY

////////////////////

// TRMER01 - Peddler
// 
// jewelry

// 100% stock overwrite

COPY_EXISTING trmer01.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR jewel=1 END
  REMOVE_STORE_ITEM 
    AX1H01    // Battle Axe
    BLUN02    // Flail
    BLUN06    // Morning Star
    BOW03     // Long Bow
    BOW05     // Short Bow
    DART01    // Dart
    SLNG01    // Sling 
    STAF01    // Quarterstaff
    SW1H04    // Long Sword 
    SW2H01    // Two Handed Sword
    XBOW01    // Heavy Crossbow
    AROW01    // Arrows
    BOLT01    // Bolt
    BULL01    // Bullet
    SHLD08    // Buckler
    SHLD03    // Medium Shield
    CHAN01    // Chain Mail Armor
    CHAN04    // Splint Mail
    LEAT04    // Studded Leather Armor
    LEAT01    // Leather Armor
    PLAT01    // Plate Mail Armor
    DAGG05    // Throwing Dagger
    POTN08    // Potion of Healing
    POTN09    // Potion of Heroism
    POTN30    // Potion of Infravision
    POTN44    // Potion of Strength
 // these are RR's additions
    ~RR#BOW02~  // Composite Short Bow

  LPF store INT_VAR
    sell=165
    buy=25
    steal=80
    fence=0
  END

  SAY 0xc @200118 // Jewelry Peddler

  ADD_STORE_ITEM amul05   LAST #0 #0 #0 IDENTIFIED #3   // bluestone
  ADD_STORE_ITEM amul07   LAST #0 #0 #0 IDENTIFIED #5   // rainbow obsidian
  ADD_STORE_ITEM amul09   LAST #0 #0 #0 IDENTIFIED #10  // silver
  ADD_STORE_ITEM amul10   LAST #0 #0 #0 IDENTIFIED #6   // gold
  ADD_STORE_ITEM amul12   LAST #0 #0 #0 IDENTIFIED #1   // laeral's tear
  ADD_STORE_ITEM amul13   LAST #0 #0 #0 IDENTIFIED #2   // bloodstone
  ADD_STORE_ITEM ring10   LAST #0 #0 #0 IDENTIFIED #7   // gold
  ADD_STORE_ITEM ring11   LAST #0 #0 #0 IDENTIFIED #10  // silver
  ADD_STORE_ITEM ring12   LAST #0 #0 #0 IDENTIFIED #4   // onyx
  ADD_STORE_ITEM ring17   LAST #0 #0 #0 IDENTIFIED #2   // flamedance
  ADD_STORE_ITEM ring06   LAST #0 #0 #0 IDENTIFIED #1   // of protection +1
  ADD_STORE_ITEM misc20   LAST #0 #0 #0 IDENTIFIED #3   // bloodstone
  ADD_STORE_ITEM misc25   LAST #0 #0 #0 IDENTIFIED #4   // zircone
  ADD_STORE_ITEM misc27   LAST #0 #0 #0 IDENTIFIED #7   // moonstone
  ADD_STORE_ITEM misc29   LAST #0 #0 #0 IDENTIFIED #5   // ziose
  ADD_STORE_ITEM misc35   LAST #0 #0 #0 IDENTIFIED #3   // horn coral
  ADD_STORE_ITEM misc36   LAST #0 #0 #0 IDENTIFIED #1   // pearl
  ADD_STORE_ITEM misc42   LAST #0 #0 #0 IDENTIFIED #1   // diamond
  ADD_STORE_ITEM misc43   LAST #0 #0 #0 IDENTIFIED #1   // emerald
  ADD_STORE_ITEM misc45   LAST #0 #0 #0 IDENTIFIED #1   // rogue stone

  ADD_STORE_ITEM BAG02C   LAST #0 #0 #0 IDENTIFIED #1   // Gem bag

END BUT_ONLY

/////////////////////

// TRMER02 - Merchant
// 
// nobleman, sells artifacts

// 100% stock overwrite

COPY_EXISTING trmer02.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    AX1H01    // Battle Axe
    AX1H02    // Battle Axe +1
    BLUN02    // Flail
    BLUN06    // Morning Star
    BLUN05    // Mace +1
    BLUN07    // Morning Star +1
    BLUN13    // Flail +2
    BLUN22    // Club +3, Blackblood
    HAMM06    // Dwarven Thrower +3
    BOW02     // Composite Long Bow +1
    BOW04     // Long Bow +1
    BOW06     // Short Bow +1
    BOW18     // Short Bow +2
    BOW15     // Tansheron's Bow +3
    DAGG01    // Dagger
    DAGG15    // Dagger +2
    DART01    // Dart
    SLNG01    // Sling 
    STAF01    // Quarterstaff
    STAF08    // Martial Staff +3
    STAF05    // Staff of Striking
    SW1H02    // Bastard Sword +1
    SW1H04    // Long Sword 
    SW1H07    // Short Sword 
    SW1H46    // Wakizashi
    SW1H22    // Scimitar +1
    SW1H41    // Long Sword +2
    SW1H33    // Ras +2
    SW2H01    // Two Handed Sword
    SW2H02    // Two Handed Sword +1
    XBOW01    // Heavy Crossbow
    XBOW09    // Light Crossbow +2
    AROW01    // Arrows
    AROW11    // Arrow +2
    AROW10    // Arrows of Piercing
    BOLT01    // Bolt
    BOLT02    // Bolt +1
    BULL01    // Bullet
    BULL03    // Bullet +2
    CHAN02    // Chain Mail +1
    CHAN08    // Chain Mail +2
    LEAT04    // Studded Leather Armor
    LEAT11    // Leather Armor +2
    PLAT01    // Plate Mail Armor
    PLAT10    // Plate Mail +1
    SHLD02    // Small Shield +1
    SHLD03    // Medium Shield
    SHLD08    // Buckler
    SHLD10    // Buckler
    SHLD15    // Large Shield
    SHLD04    // Medium Shield +1
    SHLD28    // Small Shield +2
    POTN20    // Antidote
    POTN08    // Potion of Healing
    CLCK03    // Cloak of Displacement
    BELT10    // Belt of Inertial Barrier
 // these are RR's additions
    ~RR#BOW03~  // Composite Short Bow +1
    ~RR#BOW04~  // Composite Short Bow +2
    ~RR#BUC02~  // Buckler +1
    ~RR#BUC03~  // Buckler +2

  LPF store INT_VAR
    sell=165
    buy=25
    steal=0
    fence=0
  END

  SAY 0xc @200119 // Artifact Dealer

  ADD_STORE_ITEM BLUN13   LAST #0 #0 #0 IDENTIFIED #1   // Flail +2
  ADD_STORE_ITEM BOW02    LAST #0 #0 #0 IDENTIFIED #1   // Composite Long Bow +1
  ADD_STORE_ITEM BOW18    LAST #0 #0 #0 IDENTIFIED #1   // Short Bow +2
  ADD_STORE_ITEM DAGG15   LAST #0 #0 #0 IDENTIFIED #1   // Dagger +2
  ADD_STORE_ITEM SW1H41   LAST #0 #0 #0 IDENTIFIED #1   // Long Sword +2
  ADD_STORE_ITEM XBOW09   LAST #0 #0 #0 IDENTIFIED #1   // Light Crossbow +2
  ADD_STORE_ITEM CHAN08   LAST #0 #0 #0 IDENTIFIED #1   // Chain Mail +2
  ADD_STORE_ITEM LEAT11   LAST #0 #0 #0 IDENTIFIED #1   // Leather Armor +2
  ADD_STORE_ITEM PLAT10   LAST #0 #0 #0 IDENTIFIED #1   // Plate Mail +2
  ADD_STORE_ITEM SHLD28   LAST #0 #0 #0 IDENTIFIED #1   // Small Shield +2

  PATCH_IF comp_rr_equip=1 BEGIN
    ADD_STORE_ITEM ~RR#BOW03~ LAST #0 #0 #0 IDENTIFIED #1  // Composite Short Bow +1
    ADD_STORE_ITEM ~RR#BUC03~ LAST #0 #0 #0 IDENTIFIED #1  // Buckler +2
  END

  ADD_STORE_ITEM BOW15    LAST #0 #0 #0 IDENTIFIED #1   // Tansheron's Bow +3
  ADD_STORE_ITEM STAF08   LAST #0 #0 #0 IDENTIFIED #1   // Martial Staff +3
  ADD_STORE_ITEM CLCK03   LAST #0 #0 #0 IDENTIFIED #1   // Cloak of Displacement
  ADD_STORE_ITEM BELT10   LAST #0 #0 #0 IDENTIFIED #1   // Belt of Inertial Barrier
  ADD_STORE_ITEM BLUN22   LAST #0 #0 #0 IDENTIFIED #1   // Club +3, Blackblood

  ADD_STORE_ITEM AMUL01   LAST #25 #0 #0 IDENTIFIED #1  // Necklace of Missiles
  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM WAND05   LAST #10 #0 #0 IDENTIFIED #1  // Wand of Fire
  END ELSE BEGIN
    ADD_STORE_ITEM WAND05   LAST #50 #50 #0 IDENTIFIED #1 // Wand of Fire
  END

END BUT_ONLY

/////////////////////

// TRMER03 - Fletcher
// 
// was cut from the game, as it would seem

// 100% stock overwrite

COPY_EXISTING ar2000.are override PATCH_IF SOURCE_SIZE>0x11c BEGIN
  WRITE_SHORT 0x58 (SHORT_AT 0x58)+1
  offset=LONG_AT 0x54
  INSERT_BYTES offset 0x110
  WRITE_ASCII offset+0x80 trmer03 (8)
  WRITE_SHORT offset+0x20 1000
  WRITE_SHORT offset+0x22 2680 // fish stand nearby. oh, well... at least it's an unclaimed place
  WRITE_SHORT offset+0x24 1000
  WRITE_SHORT offset+0x26 2680
  WRITE_BYTE  offset+0x28 1
  WRITE_LONG  offset+0x30 0x6101
  WRITE_LONG  offset+0x34 2
  WRITE_LONG  offset+0x38 ~-1~
  WRITE_LONG  offset+0x40 ~-1~
  PATCH_FOR_EACH off IN 0x5c  0x60  0x68  0x70  0x78  0x84  0x88  0xa8  0xb8  0x7c  0xa0  0xb0  0xbc  0xc0  0xc4  0xcc BEGIN
    PATCH_IF LONG_AT off>=offset BEGIN
      WRITE_LONG off LONG_AT off+0x110
    END
  END
END

COPY_EXISTING trmer03.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR rang=1 END
  REMOVE_STORE_ITEM 
    DART01    // Dart
    AROW01    // Arrows
    BOLT01    // Bolt
    BULL01    // Bullet
    AROW11    // Arrow +2
    BOLT06    // Bolt +2
    BULL03    // Bullet +2

  LPF store INT_VAR
    sell=155
    buy=25
    steal=35
    fence=0
  END

  ADD_STORE_ITEM AROW01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED  // Arrows
  ADD_STORE_ITEM BOLT01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED  // Bolt
  ADD_STORE_ITEM BULL01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED  // Bullet
  ADD_STORE_ITEM AROW02   LAST #40 #0 #0 IDENTIFIED #10 // Arrows +1
  ADD_STORE_ITEM BOLT02   LAST #40 #0 #0 IDENTIFIED #10 // Bolt +1
  ADD_STORE_ITEM BULL02   LAST #40 #0 #0 IDENTIFIED #10 // Bullet +1
  ADD_STORE_ITEM AROW11   LAST #20 #0 #0 IDENTIFIED #5  // Arrow +2
  ADD_STORE_ITEM BOLT06   LAST #20 #0 #0 IDENTIFIED #5  // Bolt +2
  ADD_STORE_ITEM BULL03   LAST #20 #0 #0 IDENTIFIED #5  // Bullet +2

  ADD_STORE_ITEM BOW07    LAST #0 #0 #0 IDENTIFIED #1   // Long Bow of Marksmanship

  ADD_STORE_ITEM BOW01    LAST #0 #0 #0 IDENTIFIED #2   // Composite Long Bow
  ADD_STORE_ITEM BOW02    LAST #0 #0 #0 IDENTIFIED #1   // Composite Long Bow +1
  ADD_STORE_ITEM BOW16    LAST #0 #0 #0 IDENTIFIED #1   // Composite Long Bow +2
  ADD_STORE_ITEM BOW03    LAST #0 #0 #0 IDENTIFIED #2   // Long Bow
  ADD_STORE_ITEM BOW04    LAST #0 #0 #0 IDENTIFIED #1   // Long Bow +1
  ADD_STORE_ITEM BOW17    LAST #0 #0 #0 IDENTIFIED #1   // Long Bow +2
  ADD_STORE_ITEM BOW05    LAST #0 #0 #0 IDENTIFIED #2   // Short Bow
  ADD_STORE_ITEM BOW06    LAST #0 #0 #0 IDENTIFIED #1   // Short Bow +1
  ADD_STORE_ITEM BOW18    LAST #0 #0 #0 IDENTIFIED #1   // Short Bow +2
  ADD_STORE_ITEM XBOW01   LAST #0 #0 #0 IDENTIFIED #2   // Heavy Crossbow
  ADD_STORE_ITEM XBOW02   LAST #0 #0 #0 IDENTIFIED #1   // Heavy Crossbow +1
  ADD_STORE_ITEM XBOW07   LAST #0 #0 #0 IDENTIFIED #1   // Heavy Crossbow +2
  ADD_STORE_ITEM XBOW04   LAST #0 #0 #0 IDENTIFIED #2   // Light Crossbow
  ADD_STORE_ITEM XBOW05   LAST #0 #0 #0 IDENTIFIED #1   // Light Crossbow +1
  ADD_STORE_ITEM XBOW09   LAST #0 #0 #0 IDENTIFIED #1   // Light Crossbow +2
  ADD_STORE_ITEM SLNG01   LAST #0 #0 #0 IDENTIFIED #2   // Sling 
  ADD_STORE_ITEM SLNG02   LAST #0 #0 #0 IDENTIFIED #1   // Sling +1
  ADD_STORE_ITEM SLNG04   LAST #0 #0 #0 IDENTIFIED #1   // Sling +2

  PATCH_IF comp_rr_equip=1 BEGIN
    ADD_STORE_ITEM ~RR#BOW02~ LAST #0 #0 #0 IDENTIFIED #2  // Composite Short Bow
    ADD_STORE_ITEM ~RR#BOW03~ LAST #0 #0 #0 IDENTIFIED #1  // Composite Short Bow +1
    ADD_STORE_ITEM ~RR#BOW04~ LAST #0 #0 #0 IDENTIFIED #1  // Composite Short Bow +2
  END

  ADD_STORE_ITEM AROW08   LAST #20 #0 #0 IDENTIFIED #6  // Arrow of Fire
  ADD_STORE_ITEM AROW09   LAST #20 #0 #0 IDENTIFIED #6  // Arrows of Ice
  ADD_STORE_ITEM AROW04   LAST #20 #0 #0 IDENTIFIED #3  // Acid Arrows
  ADD_STORE_ITEM AROW10   LAST #20 #0 #0 IDENTIFIED #3  // Arrows of Piercing
  ADD_STORE_ITEM AROW05   LAST #20 #0 #0 IDENTIFIED #3  // Arrow of Biting
  ADD_STORE_ITEM BOLT03   LAST #20 #0 #0 IDENTIFIED #3  // Bolt of Lightning
  ADD_STORE_ITEM AROW11   LAST #20 #0 #0 IDENTIFIED #3  // Bolt of Biting 
  ADD_STORE_ITEM bull04   LAST #10 #0 #0 IDENTIFIED #1  // sunstone bullet
  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM BOLT05   LAST #10 #0 #0 IDENTIFIED #1  // Blessed Bolt
    ADD_STORE_ITEM BULL06   LAST #10 #0 #0 IDENTIFIED #1  // Bullet of Smiting (Bullet +4)
  END

END BUT_ONLY

///////////////////////

// TRMER04 - Blacksmith
// 
// spell scrolls go away from a BLACKSMITH

// 100% stock overwrite

COPY_EXISTING trmer04.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 END
  REMOVE_STORE_ITEM 
    PLAT10    // Plate Mail +1
    LEAT02    // Leather Armor +1
    LEAT05    // Studded Leather Armor +1
    CHAN02    // Chain Mail +1
    SHLD02    // Small Shield +1
    SHLD06    // Large Shield +1
    SHLD01    // Small Shield
    SW1H02    // Bastard Sword +1
    SW1H05    // Long Sword +1
    SW1H08    // Short Sword +1
    SW1H22    // Scimitar +1
    SW2H02    // Two Handed Sword +1
    SPER02    // Spear +1
    BLUN03    // Flail +1
    BLUN05    // Mace +1
    BLUN07    // Morning Star +1
    XBOW05    // Light Crossbow +1
    BOW02     // Composite Long Bow +1
    BOW04     // Long Bow +1
    BOW06     // Short Bow +1
    SLNG02    // Sling +1
    AX1H02    // Battle Axe +1
    DAGG02    // Dagger +1
    AROW01    // Arrows
    BOLT01    // Bolt
    BULL01    // Bullet
    AROW11    // Arrow +2
    BOLT06    // Bolt +2
    BULL03    // Bullet +2
    DART01    // Dart
    DART02    // Dart +1
    POTN19    // Potion of Agility
    POTN09    // Potion of Heroism
    POTN04    // Potion of Frost Giant Strength
    POTN02    // Potion of Fire Resistance
    POTN28    // Potion of Fortitude
    SCRL6I    // Protection from Cold
    SCRL6J    // Spell Thrust
    SCRL6K    // Detect Illusion
    SCRL6L    // Hold Undead
    SCRL6M    // Enchanted Weapon
    SCRL6N    // Fireshield (Red)
    SCRL6T    // Protection From Normal Weapons
    SCRL6U    // Breach
    SCRL6V    // Lower Resistance
    SCRL6W    // Oracle
    SCRL6X    // Conjure Lesser Fire Elemental
    SCRL7J    // Protection From Magic Energy
    SCRL7K    // Mislead
    SCRL7L    // Pierce Magic
    SCRL7M    // True Sight
    CLCK15    // Robe of the Good Archmagi
 // these are RR's additions
    ~RR#BOW03~  // Composite Short Bow +1
    ~RR#BUC02~  // Buckler +1

  LPF store INT_VAR
    sell=155
    buy=25
    steal=60
    fence=0
  END

  ADD_STORE_ITEM SW1H01   LAST #0 #0 #0 IDENTIFIED #4   // Bastard Sword 
  ADD_STORE_ITEM SW1H02   LAST #0 #0 #0 IDENTIFIED #1   // Bastard Sword +1
  ADD_STORE_ITEM SW1H42   LAST #0 #0 #0 IDENTIFIED #1   // Bastard Sword +2
  ADD_STORE_ITEM SW1H04   LAST #0 #0 #0 IDENTIFIED #4   // Long Sword 
  ADD_STORE_ITEM SW1H05   LAST #0 #0 #0 IDENTIFIED #1   // Long Sword +1
  ADD_STORE_ITEM SW1H41   LAST #0 #0 #0 IDENTIFIED #1   // Long Sword +2
  ADD_STORE_ITEM SW1H07   LAST #0 #0 #0 IDENTIFIED #4   // Short Sword 
  ADD_STORE_ITEM SW1H08   LAST #0 #0 #0 IDENTIFIED #1   // Short Sword +1
  ADD_STORE_ITEM SW1H29   LAST #0 #0 #0 IDENTIFIED #1   // Short Sword +2
  ADD_STORE_ITEM SW2H01   LAST #0 #0 #0 IDENTIFIED #3   // Two Handed Sword
  ADD_STORE_ITEM SW2H02   LAST #0 #0 #0 IDENTIFIED #1   // Two Handed Sword +1
  ADD_STORE_ITEM SW2H11   LAST #0 #0 #0 IDENTIFIED #1   // Two Handed Sword +2
  ADD_STORE_ITEM AX1H01   LAST #0 #0 #0 IDENTIFIED #3   // Battle Axe
  ADD_STORE_ITEM AX1H02   LAST #0 #0 #0 IDENTIFIED #1   // Battle Axe +1
  ADD_STORE_ITEM AX1H11   LAST #0 #0 #0 IDENTIFIED #1   // Battle Axe +2
  ADD_STORE_ITEM SPER01   LAST #0 #0 #0 IDENTIFIED #3   // Spear
  ADD_STORE_ITEM SPER02   LAST #0 #0 #0 IDENTIFIED #1   // Spear +1
  ADD_STORE_ITEM SPER05   LAST #0 #0 #0 IDENTIFIED #1   // Spear +2
  ADD_STORE_ITEM HALB01   LAST #0 #0 #0 IDENTIFIED #3   // Halberd
  ADD_STORE_ITEM HALB02   LAST #0 #0 #0 IDENTIFIED #1   // Halberd +1
  ADD_STORE_ITEM HALB07   LAST #0 #0 #0 IDENTIFIED #1   // Halberd +2
  ADD_STORE_ITEM CHAN01   LAST #0 #0 #0 IDENTIFIED #2   // Chain Mail Armor
  ADD_STORE_ITEM CHAN02   LAST #0 #0 #0 IDENTIFIED #1   // Chain Mail +1
  ADD_STORE_ITEM CHAN08   LAST #0 #0 #0 IDENTIFIED #1   // Chain Mail +2
  ADD_STORE_ITEM CHAN04   LAST #0 #0 #0 IDENTIFIED #2   // Splint Mail
  ADD_STORE_ITEM CHAN05   LAST #0 #0 #0 IDENTIFIED #1   // Splint Mail +1
  ADD_STORE_ITEM PLAT01   LAST #0 #0 #0 IDENTIFIED #2   // Plate Mail Armor
  ADD_STORE_ITEM PLAT02   LAST #0 #0 #0 IDENTIFIED #1   // Plate Mail +1
  ADD_STORE_ITEM PLAT10   LAST #0 #0 #0 IDENTIFIED #1   // Plate Mail +2
  ADD_STORE_ITEM PLAT04   LAST #0 #0 #0 IDENTIFIED #1   // Full Plate Mail
  ADD_STORE_ITEM PLAT14   LAST #0 #0 #0 IDENTIFIED #1   // Full Plate Mail +1
  ADD_STORE_ITEM SHLD01   LAST #0 #0 #0 IDENTIFIED #1   // Small Shield
  ADD_STORE_ITEM SHLD02   LAST #0 #0 #0 IDENTIFIED #1   // Small Shield +1
  ADD_STORE_ITEM SHLD28   LAST #0 #0 #0 IDENTIFIED #1   // Small Shield +2
  ADD_STORE_ITEM SHLD03   LAST #0 #0 #0 IDENTIFIED #3   // Medium Shield
  ADD_STORE_ITEM SHLD04   LAST #0 #0 #0 IDENTIFIED #1   // Medium Shield +1
  ADD_STORE_ITEM SHLD29   LAST #0 #0 #0 IDENTIFIED #1   // Medium Shield +2
  ADD_STORE_ITEM SHLD05   LAST #0 #0 #0 IDENTIFIED #2   // Large Shield
  ADD_STORE_ITEM SHLD06   LAST #0 #0 #0 IDENTIFIED #1   // Large Shield +1
  ADD_STORE_ITEM SHLD30   LAST #0 #0 #0 IDENTIFIED #1   // Large Shield +2

  ADD_STORE_ITEM SW1H33   LAST #0 #0 #0 IDENTIFIED #1   // Ras +2
  ADD_STORE_ITEM STAF07   LAST #0 #0 #0 IDENTIFIED #1   // Staff Spear +2

END BUT_ONLY

////////////////////

// WALLACE - Wallace
// 
// dwarf

// 100% stock overwrite

COPY_EXISTING wallace.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR magic=1 END
  REMOVE_STORE_ITEM 
    DART01    // Dart
    AROW01    // Arrows
    BOLT01    // Bolt
    BULL01    // Bullet
    SLNG01    // Sling 
    AX1H01    // Battle Axe
    POTN08    // Potion of Healing
    POTN09    // Potion of Heroism
    POTN30    // Potion of Infravision
    POTN44    // Potion of Strength
    POTN21    // Potion of Clarity
    POTN42    // Potion of Regeneration 
    MISC43    // Emerald
    MISC6W    // Wooden Stake
    BAG03E    // Scroll Case

  LPF store INT_VAR
    sell=180
    buy=25
    steal=35
    fence=0
  END

  SAY 0xc @200121 // Spell Store

  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM wand02   LAST #10 #0 #0 IDENTIFIED #1  // fear
    ADD_STORE_ITEM wand03   LAST #10 #0 #0 IDENTIFIED #1  // mm
    ADD_STORE_ITEM wand08   LAST #10 #0 #0 IDENTIFIED #1  // sleep
  END ELSE BEGIN
    ADD_STORE_ITEM wand02   LAST #50 #0 #0 IDENTIFIED #1  // fear
    ADD_STORE_ITEM wand03   LAST #50 #0 #0 IDENTIFIED #1  // mm
    ADD_STORE_ITEM wand08   LAST #50 #0 #0 IDENTIFIED #1  // sleep
  END

  ADD_STORE_ITEM SCRL03   LAST #1 #0 #0 IDENTIFIED #2   // Protection from Acid
  ADD_STORE_ITEM SCRL04   LAST #1 #0 #0 IDENTIFIED #2   // Protection from Cold
  ADD_STORE_ITEM SCRL09   LAST #1 #0 #0 IDENTIFIED #2   // Protection from Undead
  ADD_STORE_ITEM SCRL15   LAST #1 #0 #0 IDENTIFIED #2   // Protection from Petrification

  ADD_STORE_ITEM BAG03E   LAST #0 #0 #0 IDENTIFIED #1   // Scroll Case

  ADD_STORE_ITEM SCRL67   LAST #1 #0 #0 IDENTIFIED #2   // Armor
  ADD_STORE_ITEM SCRL71   LAST #1 #0 #0 IDENTIFIED #2   // Blindness
  ADD_STORE_ITEM SCRL68   LAST #1 #0 #0 IDENTIFIED #2   // Burning Hands
  ADD_STORE_ITEM SCRL69   LAST #1 #0 #0 IDENTIFIED #2   // Charm Person
  ADD_STORE_ITEM SCRL83   LAST #1 #0 #0 IDENTIFIED #2   // Chromatic Orb
  ADD_STORE_ITEM SCRL70   LAST #1 #0 #0 IDENTIFIED #2   // Color Spray
  ADD_STORE_ITEM SCRL66   LAST #1 #0 #0 IDENTIFIED #2   // Grease
  ADD_STORE_ITEM SCRL75   LAST #1 #0 #0 IDENTIFIED #2   // Identify
  ADD_STORE_ITEM SCRL78   LAST #1 #0 #0 IDENTIFIED #2   // Protection From Evil
  ADD_STORE_ITEM SCRL73   LAST #1 #0 #0 IDENTIFIED #2   // Protection From Petrification
  ADD_STORE_ITEM SCRL79   LAST #1 #0 #0 IDENTIFIED #2   // Shield
  ADD_STORE_ITEM SCRL81   LAST #1 #0 #0 IDENTIFIED #2   // Sleep

  ADD_STORE_ITEM SCRL1B   LAST #1 #0 #0 IDENTIFIED #2   // Agannazar's Scorcher
  ADD_STORE_ITEM SCRL85   LAST #1 #0 #0 IDENTIFIED #2   // Blur
  ADD_STORE_ITEM SCRLA2   LAST #1 #0 #0 IDENTIFIED #2   // Deafness
  ADD_STORE_ITEM SCRL86   LAST #1 #0 #0 IDENTIFIED #2   // Detect Evil
  ADD_STORE_ITEM SCRL87   LAST #1 #0 #0 IDENTIFIED #2   // Detect Invisibilty
  ADD_STORE_ITEM SCRL1C   LAST #1 #0 #0 IDENTIFIED #2   // Ghoul Touch
  ADD_STORE_ITEM SCRLA3   LAST #1 #0 #0 IDENTIFIED #2   // Glitterdust
  ADD_STORE_ITEM SCRL89   LAST #1 #0 #0 IDENTIFIED #2   // Horror
  ADD_STORE_ITEM SCRL91   LAST #1 #0 #0 IDENTIFIED #2   // Knock
  ADD_STORE_ITEM SCRL92   LAST #1 #0 #0 IDENTIFIED #2   // Know Alignment
  ADD_STORE_ITEM SCRL93   LAST #1 #0 #0 IDENTIFIED #2   // Luck
  ADD_STORE_ITEM SCRL95   LAST #1 #0 #0 IDENTIFIED #2   // Melf's Acid Arrow
  ADD_STORE_ITEM SCRL6E   LAST #1 #0 #0 IDENTIFIED #2   // Power Word Sleep
  ADD_STORE_ITEM SCRL94   LAST #1 #0 #0 IDENTIFIED #2   // Resist Fear

  ADD_STORE_ITEM SCRL1D   LAST #1 #0 #0 IDENTIFIED #2   // Clairvoyance
  ADD_STORE_ITEM SCRL1E   LAST #1 #0 #0 IDENTIFIED #2   // Dispel Magic
  ADD_STORE_ITEM SCRL1G   LAST #1 #0 #0 IDENTIFIED #2   // Fireball
  ADD_STORE_ITEM SCRL1T   LAST #1 #0 #0 IDENTIFIED #2   // Ghost Armor
  ADD_STORE_ITEM SCRL1K   LAST #1 #0 #0 IDENTIFIED #2   // Lightning Bolt
  ADD_STORE_ITEM SCRL6G   LAST #1 #0 #0 IDENTIFIED #2   // Minor Spell Deflection
  PATCH_IF comp_sr=0 BEGIN
    ADD_STORE_ITEM SCRL6H   LAST #1 #0 #0 IDENTIFIED #2   // Protection from Fire
  END
  ADD_STORE_ITEM SCRL1N   LAST #1 #0 #0 IDENTIFIED #2   // Protection From Normal Missiles
  ADD_STORE_ITEM SCRL1P   LAST #1 #0 #0 IDENTIFIED #2   // Skull Trap
  ADD_STORE_ITEM SCRL6J   LAST #1 #0 #0 IDENTIFIED #2   // Spell Thrust

  ADD_STORE_ITEM SCRL6N   LAST #1 #0 #0 IDENTIFIED #1   // Fireshield (Red)
  ADD_STORE_ITEM SCRL1X   LAST #1 #0 #0 IDENTIFIED #1   // Ice Storm
  ADD_STORE_ITEM SCRL5G   LAST #1 #0 #0 IDENTIFIED #1   // Remove Curse
  ADD_STORE_ITEM SCRL6O   LAST #1 #0 #0 IDENTIFIED #1   // Secret Word
  ADD_STORE_ITEM SCRL5K   LAST #1 #0 #0 IDENTIFIED #1   // Spirit Armor

  PATCH_IF comp_sr=1 BEGIN
    ADD_STORE_ITEM SCRL6H   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Fire
  END
  ADD_STORE_ITEM SCRL6T   LAST #1 #0 #0 IDENTIFIED #1   // Protection From Normal Weapons
  ADD_STORE_ITEM SCRL6S   LAST #1 #0 #0 IDENTIFIED #1   // Spell Immunity

  ADD_STORE_ITEM SCRL7L   LAST #1 #0 #0 IDENTIFIED #1   // Pierce Magic
  ADD_STORE_ITEM SCRL7J   LAST #1 #0 #0 IDENTIFIED #1   // Protection From Magic Energy

END BUT_ONLY

/////////////////////
// other merchants //
/////////////////////

/////////////////////

// DSHOP02 - Jahaboam
// 
// sells a necklace for Jaheira, which makes him a jeweler
// being in the center of district full of thieves running around stealing things makes him immune to theft

// 100% stock overwrite

COPY_EXISTING dshop02.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR jewel=1 END
  REMOVE_STORE_ITEM 
    POTN30    // Potion of Infravision
    POTN09    // Potion of Heroism
    POTN08    // Potion of Healing
    POTN44    // Potion of Strength
    POTN20    // Antidote
    SCRL04    // Protection from Cold
    AX1H01    // Battle Axe
    BOW03     // Long Bow
    DAGG05    // Throwing Dagger
    AX1H04    // Throwing Axe
    DART01    // Dart
    STAF01    // Quarterstaff
    SW1H48    // Ninja-To
    SW1H07    // Short Sword 
    SW2H01    // Two Handed Sword
    XBOW04    // Light Crossbow
    AROW01    // Arrows
    BOLT01    // Bolt
    BULL01    // Bullet
    LEAT04    // Studded Leather Armor
    SHLD05    // Large Shield
    SHLD03    // Medium Shield
    SHLD01    // Small Shield
    SHLD08    // Buckler

  LPF store INT_VAR
    sell=165
    buy=25
    steal=0
    fence=0
  END

  SAY 0xc @200122 // Jahaboam's Trinkets

  ADD_STORE_ITEM amul05   LAST #0 #0 #0 IDENTIFIED #11  // bluestone
  ADD_STORE_ITEM amul06   LAST #0 #0 #0 IDENTIFIED #9   // anti-magnie
  ADD_STORE_ITEM amul07   LAST #0 #0 #0 IDENTIFIED #5   // rainbow obsidian
  ADD_STORE_ITEM amul09   LAST #0 #0 #0 IDENTIFIED #7   // silver
  ADD_STORE_ITEM amul10   LAST #0 #0 #0 IDENTIFIED #6   // gold
  ADD_STORE_ITEM amul11   LAST #0 #0 #0 IDENTIFIED #2   // pearl
  ADD_STORE_ITEM amul13   LAST #0 #0 #0 IDENTIFIED #1   // bloodstone
  ADD_STORE_ITEM ring10   LAST #0 #0 #0 IDENTIFIED #14  // gold
  ADD_STORE_ITEM ring11   LAST #0 #0 #0 IDENTIFIED #12  // silver
  ADD_STORE_ITEM ring12   LAST #0 #0 #0 IDENTIFIED #1   // onyx
  ADD_STORE_ITEM misc20   LAST #0 #0 #0 IDENTIFIED #3   // bloodstone
  ADD_STORE_ITEM misc25   LAST #0 #0 #0 IDENTIFIED #2   // zircone
  ADD_STORE_ITEM misc27   LAST #0 #0 #0 IDENTIFIED #10  // moonstone
  ADD_STORE_ITEM misc29   LAST #0 #0 #0 IDENTIFIED #4   // ziose
  ADD_STORE_ITEM misc35   LAST #0 #0 #0 IDENTIFIED #3   // horn coral
  ADD_STORE_ITEM misc36   LAST #0 #0 #0 IDENTIFIED #1   // pearl

  ADD_STORE_ITEM BAG02F   LAST #0 #0 #0 IDENTIFIED #1   // Gem bag

END BUT_ONLY

//////////////////

// DSHOP01 - Ikert
// 
// halfling near Cowled Wizard's house in Docks

// 100% stock overwrite

// BSHOP02 - Storekeep
// 
// elf girl fence near Bel Dalemark

// 100% stock overwrite

// to whoever decides to comment out a part of installer - these two guys share
// one block, so you better don't try to separate them or you may screw things up

// robbing Dalok of Flametongue
COPY_EXISTING cedruid2.cre override LPF FJ_CRE_VALIDITY RET valid=valid END PATCH_IF valid BEGIN
  REMOVE_CRE_ITEM sw1h24
END BUT_ONLY

// swapping Ikert and elf-on-the-bridge, dialog and scripts remain tied to original area

COPY_EXISTING bshop02.cre override LPF FJ_CRE_VALIDITY RET valid=valid END PATCH_IF valid BEGIN
  READ_ASCII 0x248 bridge_scripts (40)
  READ_ASCII 0x2cc bridge_dialog (8)
END

COPY_EXISTING dshop01.cre override LPF FJ_CRE_VALIDITY RET valid=valid END PATCH_IF valid BEGIN
  READ_ASCII 0x248 docks_scripts (40)
  READ_ASCII 0x2cc docks_dialog (8)
  WRITE_ASCIIE 0x248 ~%bridge_scripts%~ (40)
  WRITE_ASCIIE 0x2cc ~%bridge_dialog%~ (8)
END

COPY_EXISTING bshop02.cre override LPF FJ_CRE_VALIDITY RET valid=valid END PATCH_IF valid BEGIN
  WRITE_ASCIIE 0x248 ~%docks_scripts%~ (40)
  WRITE_ASCIIE 0x2cc ~%docks_dialog%~ (8)
  SAY NAME1 @200104
  SAY NAME2 @200104
END

STRING_SET 22407 @200105

COPY_EXISTING ar0500.are override PATCH_IF SOURCE_SIZE>0x11c BEGIN
  CLEAR_ARRAY actor GET_OFFSET_ARRAY actor 0x54 4 0x58 2 0 0 0x110
  PHP_EACH actor AS ind => res BEGIN
    READ_ASCII res+0x80 actor (8) NULL
    PATCH_IF ~%actor%~ STRING_EQUAL_CASE bshop02 BEGIN
      WRITE_ASCII res+0x80 dshop01 (8)
      WRITE_LONG  res+0x30 0x5303
    END
  END
END

COPY_EXISTING ar0300.are override PATCH_IF SOURCE_SIZE>0x11c BEGIN
  CLEAR_ARRAY actor GET_OFFSET_ARRAY actor 0x54 4 0x58 2 0 0 0x110
  PHP_EACH actor AS ind => res BEGIN
    READ_ASCII res+0x80 actor (8) NULL
    PATCH_IF ~%actor%~ STRING_EQUAL_CASE dshop01 BEGIN
      WRITE_ASCII res+0x80 bshop02 (8)
      WRITE_LONG  res+0x30 0x6011
    END
  END
END

// docks store, elven
 
COPY_EXISTING dshop01.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR elf=1 END
  REMOVE_STORE_ITEM 
    AX1H01    // Battle Axe
    BLUN02    // Flail
    BLUN06    // Morning Star
    BOW03     // Long Bow
    BOW05     // Short Bow
    DART01    // Dart
    SLNG01    // Sling 
    STAF01    // Quarterstaff
    SW1H04    // Long Sword 
    SW2H01    // Two Handed Sword
    XBOW01    // Heavy Crossbow
    AROW01    // Arrows
    BOLT01    // Bolt
    BULL01    // Bullet
    SHLD08    // Buckler
    SHLD03    // Medium Shield
    CHAN01    // Chain Mail Armor
    CHAN04    // Splint Mail
    LEAT04    // Studded Leather Armor
    LEAT01    // Leather Armor
    PLAT01    // Plate Mail Armor
    DAGG05    // Throwing Dagger
    POTN08    // Potion of Healing
    POTN09    // Potion of Heroism
    POTN30    // Potion of Infravision
    POTN44    // Potion of Strength
    BAG03C    // Scroll Case
 // these are RR's additions
    ~RR#BOW02~  // Composite Short Bow

  LPF store INT_VAR
    sell=155
    buy=25
    steal=40
    fence=0
  END

  SAY 0xc @200106 // Humble Establishment

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Healing
  ADD_STORE_ITEM POTN19   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Agility
  ADD_STORE_ITEM POTN13   LAST #1 #0 #0 IDENTIFIED #1   // Oil of Fiery Burning
  ADD_STORE_ITEM POTN39   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Perception
  ADD_STORE_ITEM ring17   LAST #0 #0 #0 IDENTIFIED #1   // flamedance
  ADD_STORE_ITEM SW1H04   LAST #0 #0 #0 IDENTIFIED #1   // Long Sword 
  ADD_STORE_ITEM SW1H05   LAST #0 #0 #0 IDENTIFIED #1   // Long Sword +1
  ADD_STORE_ITEM SW1H41   LAST #0 #0 #0 IDENTIFIED #1   // Long Sword +2
  ADD_STORE_ITEM SW1H24   LAST #0 #0 #0 IDENTIFIED #1   // Flametongue
  ADD_STORE_ITEM BOW03    LAST #0 #0 #0 IDENTIFIED #2   // Long Bow
  ADD_STORE_ITEM BOW04    LAST #0 #0 #0 IDENTIFIED #1   // Long Bow +1
  ADD_STORE_ITEM BOW17    LAST #0 #0 #0 IDENTIFIED #1   // Long Bow +2
  ADD_STORE_ITEM CHAN12   LAST #0 #0 #0 IDENTIFIED #1   // Elven Chain Mail
  ADD_STORE_ITEM AROW01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED // Arrows
  ADD_STORE_ITEM AROW02   LAST #40 #0 #0 IDENTIFIED #5  // Arrows +1
  ADD_STORE_ITEM AROW11   LAST #20 #0 #0 IDENTIFIED #1  // Arrow +2
  ADD_STORE_ITEM AROW08   LAST #20 #0 #0 IDENTIFIED #4  // Arrow of Fire
  ADD_STORE_ITEM arow06   LAST #5 #0 #0 IDENTIFIED #1   // arrow of detonation

END BUT_ONLY

// bridge store, buys stolen goods at good price

COPY_EXISTING bshop02.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    STAF01    // Quarterstaff
    DART01    // Dart
    AROW01    // Arrows
    BOLT01    // Bolt
    BULL01    // Bullet
    GBERRY    // Good Berry
    LEAT01    // Leather Armor
    LEAT10    // Hide Armor
    CHAN01    // Chain Mail Armor
    HELM08    // Helmet
    HELM13    // Helmet
    SHLD05    // Large Shield
    SHLD09    // Buckler
    SW1H01    // Bastard Sword 
    SW1H07    // Short Sword 
    SW1H43    // Katana
    SW2H01    // Two Handed Sword
    BLUN01    // Club
    BLUN02    // Flail
    XBOW01    // Heavy Crossbow
    BOW01     // Composite Long Bow
    BOW03     // Long Bow
    BOW05     // Short Bow
    SLNG01    // Sling 
    AX1H01    // Battle Axe
    AX1H04    // Throwing Axe
    POTN08    // Potion of Healing
    POTN09    // Potion of Heroism
    POTN30    // Potion of Infravision
    POTN44    // Potion of Strength
    BAG02C    // Gem bag
 // these are RR's additions
    BLUN01    // Club
    ~RR#SAP01~  // Sap
    ~RR#BOW02~  // Composite Short Bow

  LPF store INT_VAR
    sell=145
    buy=20
    steal=0
    fence=1
  END
  WRITE_BYTE 0x10 BYTE_AT 0x10 &`32 // disable the temple menu. could have been put into 'store', but for two places only?

  SAY 0xc @200123 // Quite Legitimate Goods

  ADD_STORE_ITEM LEAT05   LAST #0 #0 #0 IDENTIFIED #1   // Studded Leather Armor +1
  ADD_STORE_ITEM SW1H47   LAST #0 #0 #0 IDENTIFIED #1   // Wakizashi +1
  ADD_STORE_ITEM SW1H48   LAST #0 #0 #0 IDENTIFIED #1   // Ninja-To
  ADD_STORE_ITEM XBOW04   LAST #0 #0 #0 IDENTIFIED #1   // Light Crossbow
  ADD_STORE_ITEM HALB02   LAST #0 #0 #0 IDENTIFIED #1   // Halberd +1
  ADD_STORE_ITEM DAGG01   LAST #0 #0 #0 IDENTIFIED #1   // Dagger
  ADD_STORE_ITEM DAGG02   LAST #0 #0 #0 IDENTIFIED #1   // Dagger +1
  ADD_STORE_ITEM SCRL09   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Undead
  ADD_STORE_ITEM SCRL67   LAST #1 #0 #0 IDENTIFIED #1   // Armor
  ADD_STORE_ITEM POTN10   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Invisibility
  ADD_STORE_ITEM POTN17   LAST #1 #0 #0 IDENTIFIED #1   // Elixir of Health
  ADD_STORE_ITEM POTN02   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Fire Resistance
  ADD_STORE_ITEM ring10   LAST #0 #0 #0 IDENTIFIED #1   // gold
  ADD_STORE_ITEM CLCK10   LAST #0 #0 #0 IDENTIFIED #1   // Mage Robe of Fire Resistance
  ADD_STORE_ITEM misc35   LAST #0 #0 #0 IDENTIFIED #1   // horn coral
  ADD_STORE_ITEM SCRL87   LAST #1 #0 #0 IDENTIFIED #1   // Detect Invisibilty
  ADD_STORE_ITEM DART04   LAST #10 #0 #0 IDENTIFIED #2  // Dart of Wounding
  ADD_STORE_ITEM AROW04   LAST #10 #0 #0 IDENTIFIED #1  // Acid Arrows

  PATCH_IF comp_rr_equip=1 BEGIN
    ADD_STORE_ITEM ~RR#BOW02~ LAST #0 #0 #0 IDENTIFIED #1  // Composite Short Bow
  END

END BUT_ONLY

//////////////////////////

// MERCHANT - Bel Dalemark
// 
// helps to investigate skin murders
// give him berries and leather

// 100% stock overwrite

COPY_EXISTING merchant.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    AX1H01    // Battle Axe
    AX1H04    // Throwing Axe
    BLUN01    // Club
    BLUN02    // Flail
    BLUN04    // Mace
    BLUN06    // Morning Star
    BOW01     // Composite Long Bow
    BOW03     // Long Bow
    BOW05     // Short Bow
    DAGG01    // Dagger
    DAGG05    // Throwing Dagger
    DART01    // Dart
    HALB01    // Halberd
    HAMM01    // War Hammer
    SLNG01    // Sling 
    SPER01    // Spear
    STAF01    // Quarterstaff
    SW1H01    // Bastard Sword 
    SW1H04    // Long Sword 
    SW1H07    // Short Sword 
    SW1H20    // Scimitar
    SW1H43    // Katana
    SW1H46    // Wakizashi
    SW1H48    // Ninja-To
    SW2H01    // Two Handed Sword
    XBOW01    // Heavy Crossbow
    XBOW04    // Light Crossbow
    AROW01    // Arrows
    BOLT01    // Bolt
    BULL01    // Bullet
    BULL02    // Bullet +1
    LEAT01    // Leather Armor
    LEAT04    // Studded Leather Armor
    CHAN01    // Chain Mail Armor
    CHAN04    // Splint Mail
    PLAT01    // Plate Mail Armor
    PLAT04    // Full Plate Mail
    SHLD01    // Small Shield
    SHLD03    // Medium Shield
    SHLD05    // Large Shield
    SHLD08    // Buckler
    SHLD12    // Small Shield
    POTN44    // Potion of Strength
 // these are RR's additions
    ~RR#BOW02~  // Composite Short Bow

  LPF store INT_VAR
    sell=165
    buy=25
    steal=45
    fence=0
  END

  ADD_STORE_ITEM gberry   LAST #5 #0 #0 IDENTIFIED #20  // goodberry
  ADD_STORE_ITEM fireseed LAST #1 #0 #0 IDENTIFIED #2   // fireseed
  ADD_STORE_ITEM LEAT01   LAST #0 #0 #0 IDENTIFIED #3   // Leather Armor
  ADD_STORE_ITEM LEAT02   LAST #0 #0 #0 IDENTIFIED #1   // Leather Armor +1
  ADD_STORE_ITEM LEAT04   LAST #0 #0 #0 IDENTIFIED #3   // Studded Leather Armor
  ADD_STORE_ITEM LEAT05   LAST #0 #0 #0 IDENTIFIED #1   // Studded Leather Armor +1
  ADD_STORE_ITEM LEAT10   LAST #0 #0 #0 IDENTIFIED #3   // Hide Armor

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Healing
  ADD_STORE_ITEM POTN03   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Hill Giant Strength
  ADD_STORE_ITEM POTN14   LAST #1 #0 #0 IDENTIFIED #1   // Oil of Speed
  ADD_STORE_ITEM POTN45   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Freedom
  ADD_STORE_ITEM POTN26   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Explosions
  ADD_STORE_ITEM misc43   LAST #0 #0 #0 IDENTIFIED #1   // emerald
  ADD_STORE_ITEM amul07   LAST #0 #0 #0 IDENTIFIED #1   // rainbow obsidian
  ADD_STORE_ITEM ring10   LAST #0 #0 #0 IDENTIFIED #1   // gold
  ADD_STORE_ITEM ring12   LAST #0 #0 #0 IDENTIFIED #1   // onyx
  ADD_STORE_ITEM amul11   LAST #0 #0 #0 IDENTIFIED #1   // pearl

END BUT_ONLY

//////////////////////////

// MURCRAG - Mrs. Cragmoon
// 
// semi-legal potions

// 100% stock overwrite

COPY_EXISTING murcrag.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR potn=1 END
  REMOVE_STORE_ITEM 
    POTN08    // Potion of Healing
    POTN17    // Elixir of Health
    POTN20    // Antidote
    POTN42    // Potion of Regeneration 
    POTN22    // Potion of Cold Resistance
    POTN24    // Potion of Defense
    POTN10    // Potion of Invisibility
    POTN03    // Potion of Hill Giant Strength
    POTN02    // Potion of Fire Resistance
    POTN09    // Potion of Heroism
    POTN46    // Potion of Stone Form
    POTN41    // Potion of Power
    POTN40    // Potion of Invulnerability
    POTN14    // Oil of Speed
    POTN36    // Potion of Master Thievery
    POTN19    // Potion of Agility
    POTN29    // Potion of Genius
    POTN28    // Potion of Fortitude
    POTN04    // Potion of Frost Giant Strength
    POTN12    // Potion of Stone Giant Strength

  LPF store INT_VAR
    sell=145
    buy=25
    steal=30
    fence=0
  END

  ADD_STORE_ITEM POTN08  LAST #1 #0 #0 IDENTIFIED #26  // Potion of Healing
  ADD_STORE_ITEM POTN52  LAST #1 #0 #0 IDENTIFIED #5   // Potion of Extra Healing
  ADD_STORE_ITEM POTN17  LAST #1 #0 #0 IDENTIFIED #2   // Elixir of Health
  ADD_STORE_ITEM POTN20  LAST #1 #0 #0 IDENTIFIED #2   // Antidote
  ADD_STORE_ITEM POTN42  LAST #1 #0 #0 IDENTIFIED #3   // Potion of Regeneration 

  ADD_STORE_ITEM POTN19  LAST #1 #0 #0 IDENTIFIED #1   // Potion of Agility
  ADD_STORE_ITEM POTN29  LAST #1 #0 #0 IDENTIFIED #2   // Potion of Genius
  ADD_STORE_ITEM POTN28  LAST #1 #0 #0 IDENTIFIED #1   // Potion of Fortitude
  ADD_STORE_ITEM POTN44  LAST #1 #0 #0 IDENTIFIED #2   // Potion of Strength

  ADD_STORE_ITEM POTN03  LAST #1 #0 #0 IDENTIFIED #1   // Potion of Hill Giant Strength
  ADD_STORE_ITEM POTN12  LAST #1 #0 #0 IDENTIFIED #1   // Potion of Stone Giant Strength

  ADD_STORE_ITEM POTN09  LAST #1 #0 #0 IDENTIFIED #1   // Potion of Heroism
  ADD_STORE_ITEM POTN14  LAST #1 #0 #0 IDENTIFIED #1   // Oil of Speed
  ADD_STORE_ITEM POTN41  LAST #1 #0 #0 IDENTIFIED #2   // Potion of Power

  ADD_STORE_ITEM POTN02  LAST #1 #0 #0 IDENTIFIED #1   // Potion of Fire Resistance
  ADD_STORE_ITEM POTN22  LAST #1 #0 #0 IDENTIFIED #1   // Potion of Cold Resistance

  ADD_STORE_ITEM POTN24  LAST #1 #0 #0 IDENTIFIED #1   // Potion of Defense
  ADD_STORE_ITEM POTN46  LAST #1 #0 #0 IDENTIFIED #1   // Potion of Stone Form

  ADD_STORE_ITEM POTN10  LAST #1 #0 #0 IDENTIFIED #1   // Potion of Invisibility
  ADD_STORE_ITEM POTN36  LAST #1 #0 #0 IDENTIFIED #1   // Potion of Master Thievery

END BUT_ONLY

////////////////////////////

// UHMER01 - Elence Fielding
// 
// elf girl in Immensville

// 100% stock overwrite

COPY_EXISTING uhmer01.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR magic=1 END
  REMOVE_STORE_ITEM 
    AMUL10    // Gold Necklace
    DAGG01    // Dagger
    DAGG05    // Throwing Dagger
    DAGG02    // Dagger +1
    AX1H01    // Battle Axe
    SW1H01    // Bastard Sword 
    SW1H04    // Long Sword 
    SW1H05    // Long Sword +1
    SW1H07    // Short Sword 
    SW1H08    // Short Sword +1
    SW1H20    // Scimitar
    SW1H43    // Katana
    SW1H46    // Wakizashi
    SW1H48    // Ninja-To
    SW2H01    // Two Handed Sword
    LEAT01    // Leather Armor
    LEAT04    // Studded Leather Armor
    CHAN04    // Splint Mail
    CHAN01    // Chain Mail Armor
    STAF01    // Quarterstaff
    HAMM01    // War Hammer
    SPER01    // Spear
    BLUN01    // Club
    BLUN02    // Flail
    BLUN04    // Mace
    BLUN06    // Morning Star
    XBOW01    // Heavy Crossbow
    XBOW04    // Light Crossbow
    BOW01     // Composite Long Bow
    BOW03     // Long Bow
    BOW05     // Short Bow
    SLNG01    // Sling 
    AX1H01    // Battle Axe
    AX1H04    // Throwing Axe
    DAGG01    // Dagger
    HALB01    // Halberd
    DART01    // Dart
    AROW01    // Arrows
    BOLT01    // Bolt
    BOLT06    // Bolt +2
    BULL01    // Bullet
    BULL03    // Bullet +2
    POTN02    // Potion of Fire Resistance
 // these are RR's additions
    ~RR#BOW02~  // Composite Short Bow

  LPF store INT_VAR
    sell=155
    buy=25
    steal=0
    fence=0
  END

  SAY 0xc @200124 // Elence's Charms

  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM wand02   LAST #10 #0 #0 IDENTIFIED #1  // fear
  END ELSE BEGIN
    ADD_STORE_ITEM wand02   LAST #50 #0 #0 IDENTIFIED #1  // fear
  END

  ADD_STORE_ITEM CLCK07   LAST #1 #0 #0 IDENTIFIED #1   // Nymph Cloak

  PATCH_IF comp_ir_potions BEGIN
    ADD_STORE_ITEM potn43   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Insight/Memory
  END

  ADD_STORE_ITEM SCRL69   LAST #1 #0 #0 IDENTIFIED #2   // Charm Person
  ADD_STORE_ITEM SCRL70   LAST #1 #0 #0 IDENTIFIED #2   // Color Spray
  ADD_STORE_ITEM SCRL72   LAST #1 #0 #0 IDENTIFIED #2   // Friends
  ADD_STORE_ITEM SCRL81   LAST #1 #0 #0 IDENTIFIED #2   // Sleep

  ADD_STORE_ITEM SCRL93   LAST #1 #0 #0 IDENTIFIED #2   // Luck
  ADD_STORE_ITEM SCRL6E   LAST #1 #0 #0 IDENTIFIED #2   // Power Word Sleep
  ADD_STORE_ITEM SCRL3G   LAST #1 #0 #0 IDENTIFIED #2   // Vocalize

  ADD_STORE_ITEM SCRL1S   LAST #1 #0 #0 IDENTIFIED #1   // Dire Charm
  ADD_STORE_ITEM SCRL1I   LAST #1 #0 #0 IDENTIFIED #1   // Hold Person

  ADD_STORE_ITEM SCRL1U   LAST #1 #0 #0 IDENTIFIED #1   // Confusion
  ADD_STORE_ITEM SCRL5H   LAST #1 #0 #0 IDENTIFIED #1   // Emotion
  ADD_STORE_ITEM SCRL6M   LAST #1 #0 #0 IDENTIFIED #1   // Enchanted Weapon
  ADD_STORE_ITEM SCRL5I   LAST #1 #0 #0 IDENTIFIED #1   // Greater Malison

  ADD_STORE_ITEM SCRL5N   LAST #1 #0 #0 IDENTIFIED #1   // Domination
  ADD_STORE_ITEM SCRL5O   LAST #1 #0 #0 IDENTIFIED #1   // Hold Monster

END BUT_ONLY

///////////////////////

// UHMER02 - Min Mining
// 
// gnome in Immensville
// arrogant jerk, give him trash worth his demeanor

// 100% stock overwrite

COPY_EXISTING uhmer02.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 END
  REMOVE_STORE_ITEM 
    MISC97    // De'Tranion's Baalor Ale
    AMUL10    // Gold Necklace
    AMUL13    // Bloodstone Amulet
    DAGG01    // Dagger
    BLUN06    // Morning Star
    AROW01    // Arrows
    BOLT01    // Bolt
    BULL01    // Bullet
    POTN20    // Antidote
    POTN36    // Potion of Master Thievery
    POTN19    // Potion of Agility
    POTN29    // Potion of Genius
    POTN22    // Potion of Cold Resistance
    POTN02    // Potion of Fire Resistance
    POTN04    // Potion of Frost Giant Strength
    BAG02F    // Gem bag

  LPF store INT_VAR
    sell=135
    buy=25
    steal=75
    fence=0
  END

  SAY 0xc @200125 // Min the Gnome

  ADD_STORE_ITEM AX1H01   LAST #0 #0 #0 IDENTIFIED #2   // Battle Axe
  ADD_STORE_ITEM SW1H01   LAST #0 #0 #0 IDENTIFIED #4   // Bastard Sword 
  ADD_STORE_ITEM SW1H04   LAST #0 #0 #0 IDENTIFIED #3   // Long Sword 
  ADD_STORE_ITEM SW1H07   LAST #0 #0 #0 IDENTIFIED #4   // Short Sword 
  ADD_STORE_ITEM LEAT01   LAST #0 #0 #0 IDENTIFIED #3   // Leather Armor
  ADD_STORE_ITEM LEAT04   LAST #0 #0 #0 IDENTIFIED #1   // Studded Leather Armor
  ADD_STORE_ITEM LEAT10   LAST #0 #0 #0 IDENTIFIED #1   // Hide Armor
  ADD_STORE_ITEM SHLD10   LAST #0 #0 #0 IDENTIFIED #3   // Buckler
  ADD_STORE_ITEM SHLD11   LAST #0 #0 #0 IDENTIFIED #2   // Small Shield
  ADD_STORE_ITEM XBOW04   LAST #0 #0 #0 IDENTIFIED #1   // Light Crossbow
  ADD_STORE_ITEM BOW05    LAST #0 #0 #0 IDENTIFIED #3   // Short Bow
  ADD_STORE_ITEM SLNG01   LAST #0 #0 #0 IDENTIFIED #1   // Sling 
  ADD_STORE_ITEM AROW01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED // Arrows
  ADD_STORE_ITEM BOLT01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED // Bolt
  ADD_STORE_ITEM BULL01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED // Bullet

END BUT_ONLY

//////////////////////////

// UHMER03 - Beherant Diir
// 
// fatman in Immensville
// make him a druid

// 100% stock overwrite

COPY_EXISTING uhmer03.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    SHLD03    // Medium Shield
    SHLD08    // Buckler
    SHLD09    // Buckler
    SHLD11    // Small Shield
    SHLD14    // Medium Shield
    SHLD16    // Large Shield
    SHLD02    // Small Shield +1
    LEAT01    // Leather Armor
    LEAT04    // Studded Leather Armor
    CHAN04    // Splint Mail
    CHAN01    // Chain Mail Armor
    PLAT10    // Plate Mail +1
    LEAT05    // Studded Leather Armor +1
 // these are RR's additions
    ~RR#BUC02~  // Buckler +1

  LPF store INT_VAR
    sell=135
    buy=25
    steal=0
    fence=0
  END

  WRITE_BYTE 0x10 BYTE_AT 0x10 |32 // enable the temple menu. could have been put into 'store', but for two places only?
  LPF temple INT_VAR
    cure_light_wounds=25
    cure_medium_wounds=50
    neutralize_poison=100
  END

  SAY 0xc @200126 // Nature's Blessings

  ADD_STORE_ITEM gberry   LAST #5 #0 #0 IDENTIFIED #53  // goodberry
  ADD_STORE_ITEM fireseed LAST #1 #0 #0 IDENTIFIED #11  // fireseed

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #17  // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #4   // Potion of Extra Healing
  ADD_STORE_ITEM POTN20   LAST #1 #0 #0 IDENTIFIED #2   // Antidote
  ADD_STORE_ITEM POTN17   LAST #1 #0 #0 IDENTIFIED #1   // Elixir of Health
  ADD_STORE_ITEM POTN42   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Regeneration 
  ADD_STORE_ITEM POTN45   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Freedom

  ADD_STORE_ITEM SPER01   LAST #0 #0 #0 IDENTIFIED #1   // Spear
  ADD_STORE_ITEM SPER02   LAST #0 #0 #0 IDENTIFIED #1   // Spear +1
  ADD_STORE_ITEM STAF01   LAST #0 #0 #0 IDENTIFIED #5   // Quarterstaff
  ADD_STORE_ITEM STAF02   LAST #0 #0 #0 IDENTIFIED #1   // Quarterstaff +1
  ADD_STORE_ITEM LEAT01   LAST #0 #0 #0 IDENTIFIED #1   // Leather Armor
  ADD_STORE_ITEM LEAT02   LAST #0 #0 #0 IDENTIFIED #1   // Leather Armor +1
  ADD_STORE_ITEM SHLD08   LAST #0 #0 #0 IDENTIFIED #2   // Buckler
  ADD_STORE_ITEM SHLD17   LAST #0 #0 #0 IDENTIFIED #1   // Buckler +1

  ADD_STORE_ITEM clck01   LAST #0 #0 #0 IDENTIFIED #1   // cloak of protection +1
  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM RING03   LAST #0 #0 #0 IDENTIFIED #1   // Ring of Animal Friendship
  END ELSE BEGIN
    ADD_STORE_ITEM RING03   LAST #1 #0 #0 IDENTIFIED #1   // Ring of Animal Friendship
  END
  ADD_STORE_ITEM staf16   LAST #0 #1 #1 IDENTIFIED #1   // Staff of Earth
  ADD_STORE_ITEM MISC97   LAST #0 #0 #0 IDENTIFIED #3   // De'Tranion's Baalor Ale

  ADD_STORE_ITEM scrl56   LAST #1 #0 #0 IDENTIFIED #3   //cure serious wounds
  ADD_STORE_ITEM scrl59   LAST #1 #0 #0 IDENTIFIED #3   //neutralize poison

END BUT_ONLY

///////////////////////

// PPSTOR01 - Storekeep
// 
// dude from Brynnlaw
// give him pirate weapons

// 100% stock overwrite

COPY_EXISTING ar2209.are override PATCH_IF SOURCE_SIZE>0x11c BEGIN // take Water Edge from Ust'Natha
  LPF DELETE_AREA_ITEM STR_VAR item_to_delete=sw1h52 END
END BUT_ONLY

COPY_EXISTING ppstor01.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    DART01    // Dart
    AROW01    // Arrows
    AROW11    // Arrow +2
    BOLT01    // Bolt
    BOLT02    // Bolt +1
    BULL01    // Bullet
    BULL03    // Bullet +2
    SHLD01    // Small Shield
    SHLD03    // Medium Shield
    SHLD08    // Buckler
    SHLD10    // Buckler
    SHLD15    // Large Shield
    SHLD04    // Medium Shield +1
    SHLD28    // Small Shield +2
    PLAT10    // Plate Mail +1
    LEAT02    // Leather Armor +1
    LEAT05    // Studded Leather Armor +1
    CHAN02    // Chain Mail +1
    CHAN05    // Splint Mail +1
    SHLD02    // Small Shield +1
    SHLD04    // Medium Shield +1
    SHLD06    // Large Shield +1
    STAF01    // Quarterstaff
    SW1H22    // Scimitar +1
    SW2H02    // Two Handed Sword +1
    SW1H02    // Bastard Sword +1
    SW1H05    // Long Sword +1
    SW1H08    // Short Sword +1
    SW1H44    // Katana +1
    SPER02    // Spear +1
    BLUN03    // Flail +1
    BLUN05    // Mace +1
    BLUN07    // Morning Star +1
    XBOW02    // Heavy Crossbow +1
    XBOW05    // Light Crossbow +1
    BOW02     // Composite Long Bow +1
    BOW04     // Long Bow +1
    BOW06     // Short Bow +1
    SLNG02    // Sling +1
    AX1H02    // Battle Axe +1
    DAGG02    // Dagger +1
    HALB02    // Halberd +1
    DART02    // Dart +1
    POTN20    // Antidote
    POTN03    // Potion of Hill Giant Strength
    POTN28    // Potion of Fortitude
    POTN19    // Potion of Agility
    SCRL6D    // Find Familiar
    SCRL6E    // Power Word Sleep
    SCRL6F    // Ray of Enfeeblement
    SCRL6G    // Minor Spell Deflection
    SCRL6H    // Protection from Fire
    SCRL6T    // Protection From Normal Weapons
    SCRL6U    // Breach
    SCRL6V    // Lower Resistance
    SCRL6W    // Oracle
    SCRL6X    // Conjure Lesser Fire Elemental
    SCRL7S    // Chain Lightning
    SCRL7T    // Disintegrate
    SCRL7U    // Contingency
    SCRL7V    // Spell Deflection
    RESTORE   // Restoration
 // these are RR's additions
    ~RR#BOW03~  // Composite Short Bow +1
    ~RR#BUC02~  // Buckler +1
    ~RR#BUC03~  // Buckler +2

  LPF store INT_VAR
    sell=145
    buy=20
    steal=0
    fence=1
  END

  ADD_STORE_ITEM DART01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED // Dart
  ADD_STORE_ITEM DART02   LAST #20 #0 #0 IDENTIFIED #5   // Dart +1
  ADD_STORE_ITEM AROW01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED // Arrows
  ADD_STORE_ITEM AROW11   LAST #20 #0 #0 IDENTIFIED #2   // Arrow +2
  ADD_STORE_ITEM BOLT01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED // Bolt
  ADD_STORE_ITEM BOLT02   LAST #20 #0 #0 IDENTIFIED #5   // Bolt +1
  ADD_STORE_ITEM BULL01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED // Bullet
  ADD_STORE_ITEM BULL03   LAST #20 #0 #0 IDENTIFIED #2   // Bullet +2

  ADD_STORE_ITEM SHLD01   LAST #0 #0 #0 IDENTIFIED #1   // Small Shield
  ADD_STORE_ITEM SHLD08   LAST #0 #0 #0 IDENTIFIED #7   // Buckler
  ADD_STORE_ITEM SHLD17   LAST #0 #0 #0 IDENTIFIED #2   // Buckler +1
  ADD_STORE_ITEM SHLD28   LAST #0 #0 #0 IDENTIFIED #1   // Small Shield +2
  ADD_STORE_ITEM LEAT02   LAST #0 #0 #0 IDENTIFIED #1   // Leather Armor +1
  ADD_STORE_ITEM LEAT05   LAST #0 #0 #0 IDENTIFIED #1   // Studded Leather Armor +1
  ADD_STORE_ITEM SHLD02   LAST #0 #0 #0 IDENTIFIED #1   // Small Shield +1
  ADD_STORE_ITEM SW1H20   LAST #0 #0 #0 IDENTIFIED #14  // Scimitar
  ADD_STORE_ITEM SW1H22   LAST #0 #0 #0 IDENTIFIED #3   // Scimitar +1
  ADD_STORE_ITEM SW1H05   LAST #0 #0 #0 IDENTIFIED #1   // Long Sword +1
  ADD_STORE_ITEM SW1H08   LAST #0 #0 #0 IDENTIFIED #1   // Short Sword +1
  ADD_STORE_ITEM XBOW02   LAST #0 #0 #0 IDENTIFIED #1   // Heavy Crossbow +1
  ADD_STORE_ITEM XBOW05   LAST #0 #0 #0 IDENTIFIED #1   // Light Crossbow +1
  ADD_STORE_ITEM BOW06    LAST #0 #0 #0 IDENTIFIED #1   // Short Bow +1
  ADD_STORE_ITEM DAGG02   LAST #0 #0 #0 IDENTIFIED #1   // Dagger +1

  PATCH_IF comp_rr_equip=1 BEGIN
    ADD_STORE_ITEM ~RR#BOW03~ LAST #0 #0 #0 IDENTIFIED #1  // Composite Short Bow +1
    ADD_STORE_ITEM ~RR#BUC03~ LAST #0 #0 #0 IDENTIFIED #1  // Buckler +2
  END

  ADD_STORE_ITEM sw1h36   LAST #0 #1 #0 IDENTIFIED #1   // Namarra +2
  ADD_STORE_ITEM SW1H52   LAST #0 #0 #0 IDENTIFIED #1   // Water Edge

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #13  // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #4   // Potion of Extra Healing
  ADD_STORE_ITEM POTN20   LAST #1 #0 #0 IDENTIFIED #2   // Antidote
  ADD_STORE_ITEM POTN03   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Hill Giant Strength
  ADD_STORE_ITEM POTN28   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Fortitude
  ADD_STORE_ITEM POTN19   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Agility

END BUT_ONLY

///////////////
//  temples  //
///////////////

///////////////////////////

// BHELM - Guardian Vottnar
// 
// Bridge District

// 100% stock overwrite

COPY_EXISTING bhelm.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy END
  REMOVE_STORE_ITEM 
    SCRL09    // Protection from Undead
    SCRL15    // Protection from Petrification
    SCRLPET   // Stone to Flesh Scroll
    SCRL05    // Protection from Electricity
    POTN08    // Potion of Healing
    POTN29    // Potion of Genius
    POTN37    // Potion of Mind Focusing
    POTN43    // Potion of Insight 
    POTN17    // Elixir of Health
    POTN09    // Potion of Heroism
    POTN21    // Potion of Clarity
    POTN25    // Potion of Healing
    POTN20    // Antidote
    RESTORE   // Restoration
    MISC6W    // Wooden Stake

  LPF store INT_VAR
    sell=145
    steal=0
  END

  LPF temple INT_VAR
    cure_light_wounds=25
    dispel_magic=200
    remove_curse=500
    cure_medium_wounds=50
    cure_serious_wounds=75
    raise_dead=1000
  END

  ADD_STORE_ITEM SW1H01   LAST #0 #0 #0 IDENTIFIED #2   // Bastard Sword 
  ADD_STORE_ITEM SW1H02   LAST #0 #0 #0 IDENTIFIED #1   // Bastard Sword +1
  ADD_STORE_ITEM SHLD03   LAST #0 #0 #0 IDENTIFIED #2   // Medium Shield
  ADD_STORE_ITEM SHLD04   LAST #0 #0 #0 IDENTIFIED #1   // Medium Shield +1
  ADD_STORE_ITEM SHLD05   LAST #0 #0 #0 IDENTIFIED #2   // Large Shield
  ADD_STORE_ITEM SHLD06   LAST #0 #0 #0 IDENTIFIED #1   // Large Shield +1

  ADD_STORE_ITEM helm10   LAST #0 #0 #0 IDENTIFIED #1   // helmet
  ADD_STORE_ITEM helm11   LAST #0 #0 #0 IDENTIFIED #1   // helmet

  ADD_STORE_ITEM SCRL15   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Petrification

  ADD_STORE_ITEM restore  LAST #1 #0 #0 IDENTIFIED #1   // restoration
  ADD_STORE_ITEM SCRL63   LAST #1 #0 #0 IDENTIFIED #1   // raise dead
  ADD_STORE_ITEM SCRLPET  LAST #1 #0 #0 IDENTIFIED #1   // Stone to Flesh Scroll

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #10  // Potion of Healing
  PATCH_IF comp_ir_potions BEGIN
    ADD_STORE_ITEM POTN30   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Infravision/Sight
  END ELSE BEGIN
    ADD_STORE_ITEM POTN44   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Strength
  END
  ADD_STORE_ITEM POTN24   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Defense

  ADD_STORE_ITEM ~ag#ir02~  LAST #1 #0 #0 IDENTIFIED #3   // Sanctuary
  ADD_STORE_ITEM ~ag#ir06~  LAST #1 #0 #0 IDENTIFIED #3   // Silence
  ADD_STORE_ITEM ~ag#ir0b~  LAST #1 #0 #0 IDENTIFIED #2   // Remove Curse/Break Enchantment
  ADD_STORE_ITEM ~ag#ir09~  LAST #1 #0 #0 IDENTIFIED #2   // Dispel Magic
  ADD_STORE_ITEM ~ag#ir0a~  LAST #1 #0 #0 IDENTIFIED #2   // Glyph of Warding
  ADD_STORE_ITEM scrl56     LAST #1 #0 #0 IDENTIFIED #2   // cure serious wounds
  ADD_STORE_ITEM scrl61     LAST #1 #0 #0 IDENTIFIED #2   // cure critical wounds
  ADD_STORE_ITEM scrl5b     LAST #1 #0 #0 IDENTIFIED #2   // defensive harmony
  ADD_STORE_ITEM scrl5e     LAST #1 #0 #0 IDENTIFIED #1   // champion's strength
  ADD_STORE_ITEM ~ag#ir0f~  LAST #1 #0 #0 IDENTIFIED #1   // Magic Resistance
  ADD_STORE_ITEM ~ag#ir07~  LAST #1 #0 #0 IDENTIFIED #1   // True Sight

END BUT_ONLY

///////////////////////////

// DOGHMA - Priest of Oghma
// 
// Docks

// 100% stock overwrite

COPY_EXISTING doghma.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy END
  REMOVE_STORE_ITEM 
    POTN08    // Potion of Healing
    POTN29    // Potion of Genius
    POTN37    // Potion of Mind Focusing
    POTN43    // Potion of Insight 
    POTN17    // Elixir of Health
    POTN25    // Potion of Healing
    POTN20    // Antidote
    SCRLPET   // Stone to Flesh Scroll
    SCRL63    // Raise Dead
    SCRL08    // Protection from Poison
    SCRL04    // Protection from Cold
    RING03    // Ring of Animal Friendship
    RESTORE   // Restoration

  LPF store INT_VAR
    sell=145
    steal=0
  END
  WRITE_BYTE 0x10 THIS |4 // enable identification. the only place i use it at
  WRITE_LONG 0x40 50 // half-price identification

  LPF temple INT_VAR
    cure_light_wounds=25
    dispel_magic=50
    remove_curse=125
    cure_medium_wounds=50
    cure_serious_wounds=75
    raise_dead=1000
  END

  ADD_STORE_ITEM SW1H04   LAST #0 #0 #0 IDENTIFIED #2   // Long Sword 
  ADD_STORE_ITEM SW1H05   LAST #0 #0 #0 IDENTIFIED #1   // Long Sword +1
  ADD_STORE_ITEM CLCK13   LAST #0 #0 #0 IDENTIFIED #1   // Traveller's Robe
  ADD_STORE_ITEM MISC3P   LAST #3 #0 #0 IDENTIFIED #1   // Glasses of Identification

  ADD_STORE_ITEM restore  LAST #1 #0 #0 IDENTIFIED #1   // restoration
  ADD_STORE_ITEM SCRL63   LAST #1 #0 #0 IDENTIFIED #1   // raise dead
  ADD_STORE_ITEM SCRLPET  LAST #1 #0 #0 IDENTIFIED #1   // Stone to Flesh Scroll

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #10  // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Extra Healing
  ADD_STORE_ITEM POTN29   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Genius
  ADD_STORE_ITEM POTN43   LAST #1 #0 #0 IDENTIFIED #4   // Potion of Insight 
  ADD_STORE_ITEM POTN36   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Master Thievery
  ADD_STORE_ITEM POTN45   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Freedom

  ADD_STORE_ITEM ~ag#ir01~  LAST #1 #0 #0 IDENTIFIED #3   // Bless
  ADD_STORE_ITEM ~ag#ir05~  LAST #1 #0 #0 IDENTIFIED #3   // Find Traps
  ADD_STORE_ITEM ~ag#ir0b~  LAST #1 #0 #0 IDENTIFIED #3   // Remove Curse/Break Enchantment
  ADD_STORE_ITEM scrl56     LAST #1 #0 #0 IDENTIFIED #3   // cure serious wounds
  ADD_STORE_ITEM scrl58     LAST #1 #0 #0 IDENTIFIED #3   // free action
  ADD_STORE_ITEM ~ag#ir09~  LAST #1 #0 #0 IDENTIFIED #3   // Dispel Magic
  ADD_STORE_ITEM scrl5f     LAST #1 #0 #0 IDENTIFIED #2   // chaotic commands
  ADD_STORE_ITEM scrl5a     LAST #1 #0 #0 IDENTIFIED #2   // mental domination
  ADD_STORE_ITEM ~ag#ir07~  LAST #1 #0 #0 IDENTIFIED #2   // True Sight

END BUT_ONLY

///////////////////////////////

// GOVWAU01 - Priest of Waukeen
// 
// Government District
// i honestly don't know what to do with Waukeen, can think of no items fitting her temple well

// 100% stock overwrite

COPY_EXISTING govwau01.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy END
  REMOVE_STORE_ITEM 
    POTN08    // Potion of Healing
    POTN29    // Potion of Genius
    POTN37    // Potion of Mind Focusing
    POTN43    // Potion of Insight 
    POTN17    // Elixir of Health
    POTN25    // Potion of Healing
    POTN20    // Antidote
    SCRLPET   // Stone to Flesh Scroll
    SCRL63    // Raise Dead
    SCRL08    // Protection from Poison
    SCRL04    // Protection from Cold
    RING03    // Ring of Animal Friendship
    RESTORE   // Restoration

  LPF store INT_VAR
    sell=145
    steal=0
  END

  LPF temple INT_VAR
    cure_light_wounds=25
    dispel_magic=200
    cure_medium_wounds=50
    cure_serious_wounds=75
    neutralize_poison=300
    cure_critical_wounds=100
    raise_dead=1000
  END

  ADD_STORE_ITEM STAF19   LAST #0 #0 #0 IDENTIFIED #1   // Cleric's Staff +3
  ADD_STORE_ITEM CLCK14   LAST #0 #0 #0 IDENTIFIED #1   // Adventurer's Robe

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #10  // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Extra Healing

  ADD_STORE_ITEM SCRL04   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Cold

  ADD_STORE_ITEM restore  LAST #1 #0 #0 IDENTIFIED #1   // restoration
  ADD_STORE_ITEM SCRL63   LAST #1 #0 #0 IDENTIFIED #1   // raise dead
  ADD_STORE_ITEM SCRLPET  LAST #1 #0 #0 IDENTIFIED #1   // Stone to Flesh Scroll

  ADD_STORE_ITEM amul10   LAST #0 #0 #0 IDENTIFIED #3   // gold
  ADD_STORE_ITEM ring10   LAST #0 #0 #0 IDENTIFIED #5   // gold
  ADD_STORE_ITEM misc43   LAST #0 #0 #0 IDENTIFIED #1   // emerald

  ADD_STORE_ITEM MISC6W   LAST #0 #0 #0 IDENTIFIED #1 UNLIMITED  // Wooden Stake

  ADD_STORE_ITEM ~ag#ir01~  LAST #1 #0 #0 IDENTIFIED #2   // Bless
  ADD_STORE_ITEM ~ag#ir02~  LAST #1 #0 #0 IDENTIFIED #2   // Sanctuary
  ADD_STORE_ITEM ~ag#ir05~  LAST #1 #0 #0 IDENTIFIED #2   // Find Traps
  ADD_STORE_ITEM ~ag#ir0b~  LAST #1 #0 #0 IDENTIFIED #2   // Remove Curse/Break Enchantment
  ADD_STORE_ITEM scrl56     LAST #1 #0 #0 IDENTIFIED #2   // cure serious wounds
  ADD_STORE_ITEM ~ag#ir0c~  LAST #1 #0 #0 IDENTIFIED #2   // Remove Paralysis
  ADD_STORE_ITEM scrl61     LAST #1 #0 #0 IDENTIFIED #1   // cure critical wounds
  ADD_STORE_ITEM scrl58     LAST #1 #0 #0 IDENTIFIED #1   // free action
  ADD_STORE_ITEM scrl5d     LAST #1 #0 #0 IDENTIFIED #1   // protection from evil 10' radius

END BUT_ONLY

//////////////////////////////

// SLILMAT - Priest of Ilmater
// 
// present in both Waukeen Promenade and Slums, which results in a shared store (when you buy from
// one and the same item magically disappears from the other).

// 100% stock overwrite

COPY_EXISTING ar0811.are override PATCH_IF SOURCE_SIZE>0x11c BEGIN
  LPF DELETE_AREA_ITEM STR_VAR item_to_delete=staf10 END // remove Staff of Curing from the tomb in Graveyard
END BUT_ONLY

COPY_EXISTING ar0412.are override PATCH_IF SOURCE_SIZE>0x11c BEGIN
  LPF DELETE_AREA_ITEM STR_VAR item_to_delete=shld07 END // remove Shield of Falling Stars from Planar Sphere
END BUT_ONLY

COPY_EXISTING slilmat.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy END
  REMOVE_STORE_ITEM 
    POTN08    // Potion of Healing
    POTN29    // Potion of Genius
    POTN37    // Potion of Mind Focusing
    POTN43    // Potion of Insight 
    POTN52    // Potion of Extra Healing
    POTN17    // Elixir of Health
    POTN45    // Potion of Freedom
    POTN20    // Antidote
    SCRLPET   // Stone to Flesh Scroll
    SCRL09    // Protection from Undead
    SCRL03    // Protection from Acid
    SCRL63    // Raise Dead
    SCRL59    // Neutralize Poison
    RESTORE   // Restoration

  LPF store INT_VAR
    sell=135
    steal=0
  END

  LPF temple INT_VAR
    cure_light_wounds=20
    cure_medium_wounds=40
    cure_disease=240
    cure_serious_wounds=60
    neutralize_poison=240
    lesser_restoration=750
    cure_critical_wounds=80
    raise_dead=1000
    mass_cure= comp_atweaks_temples=1 ? 800 : 0
    heal=800
  END

  ADD_STORE_ITEM SCRL03   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Acid
  ADD_STORE_ITEM SCRL08   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Poison

  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM staf10   LAST #0 #0 #0 IDENTIFIED #1   // Staff of Curing
  END ELSE BEGIN
    ADD_STORE_ITEM staf10   LAST #0 #10 #0 IDENTIFIED #1  // Staff of Curing
  END
  ADD_STORE_ITEM shld07   LAST #0 #0 #0 IDENTIFIED #1   // Shield of Falling Stars

  ADD_STORE_ITEM restore  LAST #1 #0 #0 IDENTIFIED #1   // restoration
  ADD_STORE_ITEM SCRL63   LAST #1 #0 #0 IDENTIFIED #1   // raise dead
  ADD_STORE_ITEM SCRLPET  LAST #1 #0 #0 IDENTIFIED #1   // Stone to Flesh Scroll

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #32  // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #7   // Potion of Extra Healing
  ADD_STORE_ITEM POTN20   LAST #1 #0 #0 IDENTIFIED #5   // Antidote
  ADD_STORE_ITEM POTN17   LAST #1 #0 #0 IDENTIFIED #5   // Elixir of Health
  ADD_STORE_ITEM POTN42   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Regeneration 
  ADD_STORE_ITEM POTN28   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Fortitude
  ADD_STORE_ITEM POTN21   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Clarity

  ADD_STORE_ITEM MISC6W   LAST #0 #0 #0 IDENTIFIED #1 UNLIMITED  // Wooden Stake

  ADD_STORE_ITEM ~ag#ir01~  LAST #1 #0 #0 IDENTIFIED #4   // Bless
  ADD_STORE_ITEM scrl56     LAST #1 #0 #0 IDENTIFIED #4   // cure serious wounds
  ADD_STORE_ITEM ~ag#ir0d~  LAST #1 #0 #0 IDENTIFIED #4   // Holy Smite
  ADD_STORE_ITEM ~ag#ir0c~  LAST #1 #0 #0 IDENTIFIED #4   // Remove Paralysis
  ADD_STORE_ITEM scrl59     LAST #1 #0 #0 IDENTIFIED #4   // neutralize poison
  ADD_STORE_ITEM scrl61     LAST #1 #0 #0 IDENTIFIED #4   // cure critical wounds
  ADD_STORE_ITEM scrl58     LAST #1 #0 #0 IDENTIFIED #4   // free action
  ADD_STORE_ITEM scrl5d     LAST #1 #0 #0 IDENTIFIED #3   // protection from evil 10' radius
  ADD_STORE_ITEM ~ag#ir0g~  LAST #1 #0 #0 IDENTIFIED #3   // Mass Cure
  ADD_STORE_ITEM ~ag#ir0j~  LAST #1 #0 #0 IDENTIFIED #2   // Heal
  ADD_STORE_ITEM ~ag#ir0n~  LAST #1 #0 #0 IDENTIFIED #2   // Regeneration

END BUT_ONLY

////////////////////////////////

// WILMAT - Priestess of Ilmater
// 
// she apparently was supposed to be in Waukeen Promenade instead of the abovementioned clone dude.

// 100% stock overwrite

OUTER_SET wilmat=0
COPY_EXISTING - ar0703.are override PATCH_IF SOURCE_SIZE>0x11c BEGIN
  CLEAR_ARRAY actor GET_OFFSET_ARRAY actor 0x54 4 0x58 2 0 0 0x110
  PHP_EACH actor AS ind => res BEGIN
    READ_ASCII res+0x80 actor (8) NULL
    PATCH_IF ~%actor%~ STRING_EQUAL_CASE wilmat BEGIN
      wilmat=1
    END
  END
END
COPY_EXISTING ar0408.are override PATCH_IF SOURCE_SIZE>0x11c BEGIN
  CLEAR_ARRAY actor GET_OFFSET_ARRAY actor 0x54 4 0x58 2 0 0 0x110
  PHP_EACH actor AS ind => res BEGIN
    READ_ASCII res+0x80 actor (8) NULL
    PATCH_IF ~%actor%~ STRING_EQUAL_CASE slilmat && wilmat=0 BEGIN
      WRITE_ASCII res+0x80 wilmat (8)
      WRITE_LONG res+0x30 0x6010 // cleric female human
    END
  END
END BUT_ONLY

COPY_EXISTING wilmat.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy END
  REMOVE_STORE_ITEM 
    POTN08    // Potion of Healing
    POTN29    // Potion of Genius
    POTN37    // Potion of Mind Focusing
    POTN43    // Potion of Insight
    POTN17    // Elixir of Health
    POTN20    // Antidote
    SCRLPET   // Stone to Flesh Scroll
    SCRL63    // Raise Dead
    SCRL56    // Cure Serious Wounds
    SCRL59    // Neutralize Poison
    SCRL15    // Protection from Petrification
    SCRL06    // Protection from Fire
    SCRL05    // Protection from Electricity
    RESTORE   // Restoration
    SCRL63    // Raise Dead

  LPF store INT_VAR
    sell=135
    steal=0
  END

  LPF temple INT_VAR
    cure_light_wounds=20
    cure_medium_wounds=40
    cure_disease=240
    cure_serious_wounds=60
    neutralize_poison=240
    cure_critical_wounds=80
  END

  ADD_STORE_ITEM SCRL03   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Acid
  ADD_STORE_ITEM SCRL08   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Poison

  ADD_STORE_ITEM restore  LAST #1 #0 #0 IDENTIFIED #1   // restoration
  ADD_STORE_ITEM SCRL63   LAST #1 #0 #0 IDENTIFIED #1   // raise dead
  ADD_STORE_ITEM SCRLPET  LAST #1 #0 #0 IDENTIFIED #1   // Stone to Flesh Scroll

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #18  // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #4   // Potion of Extra Healing
  ADD_STORE_ITEM POTN20   LAST #1 #0 #0 IDENTIFIED #2   // Antidote
  ADD_STORE_ITEM POTN17   LAST #1 #0 #0 IDENTIFIED #1   // Elixir of Health
  ADD_STORE_ITEM POTN42   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Regeneration 
  ADD_STORE_ITEM POTN28   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Fortitude

  ADD_STORE_ITEM MISC6W   LAST #0 #0 #0 IDENTIFIED #5   // Wooden Stake

  ADD_STORE_ITEM ~ag#ir01~  LAST #1 #0 #0 IDENTIFIED #3   // Bless
  ADD_STORE_ITEM scrl56     LAST #1 #0 #0 IDENTIFIED #2   // cure serious wounds
  ADD_STORE_ITEM ~ag#ir0d~  LAST #1 #0 #0 IDENTIFIED #2   // Holy Smite
  ADD_STORE_ITEM ~ag#ir0c~  LAST #1 #0 #0 IDENTIFIED #2   // Remove Paralysis
  ADD_STORE_ITEM scrl59     LAST #1 #0 #0 IDENTIFIED #2   // neutralize poison
  ADD_STORE_ITEM scrl61     LAST #1 #0 #0 IDENTIFIED #2   // cure critical wounds
  ADD_STORE_ITEM scrl58     LAST #1 #0 #0 IDENTIFIED #2   // free action
  ADD_STORE_ITEM scrl5d     LAST #1 #0 #0 IDENTIFIED #2   // protection from evil 10' radius
  ADD_STORE_ITEM ~ag#ir0g~  LAST #1 #0 #0 IDENTIFIED #1   // Mass Cure
  ADD_STORE_ITEM ~ag#ir0j~  LAST #1 #0 #0 IDENTIFIED #1   // Heal

END BUT_ONLY

/////////////////////

// KPCHAP01 - Bolumir
// 
// De'Arnise Keep, part of fighter's stronghold

// 100% stock overwrite

// remove Horn of Valhalla from Bridge District
COPY_EXISTING ar0528.are override PATCH_IF SOURCE_SIZE>0x11c BEGIN
  LPF REPLACE_AREA_ITEM INT_VAR charges1=1 STR_VAR old_item=misc3i new_item=potn18 END
END BUT_ONLY

COPY_EXISTING kpchap01.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy END
  REMOVE_STORE_ITEM 
    POTN08    // Potion of Healing
    POTN29    // Potion of Genius
    POTN37    // Potion of Mind Focusing
    POTN43    // Potion of Insight 
    POTN17    // Elixir of Health
    POTN25    // Potion of Healing
    POTN20    // Antidote
    BOOT05    // Boots of Grounding
    STAF05    // Staff of Striking
    SCRLPET   // Stone to Flesh Scroll
    SCRL03    // Protection from Acid
    SCRL04    // Protection from Cold
    SCRL05    // Protection from Electricity
    SCRL06    // Protection from Fire
    SCRL08    // Protection from Poison
    SCRL09    // Protection from Undead
    SCRL15    // Protection from Petrification
    SCRL63    // Raise Dead
    HELM06    // Helm of Charm Protection
    RESTORE   // Restoration
    SCRL63    // Raise Dead

  LPF store INT_VAR
    sell=120
    steal=0
  END

  LPF temple INT_VAR
    cure_light_wounds=15
    dispel_magic=120
    cure_medium_wounds=30
    cure_disease=180
    cure_serious_wounds=45
    neutralize_poison=180
    lesser_restoration=450
    cure_critical_wounds=60
    raise_dead=600
    mass_cure= comp_atweaks_temples=1 ? 600 : 0
    heal=600
  END

  ADD_STORE_ITEM AX1H01   LAST #0 #0 #0 IDENTIFIED #2   // Battle Axe
  ADD_STORE_ITEM AX1H02   LAST #0 #0 #0 IDENTIFIED #1   // Battle Axe +1
  ADD_STORE_ITEM AX1H11   LAST #0 #0 #0 IDENTIFIED #1   // Battle Axe +2
  ADD_STORE_ITEM AX1H04   LAST #20 #0 #0 IDENTIFIED #10 // Throwing Axe
  ADD_STORE_ITEM AX1H05   LAST #0 #0 #0 IDENTIFIED #1   // Throwing Axe +2

  ADD_STORE_ITEM LEAT10   LAST #0 #0 #0 IDENTIFIED #2   // Hide Armor

  ADD_STORE_ITEM CHAN01   LAST #0 #0 #0 IDENTIFIED #2   // Chain Mail Armor
  ADD_STORE_ITEM CHAN04   LAST #0 #0 #0 IDENTIFIED #1   // Splint Mail
  ADD_STORE_ITEM CHAN08   LAST #0 #0 #0 IDENTIFIED #1   // Chain Mail +2
  ADD_STORE_ITEM CHAN05   LAST #0 #0 #0 IDENTIFIED #1   // Splint Mail +1

  ADD_STORE_ITEM LEAT01   LAST #0 #0 #0 IDENTIFIED #2   // Leather Armor
  ADD_STORE_ITEM LEAT04   LAST #0 #0 #0 IDENTIFIED #1   // Studded Leather Armor
  ADD_STORE_ITEM LEAT11   LAST #0 #0 #0 IDENTIFIED #1   // Leather Armor +2
  ADD_STORE_ITEM LEAT07   LAST #0 #0 #0 IDENTIFIED #1   // Studded Leather Armor +2

  ADD_STORE_ITEM BELT06   LAST #0 #0 #0 IDENTIFIED #1   // Girdle of Hill Giant Strength
  ADD_STORE_ITEM MISC3I   LAST #1 #0 #0 IDENTIFIED #1   // Silver Horn of Valhalla

  ADD_STORE_ITEM SCRL03   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Acid
  ADD_STORE_ITEM SCRL05   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Electricity
  ADD_STORE_ITEM SCRL09   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Undead

  ADD_STORE_ITEM restore  LAST #1 #0 #0 IDENTIFIED #1   // restoration
  ADD_STORE_ITEM SCRL63   LAST #1 #0 #0 IDENTIFIED #1   // raise dead
  ADD_STORE_ITEM SCRLPET  LAST #1 #0 #0 IDENTIFIED #1   // Stone to Flesh Scroll

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #17  // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #8   // Potion of Extra Healing
  PATCH_IF comp_ir_potions BEGIN
    ADD_STORE_ITEM POTN37   LAST #1 #0 #0 IDENTIFIED #4   // Potion of Mind Focusing/Restoration
  END
  ADD_STORE_ITEM POTN44   LAST #1 #0 #0 IDENTIFIED #9   // Potion of Strength/Rage
  ADD_STORE_ITEM POTN04   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Frost Giant Strength
  ADD_STORE_ITEM POTN07   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Storm Giant Strength
  ADD_STORE_ITEM POTN09   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Heroism
  ADD_STORE_ITEM POTN11   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Invulnerability
  ADD_STORE_ITEM POTN41   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Power

  ADD_STORE_ITEM ~ag#ir03~  LAST #1 #0 #0 IDENTIFIED #5   // Armor of Faith
  ADD_STORE_ITEM ~ag#ir01~  LAST #1 #0 #0 IDENTIFIED #5   // Bless
  ADD_STORE_ITEM ~ag#ir04~  LAST #1 #0 #0 IDENTIFIED #5   // Chant
  ADD_STORE_ITEM ~ag#ir08~  LAST #1 #0 #0 IDENTIFIED #5   // Draw Upon Holy Might
  ADD_STORE_ITEM scrl61     LAST #1 #0 #0 IDENTIFIED #3   // cure critical wounds
  ADD_STORE_ITEM scrl58     LAST #1 #0 #0 IDENTIFIED #3   // free action
  ADD_STORE_ITEM scrl5e     LAST #1 #0 #0 IDENTIFIED #2   // champion's strength
  ADD_STORE_ITEM scrl5f     LAST #1 #0 #0 IDENTIFIED #2   // chaotic commands
  ADD_STORE_ITEM scrl62     LAST #1 #0 #0 IDENTIFIED #2   // flame strike
  ADD_STORE_ITEM ~ag#ir0f~  LAST #1 #0 #0 IDENTIFIED #2   // Magic Resistance
  ADD_STORE_ITEM ~ag#ir0k~  LAST #1 #0 #0 IDENTIFIED #1   // Bolt of Glory
  ADD_STORE_ITEM ~ag#ir0l~  LAST #1 #0 #0 IDENTIFIED #1   // Fire Storm

END BUT_ONLY

////////////////////////

// TEMHELM - Sir Donalus
// 
// Temple District, Helm

// 100% stock overwrite

// change Lawgiver reward from Copper Coronet quest to Bastard Sword +1
ACTION_IF comp_ir=1 BEGIN
  COPY_EXISTING lehtin.dlg override
                hendak.dlg override
    DECOMPILE_DLG_TO_D
      REPLACE_TEXTUALLY CASE_INSENSITIVE ~GiveItemCreate("SW1H03"~ ~GiveItemCreate("SW1H02"~ // Lawgiver -> Bastard +1
    COMPILE_D_TO_DLG
END

// remove Helm of Infravision/Watcher's Helm from starting dungeon
COPY_EXISTING ar0602.are override PATCH_IF SOURCE_SIZE>0x11c BEGIN
  LPF DELETE_AREA_ITEM STR_VAR item_to_delete=helm05 END
END BUT_ONLY

COPY_EXISTING temhelm.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy END
  REMOVE_STORE_ITEM 
    PLAT01    // Plate Mail Armor
    PLAT04    // Full Plate Mail
    PLAT10    // Plate Mail +1
    SHLD30    // Large Shield +2
    HAMM01    // War Hammer
    HAMM02    // War Hammer +1
    HAMM08    // War Hammer +2
    POTN08    // Potion of Healing
    POTN29    // Potion of Genius
    POTN37    // Potion of Mind Focusing
    POTN09    // Potion of Heroism
    POTN41    // Potion of Power
    POTN43    // Potion of Insight 
    POTN17    // Elixir of Health
    POTN25    // Potion of Healing
    POTN20    // Antidote
    SCRLPET   // Stone to Flesh Scroll
    SCRL03    // Protection from Acid
    SCRL04    // Protection from Cold
    SCRL05    // Protection from Electricity
    SCRL06    // Protection from Fire
    SCRL08    // Protection from Poison
    SCRL09    // Protection from Undead
    SCRL15    // Protection from Petrification
    RESTORE   // Restoration

  LPF store INT_VAR
    sell=145
    steal=0
  END

  LPF temple INT_VAR
    cure_light_wounds=25
    dispel_magic=200
    remove_curse=500
    cure_medium_wounds=50
    cure_disease=300
    cure_serious_wounds=75
    neutralize_poison=300
    lesser_restoration=750
    cure_critical_wounds=100
    raise_dead=1000
    mass_cure= comp_atweaks_temples=1 ? 1000 : 0
    heal=1000
    resurrection=2000
    greater_restoration=2000
  END

  ADD_STORE_ITEM SW1H01   LAST #0 #0 #0 IDENTIFIED #2   // Bastard Sword 
  ADD_STORE_ITEM SW1H02   LAST #0 #0 #0 IDENTIFIED #1   // Bastard Sword +1
  ADD_STORE_ITEM SW1H42   LAST #0 #0 #0 IDENTIFIED #1   // Bastard Sword +2
  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM sw1h03 LAST #0 #0 #0 IDENTIFIED #1   // Lawgiver +2
  END
  ADD_STORE_ITEM SHLD03   LAST #0 #0 #0 IDENTIFIED #2   // Medium Shield
  ADD_STORE_ITEM SHLD04   LAST #0 #0 #0 IDENTIFIED #1   // Medium Shield +1
  ADD_STORE_ITEM SHLD05   LAST #0 #0 #0 IDENTIFIED #2   // Large Shield
  ADD_STORE_ITEM SHLD06   LAST #0 #0 #0 IDENTIFIED #1   // Large Shield +1

  ADD_STORE_ITEM helm10   LAST #0 #0 #0 IDENTIFIED #1   // helmet
  ADD_STORE_ITEM helm11   LAST #0 #0 #0 IDENTIFIED #1   // helmet
  ADD_STORE_ITEM helm05   LAST #0 #0 #0 IDENTIFIED #1   // Helm of Infravision/Watcher's Helm

  ADD_STORE_ITEM RING22   LAST #0 #0 #0 IDENTIFIED #1   // Ring of Holiness

  ADD_STORE_ITEM restore  LAST #1 #0 #0 IDENTIFIED #3   // restoration
  ADD_STORE_ITEM SCRL63   LAST #1 #0 #0 IDENTIFIED #3   // raise dead
  ADD_STORE_ITEM SCRLPET  LAST #1 #0 #0 IDENTIFIED #3   // Stone to Flesh Scroll

  ADD_STORE_ITEM SCRL03   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Acid
  ADD_STORE_ITEM SCRL04   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Cold
  ADD_STORE_ITEM SCRL05   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Electricity
  ADD_STORE_ITEM SCRL06   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Fire
  ADD_STORE_ITEM SCRL15   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Petrification

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #10  // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Extra Healing
  ADD_STORE_ITEM POTN24   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Defense
  ADD_STORE_ITEM POTN21   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Clarity
  PATCH_IF comp_ir_potions BEGIN
    ADD_STORE_ITEM POTN30   LAST #1 #0 #0 IDENTIFIED #4   // Potion of Infravision/Sight
  END ELSE BEGIN
    ADD_STORE_ITEM POTN44   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Strength
  END

  ADD_STORE_ITEM ~ag#ir03~  LAST #1 #0 #0 IDENTIFIED #5   // Armor of Faith
  ADD_STORE_ITEM ~ag#ir01~  LAST #1 #0 #0 IDENTIFIED #5   // Bless
  ADD_STORE_ITEM ~ag#ir02~  LAST #1 #0 #0 IDENTIFIED #5   // Sanctuary
  ADD_STORE_ITEM ~ag#ir04~  LAST #1 #0 #0 IDENTIFIED #5   // Chant
  ADD_STORE_ITEM ~ag#ir08~  LAST #1 #0 #0 IDENTIFIED #5   // Draw Upon Holy Might
  ADD_STORE_ITEM ~ag#ir05~  LAST #1 #0 #0 IDENTIFIED #5   // Find Traps
  ADD_STORE_ITEM ~ag#ir06~  LAST #1 #0 #0 IDENTIFIED #5   // Silence
  ADD_STORE_ITEM ~ag#ir0b~  LAST #1 #0 #0 IDENTIFIED #3   // Remove Curse/Break Enchantment
  ADD_STORE_ITEM scrl56     LAST #1 #0 #0 IDENTIFIED #3   // cure serious wounds
  ADD_STORE_ITEM ~ag#ir09~  LAST #1 #0 #0 IDENTIFIED #3   // Dispel Magic
  ADD_STORE_ITEM ~ag#ir0a~  LAST #1 #0 #0 IDENTIFIED #3   // Glyph of Warding
  ADD_STORE_ITEM ~ag#ir0c~  LAST #1 #0 #0 IDENTIFIED #3   // Remove Paralysis
  ADD_STORE_ITEM scrl61     LAST #1 #0 #0 IDENTIFIED #3   // cure critical wounds
  ADD_STORE_ITEM scrl5b     LAST #1 #0 #0 IDENTIFIED #3   // defensive harmony
  ADD_STORE_ITEM scrl5d     LAST #1 #0 #0 IDENTIFIED #3   // protection from evil 10' radius
  ADD_STORE_ITEM scrl5e     LAST #1 #0 #0 IDENTIFIED #2   // champion's strength
  ADD_STORE_ITEM ~ag#ir0f~  LAST #1 #0 #0 IDENTIFIED #2   // Magic Resistance
  ADD_STORE_ITEM scrl5c     LAST #1 #0 #0 IDENTIFIED #2   // protection from lightning
  ADD_STORE_ITEM ~ag#ir07~  LAST #1 #0 #0 IDENTIFIED #2   // True Sight
  ADD_STORE_ITEM ~ag#ir0h~  LAST #1 #0 #0 IDENTIFIED #2   // Aerial Servant
  ADD_STORE_ITEM ~ag#ir0i~  LAST #1 #0 #0 IDENTIFIED #2   // Blade Barrier
  ADD_STORE_ITEM ~ag#ir0k~  LAST #1 #0 #0 IDENTIFIED #2   // Bolt of Glory
  ADD_STORE_ITEM ~ag#ir0j~  LAST #1 #0 #0 IDENTIFIED #2   // Heal

END BUT_ONLY

/////////////////////////////

// TEMLATH - Dawnmaster Kreel
// 
// Temple District, Lathander

// 100% stock overwrite

COPY_EXISTING blpool.bcs override // put Vampire's Revenge into pool of blood instead of Mace of Disruption
  DECOMPILE_BCS_TO_BAF
    REPLACE_TEXTUALLY CASE_INSENSITIVE ~GiveItemCreate("blun12"~ ~GiveItemCreate("sw1h19"~
  COMPILE_BAF_TO_BCS

COPY_EXISTING temlath.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy END
  REMOVE_STORE_ITEM 
    POTN08    // Potion of Healing
    POTN29    // Potion of Genius
    POTN37    // Potion of Mind Focusing
    POTN43    // Potion of Insight 
    POTN17    // Elixir of Health
    POTN20    // Antidote
    BOOT05    // Boots of Grounding
    STAF05    // Staff of Striking
    SCRLPET   // Stone to Flesh Scroll
    SCRL03    // Protection from Acid
    SCRL04    // Protection from Cold
    SCRL05    // Protection from Electricity
    SCRL06    // Protection from Fire
    SCRL08    // Protection from Poison
    SCRL09    // Protection from Undead
    SCRL15    // Protection from Petrification
    SCRL63    // Raise Dead
    HELM06    // Helm of Charm Protection
    RESTORE   // Restoration
    MISC6W    // Wooden Stake

  LPF store INT_VAR
    sell=145
    steal=0
  END

  LPF temple INT_VAR
    cure_light_wounds=25
    dispel_magic=200
    remove_curse=500
    cure_medium_wounds=50
    cure_disease=300
    cure_serious_wounds=75
    neutralize_poison=300
    lesser_restoration=600
    cure_critical_wounds=100
    raise_dead=900
    mass_cure= comp_atweaks_temples=1 ? 1000 : 0
    heal=1000
    resurrection=1800
    greater_restoration=1600
  END

  ADD_STORE_ITEM RODS03   LAST #10 #0 #0 IDENTIFIED #1  // Rod of Resurrection

  ADD_STORE_ITEM BLUN04   LAST #0 #0 #0 IDENTIFIED #3   // Mace
  ADD_STORE_ITEM BLUN05   LAST #0 #0 #0 IDENTIFIED #1   // Mace +1
  ADD_STORE_ITEM BLUN21   LAST #0 #0 #0 IDENTIFIED #1   // Mace +2
  ADD_STORE_ITEM STAF06   LAST #0 #0 #0 IDENTIFIED #1   // Staff Mace
  ADD_STORE_ITEM blun12   LAST #0 #0 #0 IDENTIFIED #1   // Mace of Disruption
  ADD_STORE_ITEM AMUL23   LAST #0 #0 #0 IDENTIFIED #1   // Periart of Life Protection
  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM PLAT08   LAST #0 #0 #0 IDENTIFIED #1   // Radiant Plate
  END

  ADD_STORE_ITEM restore  LAST #1 #0 #0 IDENTIFIED #3   // restoration
  ADD_STORE_ITEM SCRL63   LAST #1 #0 #0 IDENTIFIED #3   // raise dead
  ADD_STORE_ITEM SCRLPET  LAST #1 #0 #0 IDENTIFIED #3   // Stone to Flesh Scroll

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #12  // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Extra Healing
  ADD_STORE_ITEM POTN17   LAST #1 #0 #0 IDENTIFIED #2   // Elixir of Health
  PATCH_IF comp_ir_potions BEGIN
    ADD_STORE_ITEM POTN37   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Mind Focusing/Restoration
  END ELSE BEGIN
    ADD_STORE_ITEM POTN44   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Strength
  END

  ADD_STORE_ITEM SCRLPET  LAST #1 #0 #0 IDENTIFIED #3   // Stone to Flesh Scroll
  ADD_STORE_ITEM SCRL09   LAST #1 #0 #0 IDENTIFIED #3   // Protection from Undead

  ADD_STORE_ITEM MISC6W   LAST #0 #0 #0 IDENTIFIED #1 UNLIMITED   // Wooden Stake

  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM BOLT05   LAST #10 #0 #0 IDENTIFIED #1  // Blessed Bolt
  END

  ADD_STORE_ITEM ~ag#ir03~  LAST #1 #0 #0 IDENTIFIED #5   // Armor of Faith
  ADD_STORE_ITEM ~ag#ir01~  LAST #1 #0 #0 IDENTIFIED #5   // Bless
  ADD_STORE_ITEM ~ag#ir02~  LAST #1 #0 #0 IDENTIFIED #5   // Sanctuary
  ADD_STORE_ITEM ~ag#ir05~  LAST #1 #0 #0 IDENTIFIED #5   // Find Traps
  ADD_STORE_ITEM ~ag#ir0b~  LAST #1 #0 #0 IDENTIFIED #3   // Remove Curse/Break Enchantment
  ADD_STORE_ITEM scrl56     LAST #1 #0 #0 IDENTIFIED #3   // cure serious wounds
  ADD_STORE_ITEM ~ag#ir09~  LAST #1 #0 #0 IDENTIFIED #3   // Dispel Magic
  ADD_STORE_ITEM ~ag#ir0d~  LAST #1 #0 #0 IDENTIFIED #3   // Holy Smite
  ADD_STORE_ITEM ~ag#ir0c~  LAST #1 #0 #0 IDENTIFIED #3   // Remove Paralysis
  ADD_STORE_ITEM scrl59     LAST #1 #0 #0 IDENTIFIED #3   // neutralize poison
  ADD_STORE_ITEM scrl61     LAST #1 #0 #0 IDENTIFIED #3   // cure critical wounds
  ADD_STORE_ITEM scrl5d     LAST #1 #0 #0 IDENTIFIED #3   // protection from evil 10' radius
  ADD_STORE_ITEM ~ag#ir0g~  LAST #1 #0 #0 IDENTIFIED #2   // Mass Cure
  ADD_STORE_ITEM ~ag#ir0h~  LAST #1 #0 #0 IDENTIFIED #2   // Aerial Servant
  ADD_STORE_ITEM ~ag#ir0k~  LAST #1 #0 #0 IDENTIFIED #2   // Bolt of Glory
  ADD_STORE_ITEM ~ag#ir0m~  LAST #1 #0 #0 IDENTIFIED #2   // Sunray

END BUT_ONLY

//////////////////////////

// TEMTALOS - Mistress Ada
// 
// Temple District, Talos

// 100% stock overwrite

COPY_EXISTING ar0904.are override PATCH_IF SOURCE_SIZE>0x11c BEGIN
  LPF DELETE_AREA_ITEM STR_VAR item_to_delete=potn07 END // way too powerful to be obtained for free
  LPF DELETE_AREA_ITEM STR_VAR item_to_delete=wand11 END // ditto
END BUT_ONLY

COPY_EXISTING grtomb01.cre override LPF FJ_CRE_VALIDITY RET valid=valid END PATCH_IF valid BEGIN // rob a skeleton of his Halcyon
  CLEAR_ARRAY item GET_OFFSET_ARRAY item 0x2bc 4 0x2c0 4 0 0 0x14
  PHP_EACH item AS ind => res BEGIN
    READ_ASCII res item (8) NULL
    PATCH_IF ~%item%~ STRING_EQUAL_CASE sper09 BEGIN
      WRITE_ASCII res sper05 (8)
    END
  END
END BUT_ONLY

COPY_EXISTING temtalos.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy END
  REMOVE_STORE_ITEM 
    POTN08    // Potion of Healing
    POTN29    // Potion of Genius
    POTN37    // Potion of Mind Focusing
    POTN43    // Potion of Insight 
    POTN17    // Elixir of Health
    POTN25    // Potion of Healing
    POTN20    // Antidote
    POTN22    // Potion of Cold Resistance
    POTN02    // Potion of Fire Resistance
    SCRLPET   // Stone to Flesh Scroll
    WAND11    // Wand of the Heavens
    STAF19    // Cleric's Staff +3
    STAF06    // Staff Mace
    BELT03    // Girdle of Bluntness
    SCRL03    // Protection from Acid
    SCRL04    // Protection from Cold
    SCRL05    // Protection from Electricity
    SCRL06    // Protection from Fire
    SCRL08    // Protection from Poison
    SCRL09    // Protection from Undead
    SCRL15    // Protection from Petrification
    RESTORE   // Restoration
    SCRL63    // Raise Dead

  LPF store INT_VAR
    sell=155
    steal=0
  END

  LPF temple INT_VAR
    call_lightning=5        // wrath of Talos is never in a short supply! :lol:
    cure_light_wounds=30
    dispel_magic=200
    remove_curse=500
    cure_medium_wounds=60
    cure_disease=360
    cure_serious_wounds=90
    neutralize_poison=360
    lesser_restoration=900
    cure_critical_wounds=120
    raise_dead=1200
    mass_cure= comp_atweaks_temples=1 ? 1200 : 0
    heal=1200
    resurrection=2400
    greater_restoration=2400
  END

  ADD_STORE_ITEM sper09   LAST #0 #0 #0 IDENTIFIED #1   // Spear +1, Halcyon
  ADD_STORE_ITEM BOOT05   LAST #0 #0 #0 IDENTIFIED #1   // Boots of Grounding
  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM wand11   LAST #10 #0 #0 IDENTIFIED #1  // heaven
  END ELSE BEGIN
    ADD_STORE_ITEM wand11   LAST #50 #0 #0 IDENTIFIED #1  // heaven
  END
  ADD_STORE_ITEM SCRL06   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Fire

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #10  // Potion of Healing
  ADD_STORE_ITEM POTN27   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Firebreath
  ADD_STORE_ITEM POTN07   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Storm Giant Strength
  ADD_STORE_ITEM POTN31   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Insulation
  ADD_STORE_ITEM POTN14   LAST #1 #0 #0 IDENTIFIED #1   // Oil of Speed

  ADD_STORE_ITEM restore  LAST #1 #0 #0 IDENTIFIED #3   // restoration
  ADD_STORE_ITEM SCRL63   LAST #1 #0 #0 IDENTIFIED #3   // raise dead
  ADD_STORE_ITEM SCRLPET  LAST #1 #0 #0 IDENTIFIED #3   // Stone to Flesh Scroll

  ADD_STORE_ITEM ~ag#ir04~  LAST #1 #0 #0 IDENTIFIED #3   // Chant
  ADD_STORE_ITEM ~ag#ir08~  LAST #1 #0 #0 IDENTIFIED #3   // Draw Upon Holy Might
  ADD_STORE_ITEM scrl56     LAST #1 #0 #0 IDENTIFIED #3   // cure serious wounds
  ADD_STORE_ITEM ~ag#ir0e~  LAST #1 #0 #0 IDENTIFIED #3   // Unholy Blight
  ADD_STORE_ITEM scrl5c     LAST #1 #0 #0 IDENTIFIED #2   // protection from lightning
  ADD_STORE_ITEM scrl5f     LAST #1 #0 #0 IDENTIFIED #2   // chaotic commands
  ADD_STORE_ITEM scrl62     LAST #1 #0 #0 IDENTIFIED #2   // flame strike
  ADD_STORE_ITEM ~ag#ir0l~  LAST #1 #0 #0 IDENTIFIED #2   // Fire Storm

END BUT_ONLY

//////////////////////////////

// TEMSUP - Overgold Renwellyn
// 
// Trademeet

// 100% stock overwrite

COPY_EXISTING temsup.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy END
  REMOVE_STORE_ITEM 
    POTN08    // Potion of Healing
    POTN29    // Potion of Genius
    POTN37    // Potion of Mind Focusing
    POTN43    // Potion of Insight 
    POTN17    // Elixir of Health
    POTN25    // Potion of Healing
    POTN20    // Antidote
    SCRLPET   // Stone to Flesh Scroll
    SCRL63    // Raise Dead
    SCRL08    // Protection from Poison
    SCRL04    // Protection from Cold
    RING03    // Ring of Animal Friendship
    RESTORE   // Restoration

  LPF store INT_VAR
    sell=145
    steal=0
  END

  LPF temple INT_VAR
    cure_light_wounds=25
    dispel_magic=200
    remove_curse=500
    cure_medium_wounds=50
    cure_disease=300
    cure_serious_wounds=75
    neutralize_poison=300
    lesser_restoration=750
    cure_critical_wounds=100
    raise_dead=1000
    mass_cure= comp_atweaks_temples=1 ? 1000 : 0
  END

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #10  // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Extra Healing

  ADD_STORE_ITEM SCRL04   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Cold
  ADD_STORE_ITEM STAF19   LAST #0 #0 #0 IDENTIFIED #1   // Cleric's Staff +3

  ADD_STORE_ITEM restore  LAST #1 #0 #0 IDENTIFIED #1   // restoration
  ADD_STORE_ITEM SCRL63   LAST #1 #0 #0 IDENTIFIED #1   // raise dead
  ADD_STORE_ITEM SCRLPET  LAST #1 #0 #0 IDENTIFIED #1   // Stone to Flesh Scroll

  ADD_STORE_ITEM amul10   LAST #0 #0 #0 IDENTIFIED #2   // gold
  ADD_STORE_ITEM ring10   LAST #0 #0 #0 IDENTIFIED #3   // gold

  ADD_STORE_ITEM ~ag#ir03~  LAST #1 #0 #0 IDENTIFIED #3   // Armor of Faith
  ADD_STORE_ITEM ~ag#ir01~  LAST #1 #0 #0 IDENTIFIED #3   // Bless
  ADD_STORE_ITEM ~ag#ir02~  LAST #1 #0 #0 IDENTIFIED #3   // Sanctuary
  ADD_STORE_ITEM ~ag#ir05~  LAST #1 #0 #0 IDENTIFIED #2   // Find Traps
  ADD_STORE_ITEM ~ag#ir0b~  LAST #1 #0 #0 IDENTIFIED #2   // Remove Curse/Break Enchantment
  ADD_STORE_ITEM scrl56     LAST #1 #0 #0 IDENTIFIED #2   // cure serious wounds
  ADD_STORE_ITEM ~ag#ir0c~  LAST #1 #0 #0 IDENTIFIED #2   // Remove Paralysis
  ADD_STORE_ITEM scrl61     LAST #1 #0 #0 IDENTIFIED #2   // cure critical wounds
  ADD_STORE_ITEM scrl58     LAST #1 #0 #0 IDENTIFIED #2   // free action
  ADD_STORE_ITEM scrl5d     LAST #1 #0 #0 IDENTIFIED #2   // protection from evil 10' radius
  ADD_STORE_ITEM ~ag#ir0f~  LAST #1 #0 #0 IDENTIFIED #1   // Magic Resistance

END BUT_ONLY

//////////////////////////////////

// PPUMB01 - Priestess of Umberlee
// 
// Brynnlaw

// 100% stock overwrite

COPY_EXISTING ppumb01.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy END
  REMOVE_STORE_ITEM 
    POTN08    // Potion of Healing
    POTN29    // Potion of Genius
    POTN37    // Potion of Mind Focusing
    POTN43    // Potion of Insight 
    POTN17    // Elixir of Health
    POTN25    // Potion of Healing
    POTN20    // Antidote
    POTN22    // Potion of Cold Resistance
    POTN02    // Potion of Fire Resistance
    SCRLPET   // Stone to Flesh Scroll
    WAND11    // Wand of the Heavens
    STAF06    // Staff Mace
    STAF19    // Cleric's Staff +3
    BELT03    // Girdle of Bluntness
    SCRL03    // Protection from Acid
    SCRL04    // Protection from Cold
    SCRL05    // Protection from Electricity
    SCRL06    // Protection from Fire
    SCRL08    // Protection from Poison
    SCRL09    // Protection from Undead
    SCRL15    // Protection from Petrification
    RESTORE   // Restoration

  LPF store INT_VAR
    sell=165
    steal=0
  END

  LPF temple INT_VAR
    call_lightning=5      // and yes, it CAN be used for healing - just get 127% electrical res
    cure_light_wounds=50
    dispel_magic=400
    remove_curse=1000
    cure_medium_wounds=100
    cure_disease=600
    cure_serious_wounds=150
    neutralize_poison=600
    lesser_restoration=1500
    cure_critical_wounds=200
    raise_dead=2000
    mass_cure= comp_atweaks_temples=1 ? 2000 : 0
  END

  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM wand07   LAST #10 #0 #0 IDENTIFIED #1  // lightning
  END ELSE BEGIN
    ADD_STORE_ITEM wand07   LAST #50 #0 #0 IDENTIFIED #1  // lightning
  END
  ADD_STORE_ITEM CLCK11   LAST #0 #0 #0 IDENTIFIED #1   // Mage Robe of Electric Resistance

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #14  // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Extra Healing
  ADD_STORE_ITEM POTN19   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Agility
  ADD_STORE_ITEM POTN10   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Invisibility
  ADD_STORE_ITEM POTN06   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Cloud Giant Strength

  ADD_STORE_ITEM restore  LAST #1 #0 #0 IDENTIFIED #3   // restoration
  ADD_STORE_ITEM SCRL63   LAST #1 #0 #0 IDENTIFIED #3   // raise dead
  ADD_STORE_ITEM SCRLPET  LAST #1 #0 #0 IDENTIFIED #3   // Stone to Flesh Scroll

  ADD_STORE_ITEM amul12   LAST #0 #0 #0 IDENTIFIED #1   // laeral's tear
  ADD_STORE_ITEM misc35   LAST #0 #0 #0 IDENTIFIED #3   // horn coral
  ADD_STORE_ITEM misc33   LAST #0 #0 #0 IDENTIFIED #1   // aquamarine
  ADD_STORE_ITEM misc36   LAST #0 #0 #0 IDENTIFIED #3   // pearl

  ADD_STORE_ITEM ~ag#ir01~  LAST #1 #0 #0 IDENTIFIED #3   // Bless
  ADD_STORE_ITEM ~ag#ir06~  LAST #1 #0 #0 IDENTIFIED #3   // Silence
  ADD_STORE_ITEM ~ag#ir0b~  LAST #1 #0 #0 IDENTIFIED #2   // Remove Curse/Break Enchantment
  ADD_STORE_ITEM scrl56     LAST #1 #0 #0 IDENTIFIED #2   // cure serious wounds
  ADD_STORE_ITEM ~ag#ir09~  LAST #1 #0 #0 IDENTIFIED #2   // Dispel Magic
  ADD_STORE_ITEM ~ag#ir0a~  LAST #1 #0 #0 IDENTIFIED #2   // Glyph of Warding
  ADD_STORE_ITEM ~ag#ir0c~  LAST #1 #0 #0 IDENTIFIED #2   // Remove Paralysis
  ADD_STORE_ITEM ~ag#ir0e~  LAST #1 #0 #0 IDENTIFIED #2   // Unholy Blight
  ADD_STORE_ITEM scrl58     LAST #1 #0 #0 IDENTIFIED #2   // free action
  ADD_STORE_ITEM scrl5f     LAST #1 #0 #0 IDENTIFIED #1   // chaotic commands
  ADD_STORE_ITEM scrl5c     LAST #1 #0 #0 IDENTIFIED #1   // protection from lightning
  ADD_STORE_ITEM ~ag#ir0h~  LAST #1 #0 #0 IDENTIFIED #1   // Aerial Servant

END BUT_ONLY

////////////////
// innkeepers //
////////////////

// most of them can't trade

//////////////////////
/*
// SEVBAR01 - Patricia
// 
// male-hating fat woman in Promenade

COPY_EXISTING sevbar01.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END

END BUT_ONLY
*/
////////////////////
/*
// WINNKEEP - Pugney
// 
// Mithrest Inn, Promenade

COPY_EXISTING winnkeep.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END

END BUT_ONLY
*/
////////////////////
/*
// THUMB - The Thumb
// 
// Docks

COPY_EXISTING thumb.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END

END BUT_ONLY
*/
////////////////

// GORCH - Gorch
// 
// Mae'var guild

// 100% stock overwrite

COPY_EXISTING gorch.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    BLUN01    // Club
    BLUN04    // Mace
    BLUN06    // Morning Star
    BLUN21    // Mace +2
    BOW05     // Short Bow
    BOW18     // Short Bow +2
    DAGG01    // Dagger
    DAGG05    // Throwing Dagger
    DART01    // Dart
    DART02    // Dart +1
    SLNG01    // Sling 
    SLNG04    // Sling +2
    SPER01    // Spear
    STAF01    // Quarterstaff
    SW1H01    // Bastard Sword 
    SW1H04    // Long Sword 
    SW1H07    // Short Sword 
    SW1H20    // Scimitar
    SW1H43    // Katana
    SW1H46    // Wakizashi
    SW1H48    // Ninja-To
    SW1H47    // Wakizashi +1
    XBOW04    // Light Crossbow
    AROW01    // Arrows
    BOLT01    // Bolt
    BOLT02    // Bolt +1
    BULL01    // Bullet
    BULL03    // Bullet +2
    CHAN01    // Chain Mail Armor
    CHAN04    // Splint Mail
    LEAT01    // Leather Armor
    LEAT04    // Studded Leather Armor
    LEAT12    // Leather Armor +3
    LEAT05    // Studded Leather Armor +1
    SHLD01    // Small Shield
    SHLD03    // Medium Shield
    SHLD08    // Buckler
    RING06    // Ring of Protection +1
    CLCK07    // Nymph Cloak
    BRAC03    // Bracers of Defense AC 6
    POTN45    // Potion of Freedom
    POTN31    // Potion of Insulation
    POTN26    // Potion of Explosions
    POTN10    // Potion of Invisibility
    POTN02    // Potion of Fire Resistance
    POTN14    // Oil of Speed
    POTN36    // Potion of Master Thievery
    SCRL63    // Raise Dead
    SCRL91    // Knock
    MISC45    // Rogue Stone
    RESTORE   // Restoration
    BAG02B    // Gem bag
 // these are RR's additions
    BLUN01    // Club
    ~RR#SAP01~  // Sap
    ~RR#BOW02~  // Composite Short Bow
    ~RR#BOW04~  // Composite Short Bow +2

  LPF store INT_VAR
    sell=145
    buy=10
    steal=0
    fence=1
  END

  ADD_STORE_ITEM DAGG16   LAST #10 #0 #0 IDENTIFIED #1  // Poisoned Throwing Dagger
  ADD_STORE_ITEM SCRL69   LAST #1 #0 #0 IDENTIFIED #1   // Charm Person
  ADD_STORE_ITEM SCRL83   LAST #1 #0 #0 IDENTIFIED #1   // Chromatic Orb
  ADD_STORE_ITEM SCRL72   LAST #1 #0 #0 IDENTIFIED #1   // Friends
  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Healing
  ADD_STORE_ITEM POTN19   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Agility
  ADD_STORE_ITEM POTN36   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Master Thievery
  ADD_STORE_ITEM POTN10   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Invisibility
  ADD_STORE_ITEM amul13   LAST #0 #0 #0 IDENTIFIED #1   // bloodstone
  ADD_STORE_ITEM amul06   LAST #0 #0 #0 IDENTIFIED #1   // anti-magnie
  ADD_STORE_ITEM amul07   LAST #0 #0 #0 IDENTIFIED #1   // rainbow obsidian
  ADD_STORE_ITEM ring16   LAST #0 #0 #0 IDENTIFIED #1   // angel skin
  ADD_STORE_ITEM ring17   LAST #0 #0 #0 IDENTIFIED #1   // flamedance
  ADD_STORE_ITEM ring11   LAST #0 #0 #0 IDENTIFIED #1   // silver
  ADD_STORE_ITEM ring12   LAST #0 #0 #0 IDENTIFIED #1   // onyx
  ADD_STORE_ITEM AROW08   LAST #20 #0 #0 IDENTIFIED #1  // Arrow of Fire
  ADD_STORE_ITEM AROW11   LAST #10 #0 #0 IDENTIFIED #1  // Bolt of Biting 

  PATCH_IF comp_rr_equip=1 BEGIN
    ADD_STORE_ITEM ~RR#SAP01~ LAST #0 #0 #0 IDENTIFIED #1  // sap
  END

END BUT_ONLY

////////////////////

// BINNKEEP - Calbor
// 
// Delosar's Inn, Bridge District

// 100% stock overwrite

COPY_EXISTING binnkeep.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    AROW01    // Arrows
    BULL01    // Bullet
    DART01    // Dart
    BOLT01    // Bolt
    AX1H01    // Battle Axe
    AX1H04    // Throwing Axe
    BLUN01    // Club
    BLUN02    // Flail
    BLUN04    // Mace
    BLUN06    // Morning Star
    BOW01     // Composite Long Bow
    BOW03     // Long Bow
    BOW05     // Short Bow
    CHAN01    // Chain Mail Armor
    CHAN04    // Splint Mail
    DAGG01    // Dagger
    DAGG05    // Throwing Dagger
    HALB01    // Halberd
    HAMM01    // War Hammer
    HELM01    // Helmet
    LEAT01    // Leather Armor
    LEAT04    // Studded Leather Armor
    PLAT01    // Plate Mail Armor
    SHLD01    // Small Shield
    SHLD03    // Medium Shield
    SHLD05    // Large Shield
    SHLD08    // Buckler
    SHLD09    // Buckler
    SHLD10    // Buckler
    SHLD11    // Small Shield
    SHLD12    // Small Shield
    SHLD13    // Medium Shield
    SHLD14    // Medium Shield
    SHLD15    // Large Shield
    SHLD16    // Large Shield
    SLNG01    // Sling 
    SPER01    // Spear
    STAF01    // Quarterstaff
    SW1H01    // Bastard Sword 
    SW1H04    // Long Sword 
    SW1H07    // Short Sword 
    SW1H20    // Scimitar
    SW1H43    // Katana
    SW1H46    // Wakizashi
    SW1H48    // Ninja-To
    SW2H01    // Two Handed Sword
    XBOW01    // Heavy Crossbow
    XBOW04    // Light Crossbow
    POTN20    // Antidote
    POTN08    // Potion of Healing
    POTN09    // Potion of Heroism
    POTN44    // Potion of Strength

  LPF store INT_VAR
    sell=145
    buy=20
    steal=35
    fence=0
  END

  ADD_STORE_ITEM XBOW05   LAST #0 #0 #0 IDENTIFIED #1   // Light Crossbow +1
  ADD_STORE_ITEM SCRL59   LAST #1 #0 #0 IDENTIFIED #1   // neutralize poison
  ADD_STORE_ITEM DART03   LAST #10 #0 #0 IDENTIFIED #1  // Dart of Stunning
  ADD_STORE_ITEM amul07   LAST #0 #0 #0 IDENTIFIED #1   // rainbow obsidian
  ADD_STORE_ITEM ring17   LAST #0 #0 #0 IDENTIFIED #1   // flamedance
  ADD_STORE_ITEM SCRL94   LAST #1 #0 #0 IDENTIFIED #1   // Resist Fear
  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Healing
  ADD_STORE_ITEM POTN42   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Regeneration 
  ADD_STORE_ITEM POTN29   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Genius

END BUT_ONLY

//////////////////////////////
/*
// FFBART - Samuel Thunderburp
// 
// Five Flagons, Bridge District

COPY_EXISTING ffbart.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END

END BUT_ONLY
*/
////////////////////
/*
// TRINNK01 - Vyatri
// 
// Trademeet

COPY_EXISTING trinnk01.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END

END BUT_ONLY
*/
////////////////////

// BERNARD - Bernard
// 
// Copper Coronet

// 100% stock overwrite

COPY_EXISTING bernard.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    AMUL10    // Gold Necklace
    AMUL13    // Bloodstone Amulet
    SHLD03    // Medium Shield
    SHLD08    // Buckler
    SHLD09    // Buckler
    SHLD11    // Small Shield
    SHLD12    // Small Shield
    SHLD14    // Medium Shield
    SHLD15    // Large Shield
    SHLD16    // Large Shield
    SHLD02    // Small Shield +1
    DAGG01    // Dagger
    DAGG05    // Throwing Dagger
    DAGG02    // Dagger +1
    AX1H01    // Battle Axe
    SW1H01    // Bastard Sword 
    SW1H04    // Long Sword 
    SW1H05    // Long Sword +1
    SW1H07    // Short Sword 
    SW1H08    // Short Sword +1
    SW1H20    // Scimitar
    SW1H43    // Katana
    SW1H46    // Wakizashi
    SW1H48    // Ninja-To
    SW2H01    // Two Handed Sword
    LEAT01    // Leather Armor
    LEAT04    // Studded Leather Armor
    CHAN04    // Splint Mail
    CHAN01    // Chain Mail Armor
    STAF01    // Quarterstaff
    HAMM01    // War Hammer
    SPER01    // Spear
    BLUN01    // Club
    BLUN02    // Flail
    BLUN04    // Mace
    BLUN06    // Morning Star
    XBOW01    // Heavy Crossbow
    XBOW04    // Light Crossbow
    XBOW06    // Light Crossbow of Speed 
    BOW01     // Composite Long Bow
    BOW03     // Long Bow
    BOW05     // Short Bow
    SLNG01    // Sling 
    AX1H01    // Battle Axe
    AX1H04    // Throwing Axe
    DAGG01    // Dagger
    HALB01    // Halberd
    DART01    // Dart
    AROW01    // Arrows
    BOLT01    // Bolt
    BULL01    // Bullet
    POTN08    // Potion of Healing
    POTN09    // Potion of Heroism
    POTN30    // Potion of Infravision
    POTN44    // Potion of Strength
    SCRL66    // Grease
    SCRL67    // Armor
    SCRL68    // Burning Hands
    SCRL69    // Charm Person
    SCRL70    // Color Spray
    SCRL71    // Blindness
    SCRL82    // Chill Touch
    SCRL83    // Chromatic Orb
    SCRL84    // Larloch's Minor Drain
    SCRL85    // Blur
    SCRL86    // Detect Evil
    SCRL98    // Strength
    SCRL99    // Web
    SCRL1B    // Agannazar's Scorcher
    SCRL1C    // Ghoul Touch
    SCRL3G    // Vocalize
    SCRL1N    // Protection From Normal Missiles
    SCRL1O    // Slow
    SCRL1P    // Skull Trap
    SCRL1Q    // Vampiric Touch
    SCRL1S    // Dire Charm
    SCRL1T    // Ghost Armor
    AROW08    // Arrow of Fire
    AROW04    // Acid Arrows
    RESTORE   // Restoration
    SW1H53    // Sword of Flame +1
    BAG03     // Scroll Case
 // these are RR's additions
    ~RR#BOW02~  // Composite Short Bow
    ~RR#BUC02~  // Buckler +1

  LPF store INT_VAR
    sell=145
    buy=20
    steal=0
    fence=0
  END

  ADD_STORE_ITEM SHLD08   LAST #0 #0 #0 IDENTIFIED #1   // Buckler
  ADD_STORE_ITEM DAGG01   LAST #0 #0 #0 IDENTIFIED #1   // Dagger
  ADD_STORE_ITEM SW1H05   LAST #0 #0 #0 IDENTIFIED #1   // Long Sword +1
  ADD_STORE_ITEM SW1H43   LAST #0 #0 #0 IDENTIFIED #1   // Katana
  ADD_STORE_ITEM STAF01   LAST #0 #0 #0 IDENTIFIED #1   // Quarterstaff
  ADD_STORE_ITEM XBOW04   LAST #0 #0 #0 IDENTIFIED #1   // Light Crossbow
  ADD_STORE_ITEM AX1H04   LAST #10 #0 #0 IDENTIFIED #2  // Throwing Axe
  ADD_STORE_ITEM DART01   LAST #10 #0 #0 IDENTIFIED #1  // Dart
  ADD_STORE_ITEM BOLT01   LAST #40 #0 #0 IDENTIFIED #5  // Bolt
  ADD_STORE_ITEM ring14   LAST #0 #0 #0 IDENTIFIED #1   // greenstone
  ADD_STORE_ITEM misc20   LAST #0 #0 #0 IDENTIFIED #1   // bloodstone
  ADD_STORE_ITEM misc21   LAST #0 #0 #0 IDENTIFIED #1   // skydrop
  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Extra Healing
  ADD_STORE_ITEM POTN02   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Fire Resistance
  ADD_STORE_ITEM SCRL5B   LAST #1 #0 #0 IDENTIFIED #1   // defensive harmony
  ADD_STORE_ITEM SCRL1G   LAST #1 #0 #0 IDENTIFIED #1   // Fireball
  ADD_STORE_ITEM SCRL93   LAST #1 #0 #0 IDENTIFIED #1   // Luck
  ADD_STORE_ITEM SCRL79   LAST #1 #0 #0 IDENTIFIED #1   // Shield
  ADD_STORE_ITEM SCRL77   LAST #1 #0 #0 IDENTIFIED #1   // Magic Missile

END BUT_ONLY

///////////////////////
/*
// CROBAR01 - Groncaner
// 
// Crooked Crane, Gates

COPY_EXISTING crobar01.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END

END BUT_ONLY
*/
/////////////////////////////////
/*
// UHINN01 - Vincenzo the Innkeep
// 
// Umar Hills

COPY_EXISTING uhinn01.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END

END BUT_ONLY
*/
//////////////////////
/*
// PPINN01 - Innkeeper
// 
// Brynnlaw

END BUT_ONLY
*/
////////////
// fences //
////////////

//////////////////////////

// ROGER - Roger the Fence
// 
// sewers, Questpack has a potion quest related to him

// 100% stock overwrite

COPY_EXISTING roger.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR potn=1 END
  REMOVE_STORE_ITEM 
    POTN02    // Potion of Fire Resistance
    POTN04    // Potion of Frost Giant Strength
    POTN05    // Potion of Fire Giant Strength
    POTN06    // Potion of Cloud Giant Strength
    POTN07    // Potion of Storm Giant Strength
    POTN08    // Potion of Healing
    POTN09    // Potion of Heroism
    POTN11    // Potion of Invulnerability
    POTN12    // Potion of Stone Giant Strength
    POTN13    // Oil of Fiery Burning
    POTN17    // Elixir of Health
    POTN18    // Potion of Absorbtion 
    POTN20    // Antidote
    POTN21    // Potion of Clarity
    POTN24    // Potion of Defense
    POTN25    // Potion of Healing
    POTN27    // Potion of Firebreath
    POTN30    // Potion of Infravision
    POTN32    // Antidote
    POTN34    // Potion of Magic Protection
    POTN35    // Potion of Magic Shielding
    POTN37    // Potion of Mind Focusing
    POTN39    // Potion of Perception
    POTN40    // Potion of Invulnerability
    POTN42    // Potion of Regeneration 
    POTN44    // Potion of Strength
    POTN52    // Potion of Extra Healing
    POTN03    // Potion of Hill Giant Strength
    POTN19    // Potion of Agility
    POTN36    // Potion of Master Thievery
    POTN29    // Potion of Genius

  LPF store INT_VAR
    sell=145
    buy=15
    steal=0
    fence=1
  END

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #10  // Potion of Healing
  ADD_STORE_ITEM POTN19   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Agility
  ADD_STORE_ITEM POTN37   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Mind Focusing
  ADD_STORE_ITEM POTN03   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Hill Giant Strength
  ADD_STORE_ITEM POTN31   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Insulation
  ADD_STORE_ITEM POTN13   LAST #1 #0 #0 IDENTIFIED #1   // Oil of Fiery Burning

  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Extra Healing
  ADD_STORE_ITEM POTN17   LAST #1 #0 #0 IDENTIFIED #1   // Elixir of Health
  ADD_STORE_ITEM POTN14   LAST #1 #0 #0 IDENTIFIED #1   // Oil of Speed
  ADD_STORE_ITEM POTN10   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Invisibility
  ADD_STORE_ITEM POTN26   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Explosions

  ADD_STORE_ITEM POTN34   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Magic Protection
  ADD_STORE_ITEM POTN11   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Invulnerability
  ADD_STORE_ITEM POTN30   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Infravision

END BUT_ONLY

////////////////

// JAYES - Jayes
// 
// halfing, Promenade, eastern grid

// 100% stock overwrite

COPY_EXISTING jayes.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    AX1H02    // Battle Axe +1
    BLUN02    // Flail
    BLUN06    // Morning Star
    BLUN05    // Mace +1
    BLUN07    // Morning Star +1
    BLUN13    // Flail +2
    BOW03     // Long Bow
    BOW05     // Short Bow
    BOW02     // Composite Long Bow +1
    BOW18     // Short Bow +2
    DAGG15    // Dagger +2
    DART01    // Dart
    SLNG01    // Sling 
    STAF08    // Martial Staff +3
    SW1H04    // Long Sword 
    SW1H07    // Short Sword 
    SW1H46    // Wakizashi
    SW1H22    // Scimitar +1
    SW1H41    // Long Sword +2
    SW1H47    // Wakizashi +1
    SW2H01    // Two Handed Sword
    SW2H02    // Two Handed Sword +1
    XBOW09    // Light Crossbow +2
    AROW01    // Arrows
    AROW11    // Arrow +2
    AROW10    // Arrows of Piercing
    BOLT01    // Bolt
    BOLT02    // Bolt +1
    BULL01    // Bullet
    BULL03    // Bullet +2
    CHAN01    // Chain Mail Armor
    CHAN08    // Chain Mail +2
    LEAT04    // Studded Leather Armor
    LEAT11    // Leather Armor +2
    PLAT01    // Plate Mail Armor
    SHLD01    // Small Shield
    SHLD03    // Medium Shield
    SHLD08    // Buckler
    SHLD10    // Buckler
    SHLD15    // Large Shield
    SHLD04    // Medium Shield +1
    SHLD28    // Small Shield +2
    POTN20    // Antidote
    SCRL6Y    // Protection from Acid
    SCRL6Z    // Phantom Blade
    SCRL7B    // Conjure Lesser Air Elemental
    SCRL7C    // Conjure Lesser Earth Elemental
    SCRL7D    // Minor Spell Turning
    SCRL7W    // Wyvern Call
    SCRL7X    // Conjure Fire Elemental
    SCRL7Y    // Conjure Air Elemental
    SCRL7Z    // Conjure Earth Elemental
    SCRL8A    // Carrion Summons
    SCRL8B    // Summon Nishru
    SCRL8C    // Stone to Flesh
    BAG03F    // Scroll Case
    CLCK09    // Mage Robe of Cold Resistance
 // these are RR's additions
    BLUN01    // Club
    ~RR#SAP01~  // Sap
    ~RR#BOW02~  // Composite Short Bow
    ~RR#BOW04~  // Composite Short Bow +2
    ~RR#BUC02~  // Buckler +1
    ~RR#BUC03~  // Buckler +2

  LPF store INT_VAR
    sell=160
    buy=15
    steal=0
    fence=1
  END

  WRITE_LONG 0xc 17727

  ADD_STORE_ITEM SW1H08   LAST #0 #0 #0 IDENTIFIED #1   // Short Sword +1
  ADD_STORE_ITEM HAMM08   LAST #0 #0 #0 IDENTIFIED #1   // War Hammer +2
  ADD_STORE_ITEM LEAT05   LAST #0 #0 #0 IDENTIFIED #1   // Studded Leather Armor +1
  ADD_STORE_ITEM DAGG16   LAST #10 #0 #0 IDENTIFIED #2  // Poisoned Throwing Dagger

  PATCH_IF comp_rr_equip=1 BEGIN
    ADD_STORE_ITEM ~RR#BOW03~ LAST #0 #0 #0 IDENTIFIED #1  // Composite Short Bow +1
  END

  ADD_STORE_ITEM DART03   LAST #10 #0 #0 IDENTIFIED #2  // Dart of Stunning
  ADD_STORE_ITEM DART04   LAST #10 #0 #0 IDENTIFIED #2  // Dart of Wounding
  ADD_STORE_ITEM AROW02   LAST #20 #0 #0 IDENTIFIED #2  // Arrows +1
  ADD_STORE_ITEM arow06   LAST #1 #0 #0 IDENTIFIED #1   // arrow of detonation

  ADD_STORE_ITEM POTN37   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Mind Focusing
  ADD_STORE_ITEM POTN42   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Regeneration 

  ADD_STORE_ITEM amul06   LAST #0 #0 #0 IDENTIFIED #1   // anti-magnie
  ADD_STORE_ITEM ring10   LAST #0 #0 #0 IDENTIFIED #1   // gold
  ADD_STORE_ITEM misc23   LAST #0 #0 #0 IDENTIFIED #1   // jasper

  ADD_STORE_ITEM SCRL72   LAST #1 #0 #0 IDENTIFIED #1   // Friends
  ADD_STORE_ITEM SCRL95   LAST #1 #0 #0 IDENTIFIED #1   // Melf's Acid Arrow
  ADD_STORE_ITEM SCRL1G   LAST #1 #0 #0 IDENTIFIED #1   // Fireball
  ADD_STORE_ITEM SCRL1W   LAST #1 #0 #0 IDENTIFIED #1   // Fireshield (Blue)
  ADD_STORE_ITEM SCRL6O   LAST #1 #0 #0 IDENTIFIED #1   // Secret Word
  ADD_STORE_ITEM SCRL5O   LAST #1 #0 #0 IDENTIFIED #1   // Hold Monster
  ADD_STORE_ITEM SCRL7J   LAST #1 #0 #0 IDENTIFIED #1   // Protection From Magic Energy

  ADD_STORE_ITEM SCRL62   LAST #1 #0 #0 IDENTIFIED #1   // flame strike
  ADD_STORE_ITEM SCRL63   LAST #1 #0 #0 IDENTIFIED #1   // raise dead

END BUT_ONLY

////////////////

// DMARK - Fovem
// 
// Docks, near the loading platform
// easy to stumble upon, give him very cheap stuff

// 100% stock overwrite

COPY_EXISTING dmark.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    AX1H01    // Battle Axe
    BOW03     // Long Bow
    BOW05     // Short Bow
    XBOW04    // Light Crossbow
    DAGG01    // Dagger
    DART01    // Dart
    SLNG01    // Sling 
    SW1H01    // Bastard Sword 
    SW1H48    // Ninja-To
    SW1H43    // Katana
    SW1H46    // Wakizashi
    POTN20    // Antidote
    POTN26    // Potion of Explosions
    AROW01    // Arrows
    BOLT01    // Bolt
    BULL01    // Bullet
    CHAN04    // Splint Mail
    PLAT04    // Full Plate Mail
    LEAT04    // Studded Leather Armor
    SHLD08    // Buckler
 // these are RR's additions
    BLUN01    // Club
    ~RR#SAP01~  // Sap
    ~RR#BOW02~  // Composite Short Bow

  LPF store INT_VAR
    sell=135
    buy=15
    steal=0
    fence=1
  END

  WRITE_LONG 0xc 46004

  ADD_STORE_ITEM ring15   LAST #0 #0 #0 IDENTIFIED #1   // bloodstone
  ADD_STORE_ITEM misc29   LAST #0 #0 #0 IDENTIFIED #1   // ziose
  ADD_STORE_ITEM amul10   LAST #0 #0 #0 IDENTIFIED #1   // gold

  ADD_STORE_ITEM AROW02   LAST #20 #0 #0 IDENTIFIED #1  // Arrows +1
  ADD_STORE_ITEM DART02   LAST #20 #0 #0 IDENTIFIED #1  // Dart +1
  ADD_STORE_ITEM AROW04   LAST #10 #0 #0 IDENTIFIED #1  // Acid Arrows

  ADD_STORE_ITEM POTN43   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Insight 
  ADD_STORE_ITEM POTN13   LAST #1 #0 #0 IDENTIFIED #1   // Oil of Fiery Burning
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Extra Healing
  ADD_STORE_ITEM POTN17   LAST #1 #0 #0 IDENTIFIED #1   // Elixir of Health

  ADD_STORE_ITEM SW1H05   LAST #0 #0 #0 IDENTIFIED #1   // Long Sword +1
  ADD_STORE_ITEM BOW04    LAST #0 #0 #0 IDENTIFIED #1   // Long Bow +1
  ADD_STORE_ITEM DAGG02   LAST #0 #0 #0 IDENTIFIED #1   // Dagger +1
  ADD_STORE_ITEM DAGG16   LAST #10 #0 #0 IDENTIFIED #1  // Poisoned Throwing Dagger

  ADD_STORE_ITEM SCRL77   LAST #1 #0 #0 IDENTIFIED #1   // Magic Missile
  ADD_STORE_ITEM SCRL78   LAST #1 #0 #0 IDENTIFIED #1   // Protection From Evil
  ADD_STORE_ITEM SCRL92   LAST #1 #0 #0 IDENTIFIED #1   // Know Alignment

  PATCH_IF comp_rr_equip=1 BEGIN
    ADD_STORE_ITEM ~RR#SAP01~ LAST #0 #0 #0 IDENTIFIED #1  // sap
  END

  ADD_STORE_ITEM SCRL56   LAST #1 #0 #0 IDENTIFIED #1   // cure serious wounds

END BUT_ONLY

/////////////////////

// BSHOP01 - Cutpurse
// 
// Bridge District, near Neb's house

// 100% stock overwrite

COPY_EXISTING bshop01.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    BLUN01    // Club
    BLUN02    // Flail
    BLUN06    // Morning Star
    BOW05     // Short Bow
    BOW06     // Short Bow +1
    DAGG05    // Throwing Dagger
    DART01    // Dart
    STAF07    // Staff Spear +2
    SW1H04    // Long Sword 
    SW1H07    // Short Sword 
    SW1H22    // Scimitar +1
    SW1H43    // Katana
    XBOW01    // Heavy Crossbow
    XBOW05    // Light Crossbow +1
    XBOW09    // Light Crossbow +2
    AROW01    // Arrows
    AROW11    // Arrow +2
    BOLT01    // Bolt
    BOLT06    // Bolt +2
    BULL01    // Bullet
    LEAT05    // Studded Leather Armor +1
    LEAT02    // Leather Armor +1
    SCRL04    // Protection from Cold
    POTN08    // Potion of Healing
    POTN20    // Antidote
    POTN41    // Potion of Power
    POTN42    // Potion of Regeneration 
    POTN36    // Potion of Master Thievery
    WAND05    // Wand of Fire
    SCRL6I    // Protection from Cold
    SCRL6J    // Spell Thrust
    SCRL6K    // Detect Illusion
    SCRL6L    // Hold Undead
    SCRL6M    // Enchanted Weapon
    SCRL6N    // Fireshield (Red)
    SCRL6O    // Secret Word
    SCRL6P    // Minor Sequencer
    SCRL6Q    // Teleport Field
    SCRL6R    // Spider Spawn
    SCRL6S    // Spell Immunity
    SCRL7O    // Protection From Magic Weapons
    SCRL7P    // Power Word Silence
    SCRL7Q    // Improved Haste
    SCRL7R    // Death Fog
 // these are RR's additions
    BLUN01    // Club
    ~RR#SAP01~  // Sap
    ~RR#BOW02~  // Composite Short Bow
    ~RR#BOW03~  // Composite Short Bow +1

  LPF store INT_VAR
    sell=155
    buy=15
    steal=0
    fence=1
  END

  SAY 0xc @200129 // Halfling Cutpurse

  ADD_STORE_ITEM amul02   LAST #0 #0 #0 IDENTIFIED #1   // necklace
  ADD_STORE_ITEM amul05   LAST #0 #0 #0 IDENTIFIED #2   // bluestone
  ADD_STORE_ITEM ring16   LAST #0 #0 #0 IDENTIFIED #2   // angel skin
  ADD_STORE_ITEM misc20   LAST #0 #0 #0 IDENTIFIED #1   // bloodstone
  ADD_STORE_ITEM misc21   LAST #0 #0 #0 IDENTIFIED #3   // skydrop
  ADD_STORE_ITEM misc42   LAST #0 #0 #0 IDENTIFIED #1   // diamond

  ADD_STORE_ITEM CLCK09   LAST #0 #0 #0 IDENTIFIED #1   // Mage Robe of Cold Resistance
  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM wand02   LAST #10 #0 #0 IDENTIFIED #1  // fear
  END ELSE BEGIN
    ADD_STORE_ITEM wand02   LAST #50 #0 #0 IDENTIFIED #1  // fear
  END
  ADD_STORE_ITEM SCRL05   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Electricity

  ADD_STORE_ITEM POTN43   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Insight 
  ADD_STORE_ITEM POTN20   LAST #1 #0 #0 IDENTIFIED #1   // Antidote
  ADD_STORE_ITEM POTN36   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Master Thievery
  ADD_STORE_ITEM potn38   LAST #1 #0 #0 IDENTIFIED #1   // potion of mirrored eyes

  ADD_STORE_ITEM BOLT02   LAST #20 #0 #0 IDENTIFIED #1  // Bolt +1
  ADD_STORE_ITEM AROW08   LAST #20 #0 #0 IDENTIFIED #1  // Arrow of Fire
  ADD_STORE_ITEM AROW10   LAST #10 #0 #0 IDENTIFIED #1  // Arrows of Piercing
  PATCH_IF comp_nodispel=0 BEGIN
    ADD_STORE_ITEM AROW07   LAST #5 #0 #0 IDENTIFIED #1   // Arrows of Dispelling
  END

  ADD_STORE_ITEM BOW02    LAST #0 #0 #0 IDENTIFIED #1   // Composite Long Bow +1
  ADD_STORE_ITEM STAF02   LAST #0 #0 #0 IDENTIFIED #1   // Quarterstaff +1
  ADD_STORE_ITEM SW1H22   LAST #0 #0 #0 IDENTIFIED #1   // Scimitar +1
  ADD_STORE_ITEM DAGG16   LAST #10 #0 #0 IDENTIFIED #1  // Poisoned Throwing Dagger

  ADD_STORE_ITEM SCRL83   LAST #1 #0 #0 IDENTIFIED #1   // Chromatic Orb
  ADD_STORE_ITEM SCRL85   LAST #1 #0 #0 IDENTIFIED #1   // Blur
  ADD_STORE_ITEM SCRL1L   LAST #1 #0 #0 IDENTIFIED #1   // Monster Summoning I
  ADD_STORE_ITEM SCRL1X   LAST #1 #0 #0 IDENTIFIED #1   // Ice Storm
  ADD_STORE_ITEM SCRL6H   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Fire
  ADD_STORE_ITEM SCRL6T   LAST #1 #0 #0 IDENTIFIED #1   // Protection From Normal Weapons

END BUT_ONLY

////////////////////

// ARLED - Arledrian
// 
// Gaelan Bayle's house, Rogue Rebalancing has a quest for him

// 100% stock overwrite

COPY_EXISTING ar0312.are override PATCH_IF SOURCE_SIZE>0x11c BEGIN
  LPF DELETE_AREA_ITEM STR_VAR item_to_delete=wand03 END // moving MM wand to his store
END BUT_ONLY

COPY_EXISTING arled.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    AROW01    // Arrows
    AROW11    // Arrow +2
    AROW10    // Arrows of Piercing
    AROW04    // Acid Arrows
    BOLT01    // Bolt
    BOLT04    // Bolt of Biting 
    BOLT03    // Bolt of Lightning
    BULL01    // Bullet
    BULL03    // Bullet +2
    AMUL14    // Amulet of Protection +1
    WAND06    // Wand of Frost
    POTN14    // Oil of Speed
    POTN19    // Potion of Agility
    POTN20    // Antidote
    POTN18    // Potion of Absorbtion 
    POTN52    // Potion of Extra Healing
    POTN39    // Potion of Perception
    POTN36    // Potion of Master Thievery
    POTN05    // Potion of Fire Giant Strength
    SCRL05    // Protection from Electricity
    SCRL1Y    // Improved Invisibility
    SCRL1M    // Non-Detection
    CHAN01    // Chain Mail Armor
    CHAN02    // Chain Mail +1
    CHAN05    // Splint Mail +1
    SHLD04    // Medium Shield +1
    STAF02    // Quarterstaff +1
    SW1H08    // Short Sword +1
    SW1H22    // Scimitar +1
    SW1H44    // Katana +1
    SW2H02    // Two Handed Sword +1
    SPER02    // Spear +1
    BLUN03    // Flail +1
    BLUN05    // Mace +1
    BLUN07    // Morning Star +1
    XBOW02    // Heavy Crossbow +1
    XBOW05    // Light Crossbow +1
    BOW02     // Composite Long Bow +1
    BOW04     // Long Bow +1
    BOW06     // Short Bow +1
    SLNG02    // Sling +1
    AX1H02    // Battle Axe +1
    DAGG02    // Dagger +1
    HALB02    // Halberd +1
    DART02    // Dart +1
    DAGG16    // Poisoned Throwing Dagger
    RESTORE   // Restoration
    BAG02D    // Gem bag
    MISC3P    // Glasses of Identification
    CLCK13    // Traveller's Robe
 // these are RR's additions
    BLUN01    // Club
    ~RR#SAP01~  // Sap
    ~RR#BOW03~  // Composite Short Bow +1

  LPF store INT_VAR
    sell=155
    buy=15
    steal=0
    fence=1
  END

  ADD_STORE_ITEM AMUL14   LAST #0 #0 #0 IDENTIFIED #1   // Amulet of Protection +1
  ADD_STORE_ITEM SHLD04   LAST #0 #0 #0 IDENTIFIED #1   // Medium Shield +1
  ADD_STORE_ITEM SW1H08   LAST #0 #0 #0 IDENTIFIED #1   // Short Sword +1
  ADD_STORE_ITEM SW1H22   LAST #0 #0 #0 IDENTIFIED #1   // Scimitar +1
  ADD_STORE_ITEM SW1H44   LAST #0 #0 #0 IDENTIFIED #1   // Katana +1
  ADD_STORE_ITEM XBOW05   LAST #0 #0 #0 IDENTIFIED #1   // Light Crossbow +1
  ADD_STORE_ITEM BOW02    LAST #0 #0 #0 IDENTIFIED #1   // Composite Long Bow +1
  ADD_STORE_ITEM DAGG02   LAST #0 #0 #0 IDENTIFIED #1   // Dagger +1
  ADD_STORE_ITEM DART02   LAST #40 #0 #0 IDENTIFIED #3  // Dart +1
  ADD_STORE_ITEM DAGG16   LAST #10 #0 #0 IDENTIFIED #3  // Poisoned Throwing Dagger

  PATCH_IF comp_rr_equip=1 BEGIN
    ADD_STORE_ITEM ~RR#SAP01~ LAST #0 #0 #0 IDENTIFIED #3  // sap
    ADD_STORE_ITEM ~RR#BOW03~ LAST #0 #0 #0 IDENTIFIED #1  // Composite Short Bow +1
  END

  ADD_STORE_ITEM misc75   LAST #0 #0 #0  IDENTIFIED #1  // Dagger of Venom
  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM wand03   LAST #10 #0 #0 IDENTIFIED #1  // mm
  END ELSE BEGIN
    ADD_STORE_ITEM wand03   LAST #50 #0 #0 IDENTIFIED #1  // mm
  END

  ADD_STORE_ITEM AROW02   LAST #20 #0 #0 IDENTIFIED #1  // Arrows +1
  ADD_STORE_ITEM AROW04   LAST #10 #0 #0 IDENTIFIED #1  // Acid Arrows
  ADD_STORE_ITEM AROW05   LAST #10 #0 #0 IDENTIFIED #1  // Arrow of Biting
  ADD_STORE_ITEM AROW10   LAST #10 #0 #0 IDENTIFIED #1  // Arrows of Piercing

  ADD_STORE_ITEM POTN19   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Agility
  ADD_STORE_ITEM POTN13   LAST #1 #0 #0 IDENTIFIED #2   // Oil of Fiery Burning
  ADD_STORE_ITEM POTN36   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Master Thievery
  ADD_STORE_ITEM POTN10   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Invisibility
  ADD_STORE_ITEM POTN30   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Infravision
  ADD_STORE_ITEM POTN39   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Perception

  ADD_STORE_ITEM SCRL1Q   LAST #1 #0 #0 IDENTIFIED #1   // Vampiric Touch
  ADD_STORE_ITEM SCRL5H   LAST #1 #0 #0 IDENTIFIED #1   // Emotion
  ADD_STORE_ITEM SCRL2H   LAST #1 #0 #0 IDENTIFIED #1   // Shadow Door

END BUT_ONLY

////////////////////////////////

// SLSHOP01 - Black Market Thief
// 
// Slums, near Ilmater temple on roofs. sneaky bastard, i didn't even know there was the second fence in Slums
// since he's so hard to find, give him best stuff

// 100% stock overwrite

COPY_EXISTING slshop01.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    AX1H01    // Battle Axe
    AX1H02    // Battle Axe +1
    BLUN02    // Flail
    BLUN06    // Morning Star
    BLUN05    // Mace +1
    BLUN07    // Morning Star +1
    BOW03     // Long Bow
    BOW05     // Short Bow
    BOW02     // Composite Long Bow +1
    BOW18     // Short Bow +2
    DAGG01    // Dagger
    DAGG15    // Dagger +2
    DART01    // Dart
    SLNG01    // Sling 
    STAF01    // Quarterstaff
    STAF08    // Martial Staff +3
    SW1H04    // Long Sword 
    SW1H07    // Short Sword 
    SW1H46    // Wakizashi
    SW1H22    // Scimitar +1
    SW1H47    // Wakizashi +1
    SW2H01    // Two Handed Sword
    SW2H02    // Two Handed Sword +1
    XBOW01    // Heavy Crossbow
    AROW01    // Arrows
    AROW11    // Arrow +2
    AROW10    // Arrows of Piercing
    BOLT01    // Bolt
    BOLT02    // Bolt +1
    BULL01    // Bullet
    BULL03    // Bullet +2
    CHAN01    // Chain Mail Armor
    LEAT04    // Studded Leather Armor
    PLAT01    // Plate Mail Armor
    SHLD01    // Small Shield
    SHLD03    // Medium Shield
    SHLD08    // Buckler
    SHLD10    // Buckler
    SHLD15    // Large Shield
    SHLD04    // Medium Shield +1
 // these are RR's additions
    BLUN01    // Club
    ~RR#SAP01~  // Sap
    ~RR#BOW02~  // Composite Short Bow
    ~RR#BOW04~  // Composite Short Bow +2

  LPF store INT_VAR
    sell=175
    buy=15
    steal=0
    fence=1
  END

  WRITE_LONG 0xc 22073

  ADD_STORE_ITEM BLUN21   LAST #0 #0 #0 IDENTIFIED #1   // Mace +2
  ADD_STORE_ITEM DAGG15   LAST #0 #0 #0 IDENTIFIED #1   // Dagger +2
  ADD_STORE_ITEM BOW18    LAST #0 #0 #0 IDENTIFIED #1   // Short Bow +2
  ADD_STORE_ITEM LEAT12   LAST #0 #0 #0 IDENTIFIED #1   // Leather Armor +3

  PATCH_IF comp_rr_equip=1 BEGIN
    ADD_STORE_ITEM ~RR#BUC03~ LAST #0 #0 #0 IDENTIFIED #1  // Buckler +2
  END

  ADD_STORE_ITEM AROW05   LAST #10 #0 #0 IDENTIFIED #1  // Arrow of Biting
  ADD_STORE_ITEM AROW10   LAST #10 #0 #0 IDENTIFIED #2  // Arrows of Piercing
  PATCH_IF comp_nodispel=0 BEGIN
    ADD_STORE_ITEM AROW07   LAST #5 #0 #0 IDENTIFIED #1   // Arrows of Dispelling
  END
  ADD_STORE_ITEM arow06   LAST #5 #0 #0 IDENTIFIED #1   // arrow of detonation
  ADD_STORE_ITEM AROW11   LAST #20 #0 #0 IDENTIFIED #1  // Bolt of Biting 
  ADD_STORE_ITEM BOLT03   LAST #20 #0 #0 IDENTIFIED #1  // Bolt of Lightning
  ADD_STORE_ITEM bull04   LAST #20 #0 #0 IDENTIFIED #1  // sunstone bullet
  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM BULL06   LAST #10 #0 #0 IDENTIFIED #1  // Bullet of Smiting (Bullet +4)
  END

  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM wand05   LAST #10 #0 #0 IDENTIFIED #1  // fire
  END ELSE BEGIN
    ADD_STORE_ITEM wand05   LAST #50 #50 #0 IDENTIFIED #1 // fire
  END

  ADD_STORE_ITEM POTN05   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Fire Giant Strength
  ADD_STORE_ITEM POTN34   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Magic Protection
  ADD_STORE_ITEM POTN46   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Stone Form
  ADD_STORE_ITEM POTN39   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Perception

  ADD_STORE_ITEM ring06   LAST #0 #0 #0 IDENTIFIED #1   // of protection +1
  ADD_STORE_ITEM misc43   LAST #0 #0 #0 IDENTIFIED #1   // emerald
  ADD_STORE_ITEM misc45   LAST #0 #0 #0 IDENTIFIED #1   // rogue stone

  ADD_STORE_ITEM SCRL5I   LAST #1 #0 #0 IDENTIFIED #1   // Greater Malison
  ADD_STORE_ITEM SCRL1X   LAST #1 #0 #0 IDENTIFIED #1   // Ice Storm
  ADD_STORE_ITEM SCRL1Y   LAST #1 #0 #0 IDENTIFIED #1   // Improved Invisibility
  ADD_STORE_ITEM SCRL5P   LAST #1 #0 #0 IDENTIFIED #1   // Chaos
  ADD_STORE_ITEM SCRL2H   LAST #1 #0 #0 IDENTIFIED #1   // Shadow Door
  ADD_STORE_ITEM SCRL7K   LAST #1 #0 #0 IDENTIFIED #1   // Mislead
  ADD_STORE_ITEM SCRL7O   LAST #1 #0 #0 IDENTIFIED #1   // Protection From Magic Weapons

END BUT_ONLY

///////////////////////

// SLSHOP02 - Storekeep
// 
// Slums, female, near Jansen house

// 100% stock overwrite

COPY_EXISTING slshop02.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    AX1H01    // Battle Axe
    BLUN02    // Flail
    BLUN06    // Morning Star
    BOW03     // Long Bow
    BOW05     // Short Bow
    DAGG01    // Dagger
    DAGG16    // Poisoned Throwing Dagger
    DART01    // Dart
    DART02    // Dart +1
    SLNG01    // Sling 
    SLNG04    // Sling +2
    STAF01    // Quarterstaff
    SW1H04    // Long Sword 
    SW1H07    // Short Sword 
    SW1H48    // Ninja-To
    SW2H01    // Two Handed Sword
    SPER01    // Spear
    XBOW04    // Light Crossbow
    XBOW01    // Heavy Crossbow
    XBOW02    // Heavy Crossbow +1
    AROW01    // Arrows
    AROW08    // Arrow of Fire
    BOLT01    // Bolt
    BULL01    // Bullet
    CHAN01    // Chain Mail Armor
    LEAT04    // Studded Leather Armor
    LEAT07    // Studded Leather Armor +2
    PLAT01    // Plate Mail Armor
    PLAT04    // Full Plate Mail
    SHLD01    // Small Shield
    SHLD03    // Medium Shield
    SHLD08    // Buckler
    SHLD11    // Small Shield
    SHLD14    // Medium Shield
    POTN08    // Potion of Healing
 // these are RR's additions
    BLUN01    // Club
    ~RR#SAP01~  // Sap
    ~RR#BOW02~  // Composite Short Bow

  LPF store INT_VAR
    sell=135
    buy=15
    steal=0
    fence=1
  END

  SAY 0xc @200131 // Half-Orc Fence

  ADD_STORE_ITEM SW1H05   LAST #0 #0 #0 IDENTIFIED #1   // Long Sword +1
  ADD_STORE_ITEM BLUN05   LAST #0 #0 #0 IDENTIFIED #1   // Mace +1
  ADD_STORE_ITEM XBOW05   LAST #0 #0 #0 IDENTIFIED #1   // Light Crossbow +1
  ADD_STORE_ITEM LEAT02   LAST #0 #0 #0 IDENTIFIED #1   // Leather Armor +1
  ADD_STORE_ITEM DAGG16   LAST #10 #0 #0 IDENTIFIED #2  // Poisoned Throwing Dagger

  ADD_STORE_ITEM AROW11   LAST #10 #0 #0 IDENTIFIED #1  // Arrow +2
  ADD_STORE_ITEM BOLT02   LAST #20 #0 #0 IDENTIFIED #1  // Bolt +1
  ADD_STORE_ITEM DART04   LAST #10 #0 #0 IDENTIFIED #1  // Dart of Wounding

  ADD_STORE_ITEM POTN29   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Genius

  ADD_STORE_ITEM SCRL77   LAST #1 #0 #0 IDENTIFIED #1   // Magic Missile
  ADD_STORE_ITEM SCRL90   LAST #1 #0 #0 IDENTIFIED #1   // Invisibilty
  ADD_STORE_ITEM SCRL1H   LAST #1 #0 #0 IDENTIFIED #1   // Haste

  ADD_STORE_ITEM amul07   LAST #0 #0 #0 IDENTIFIED #1   // rainbow obsidian
  ADD_STORE_ITEM ring11   LAST #0 #0 #0 IDENTIFIED #1   // silver
  ADD_STORE_ITEM misc35   LAST #0 #0 #0 IDENTIFIED #1   // horn coral
  ADD_STORE_ITEM misc37   LAST #0 #0 #0 IDENTIFIED #1   // sphene

END BUT_ONLY

/////////////////

// TRTHF02 - Kich
// 
// Trademeet, north gate

// 100% stock overwrite

COPY_EXISTING trthf02.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    DART01    // Dart
    AROW01    // Arrows
    AROW11    // Arrow +2
    BOLT01    // Bolt
    BOLT02    // Bolt +1
    BULL01    // Bullet
    BULL03    // Bullet +2
    SHLD01    // Small Shield
    SHLD03    // Medium Shield
    SHLD08    // Buckler
    SHLD10    // Buckler
    SHLD15    // Large Shield
    SHLD04    // Medium Shield +1
    SHLD28    // Small Shield +2
    PLAT10    // Plate Mail +1
    LEAT02    // Leather Armor +1
    LEAT05    // Studded Leather Armor +1
    CHAN02    // Chain Mail +1
    CHAN05    // Splint Mail +1
    SHLD02    // Small Shield +1
    SHLD04    // Medium Shield +1
    SHLD06    // Large Shield +1
    STAF01    // Quarterstaff
    SW1H22    // Scimitar +1
    SW2H02    // Two Handed Sword +1
    SW1H02    // Bastard Sword +1
    SW1H05    // Long Sword +1
    SW1H08    // Short Sword +1
    SW1H44    // Katana +1
    SPER02    // Spear +1
    BLUN03    // Flail +1
    BLUN05    // Mace +1
    BLUN07    // Morning Star +1
    XBOW02    // Heavy Crossbow +1
    XBOW05    // Light Crossbow +1
    BOW02     // Composite Long Bow +1
    BOW04     // Long Bow +1
    BOW06     // Short Bow +1
    SLNG02    // Sling +1
    AX1H02    // Battle Axe +1
    DAGG02    // Dagger +1
    HALB02    // Halberd +1
    DART02    // Dart +1
    POTN20    // Antidote
    POTN03    // Potion of Hill Giant Strength
    POTN28    // Potion of Fortitude
    POTN19    // Potion of Agility
    SCRL6D    // Find Familiar
    SCRL6E    // Power Word Sleep
    SCRL6F    // Ray of Enfeeblement
    SCRL6G    // Minor Spell Deflection
    SCRL6H    // Protection from Fire
    SCRL6T    // Protection From Normal Weapons
    SCRL6U    // Breach
    SCRL6V    // Lower Resistance
    SCRL6W    // Oracle
    SCRL6X    // Conjure Lesser Fire Elemental
    SCRL7S    // Chain Lightning
    SCRL7T    // Disintegrate
    SCRL7U    // Contingency
    SCRL7V    // Spell Deflection
    BAG02E    // Gem bag
 // these are RR's additions
    BLUN01    // Club
    ~RR#SAP01~  // Sap
    ~RR#BOW03~  // Composite Short Bow +1
    ~RR#BUC02~  // Buckler +1
    ~RR#BUC03~  // Buckler +2

  LPF store INT_VAR
    sell=135
    buy=15
    steal=0
    fence=1
  END

  WRITE_LONG 0xc 39143

  ADD_STORE_ITEM SW1H37   LAST #0 #0 #0 IDENTIFIED #1   // Taragarth +1
  ADD_STORE_ITEM SW1H47   LAST #0 #0 #0 IDENTIFIED #1   // Wakizashi +1
  ADD_STORE_ITEM LEAT11   LAST #0 #0 #0 IDENTIFIED #1   // Leather Armor +2

  ADD_STORE_ITEM BULL02   LAST #20 #0 #0 IDENTIFIED #1  // Bullet +1
  ADD_STORE_ITEM AROW09   LAST #20 #0 #0 IDENTIFIED #1  // Arrows of Ice
  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM BULL06   LAST #10 #0 #0 IDENTIFIED #1  // Bullet of Smiting (Bullet +4)
  END

  PATCH_IF comp_rr_equip=1 BEGIN
    ADD_STORE_ITEM ~RR#SAP01~ LAST #0 #0 #0 IDENTIFIED #1  // sap
  END

  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM wand08   LAST #10 #0 #0 IDENTIFIED #1  // sleep
  END ELSE BEGIN
    ADD_STORE_ITEM wand08   LAST #50 #0 #0 IDENTIFIED #1  // sleep
  END
  ADD_STORE_ITEM SCRL08   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Poison

  ADD_STORE_ITEM ring17   LAST #0 #0 #0 IDENTIFIED #1   // flamedance
  ADD_STORE_ITEM misc21   LAST #0 #0 #0 IDENTIFIED #1   // skydrop
  ADD_STORE_ITEM misc23   LAST #0 #0 #0 IDENTIFIED #1   // jasper
  ADD_STORE_ITEM misc44   LAST #0 #0 #0 IDENTIFIED #1   // king's tears

  ADD_STORE_ITEM POTN28   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Fortitude
  ADD_STORE_ITEM POTN12   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Stone Giant Strength
  ADD_STORE_ITEM POTN26   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Explosions

  ADD_STORE_ITEM SCRL89   LAST #1 #0 #0 IDENTIFIED #1   // Horror
  ADD_STORE_ITEM SCRL1J   LAST #1 #0 #0 IDENTIFIED #1   // Invisibility 10' Radius
  ADD_STORE_ITEM SCRLAQ   LAST #1 #0 #0 IDENTIFIED #1   // Farsight

  ADD_STORE_ITEM SCRL58   LAST #1 #0 #0 IDENTIFIED #1   // free action

END BUT_ONLY

////////////////////
// special stores //
////////////////////

///////////////////////////////

// BMTHIEF - Black Market Thief
// 
// Renal's guildhouse, Rogue Rebalancing gives her a name and updates her stock

// 100% stock overwrite

COPY_EXISTING ar0406.are override PATCH_IF SOURCE_SIZE>0x11c BEGIN // remove Gloves of Pickpocketing from Copper Coronet
  LPF DELETE_AREA_ITEM STR_VAR item_to_delete=brac17 END
END BUT_ONLY

// Adalon gives Ring of Air Control instead of Necaradan's Crossbow
COPY_EXISTING udsilver.dlg override
  DECOMPILE_DLG_TO_D
    REPLACE_TEXTUALLY CASE_INSENSITIVE ~GiveItemCreate("xbow10"~
~GiveItemCreate("ring28"~
  COMPILE_D_TO_DLG

COPY_EXISTING bmthief.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    AX1H01    // Battle Axe
    BLUN02    // Flail
    BLUN06    // Morning Star
    BOW03     // Long Bow
    BOW05     // Short Bow
    DAGG01    // Dagger
    DAGG16    // Poisoned Throwing Dagger
    DART01    // Dart
    SLNG01    // Sling 
    SW1H04    // Long Sword 
    SW1H07    // Short Sword 
    SW1H46    // Wakizashi
    SW2H01    // Two Handed Sword
    XBOW01    // Heavy Crossbow
    AROW01    // Arrows
    BOLT01    // Bolt
    BULL01    // Bullet
    CHAN01    // Chain Mail Armor
    LEAT01    // Leather Armor
    LEAT04    // Studded Leather Armor
    SHLD01    // Small Shield
    SHLD03    // Medium Shield
    SHLD08    // Buckler
    POTN20    // Antidote
    SCRL71    // Blindness
    SCRL72    // Friends
    SCRL73    // Protection From Petrification
    SCRL75    // Identify
    SCRL76    // Infravision
    SCRL87    // Detect Invisibilty
    SCRL89    // Horror
    SCRL90    // Invisibilty
    SCRL91    // Knock
    SCRL92    // Know Alignment
    SCRL1D    // Clairvoyance
    SCRL1E    // Dispel Magic
    SCRL1F    // Flame Arrow
    SCRL1G    // Fireball
    SCRL1H    // Haste
    SCRL1U    // Confusion
    SCRL1Y    // Improved Invisibility
    SCRL1Z    // Minor Globe of Invulnerability
    SCRL2A    // Monster Summoning II
    SCRL1W    // Fireshield (Blue)
    SCRL1X    // Ice Storm
 // these are RR's additions
    STAF01    // Quarterstaff
    STAF02    // Quarterstaff +1
    BLUN01    // Club
    ~RR#SAP01~  // Sap
    BOW04     // Long Bow +1
    BOW06     // Short Bow +1
    ~RR#BOW02~  // Composite Short Bow
    DAGG02    // Dagger +1
    DAGG05    // Throwing Daggers
    DART02    // Darts +1
    SLNG02    // Sling +1
    SW1H05    // Long Sword +1
    SW1H08    // Short Sword +1
    SW1H20    // Scimitar
    SW1H22    // Scimitar +1
    SW1H47    // Wakizashi +1
    SW1H48    // Ninja To
    SW1H49    // Ninja To +1
    SW1H43    // Katana
    SW1H44    // Katana +1
    XBOW02    // Heavy Crossbow +1
    XBOW04    // Light Crossbow
    XBOW05    // Light Crossbow +1
    LEAT02    // Leather Armor +1
    LEAT05    // Studded Leather Armor +1
    LEAT10    // Hide Armor
    SCRL1J    // Invisibility 10' Radius scroll
    SCRLA6    // Spook scroll
    SCRLA7    // Remove Magic scroll

  LPF store INT_VAR
    sell=145
    buy=15
    steal=0
    fence=1
  END

  SAY 0xc @200133 // Shadow Thief Merchant

  ADD_STORE_ITEM SW1H07   LAST #0 #0 #0 IDENTIFIED #1   // Short Sword 
  ADD_STORE_ITEM SW1H46   LAST #0 #0 #0 IDENTIFIED #1   // Wakizashi
  ADD_STORE_ITEM SW1H08   LAST #0 #0 #0 IDENTIFIED #1   // Short Sword +1
  ADD_STORE_ITEM SW1H29   LAST #0 #0 #0 IDENTIFIED #1   // Short Sword +2
  ADD_STORE_ITEM SW1H47   LAST #0 #0 #0 IDENTIFIED #1   // Wakizashi +1
  ADD_STORE_ITEM SW1H49   LAST #0 #0 #0 IDENTIFIED #1   // Ninja-To +1
  ADD_STORE_ITEM SHLD17   LAST #0 #0 #0 IDENTIFIED #1   // Buckler +1
  ADD_STORE_ITEM DAGG05   LAST #10 #0 #0 IDENTIFIED #10 // Throwing Dagger
  ADD_STORE_ITEM DAGG16   LAST #10 #0 #0 IDENTIFIED #10 // Poisoned Throwing Dagger
  ADD_STORE_ITEM DART01   LAST #40 #0 #0 IDENTIFIED #10 // Dart
  ADD_STORE_ITEM DART02   LAST #20 #0 #0 IDENTIFIED #5  // Dart +1
  ADD_STORE_ITEM BOLT01   LAST #40 #0 #0 IDENTIFIED #10 // Bolt
  ADD_STORE_ITEM BOLT02   LAST #40 #0 #0 IDENTIFIED #2  // Bolt +1
  ADD_STORE_ITEM BOLT06   LAST #20 #0 #0 IDENTIFIED #2  // Bolt +2
  ADD_STORE_ITEM BOLT04   LAST #10 #0 #0 IDENTIFIED #2  // Bolt of Biting 
  ADD_STORE_ITEM XBOW04   LAST #0 #0 #0 IDENTIFIED #3   // Light Crossbow
  ADD_STORE_ITEM XBOW05   LAST #0 #0 #0 IDENTIFIED #1   // Light Crossbow +1

  ADD_STORE_ITEM misc41   LAST #0 #0 #0 IDENTIFIED #1   // star sapphire
  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM wand10   LAST #10 #0 #0 IDENTIFIED #1  // monster
  END ELSE BEGIN
    ADD_STORE_ITEM wand10   LAST #50 #0 #0 IDENTIFIED #1  // monster
  END

  ADD_STORE_ITEM POTN19   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Agility
  ADD_STORE_ITEM POTN13   LAST #1 #0 #0 IDENTIFIED #1   // Oil of Fiery Burning
  ADD_STORE_ITEM POTN36   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Master Thievery
  ADD_STORE_ITEM POTN10   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Invisibility
  ADD_STORE_ITEM POTN30   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Infravision
  ADD_STORE_ITEM POTN39   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Perception

  ADD_STORE_ITEM SCRL98   LAST #1 #0 #0 IDENTIFIED #1   // Strength
  ADD_STORE_ITEM SCRL1D   LAST #1 #0 #0 IDENTIFIED #1   // Clairvoyance
  ADD_STORE_ITEM SCRL1I   LAST #1 #0 #0 IDENTIFIED #1   // Hold Person
  ADD_STORE_ITEM SCRL5J   LAST #1 #0 #0 IDENTIFIED #1   // Oliluke's Resilient Sphere

  ADD_STORE_ITEM brac17   LAST #0 #0 #0 IDENTIFIED #1   // gloves of rogue
  ADD_STORE_ITEM xbow10   LAST #0 #0 #0 IDENTIFIED #1   // Necaradan's Crossbow

  PATCH_IF comp_rr_equip=1 BEGIN
    ADD_STORE_ITEM ~RR#SAP01~ LAST #0 #0 #0 IDENTIFIED #6  // sap
  END

END BUT_ONLY

/////////////////////

// SHTHSTOR - Rattell
// 
// thief stronghold 'bartender'

// 100% stock overwrite

COPY_EXISTING shthstor.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    AX1H01    // Battle Axe
    BLUN02    // Flail
    BLUN06    // Morning Star
    BOW03     // Long Bow
    BOW05     // Short Bow
    DAGG01    // Dagger
    DAGG16    // Poisoned Throwing Dagger
    DART01    // Dart
    SLNG01    // Sling 
    SW1H04    // Long Sword 
    SW1H07    // Short Sword 
    SW1H46    // Wakizashi
    SW2H01    // Two Handed Sword
    XBOW01    // Heavy Crossbow
    AROW01    // Arrows
    BOLT01    // Bolt
    BULL01    // Bullet
    CHAN01    // Chain Mail Armor
    LEAT01    // Leather Armor
    LEAT04    // Studded Leather Armor
    SHLD01    // Small Shield
    SHLD03    // Medium Shield
    SHLD08    // Buckler
    POTN20    // Antidote
    SCRL77    // Magic Missile
    SCRL78    // Protection From Evil
    SCRL79    // Shield
    SCRL80    // Shocking Grasp
    SCRL81    // Sleep
    SCRL93    // Luck
    SCRL94    // Resist Fear
    SCRL95    // Melf's Acid Arrow
    SCRL96    // Mirror Image
    SCRL97    // Stinking Cloud
    SCRL1I    // Hold Person
    SCRL1K    // Lightning Bolt
    SCRL1L    // Monster Summoning I
    SCRL1M    // Non-Detection
    SCRL1N    // Protection From Normal Missiles
    SCRL2B    // Stoneskin
    SCRL2D    // Animate Dead
    SCRL2E    // Cloudkill
    SCRL2F    // Cone of Cold
    SCRL2G    // Monster Summoning III
    SCRL2H    // Shadow Door
    SCRL1J    // Invisibility 10' Radius
    RESTORE   // Restoration
 // these are RR's additions
    BLUN01    // Club
    ~RR#SAP01~  // Sap
    ~RR#BOW02~  // Composite Short Bow

  LPF store INT_VAR
    sell=145
    buy=20
    steal=0
    fence=1
  END

  ADD_STORE_ITEM AROW02   LAST #40 #0 #0 IDENTIFIED #5  // Arrows +1
  ADD_STORE_ITEM AROW11   LAST #20 #0 #0 IDENTIFIED #5  // Arrow +2
  ADD_STORE_ITEM BOLT02   LAST #40 #0 #0 IDENTIFIED #5  // Bolt +1
  ADD_STORE_ITEM BOLT06   LAST #20 #0 #0 IDENTIFIED #5  // Bolt +2
  PATCH_IF comp_nodispel=0 BEGIN
    ADD_STORE_ITEM AROW07   LAST #5 #0 #0 IDENTIFIED #2   // Arrows of Dispelling
  END
  ADD_STORE_ITEM arow06   LAST #5 #0 #0 IDENTIFIED #1   // arrow of detonation

  ADD_STORE_ITEM BAG02E   LAST #0 #0 #0 IDENTIFIED #1   // Gem bag

  ADD_STORE_ITEM SCRL09   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Undead
  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM wand06   LAST #10 #0 #0 IDENTIFIED #1  // frost
  END ELSE BEGIN
    ADD_STORE_ITEM wand06   LAST #50 #0 #0 IDENTIFIED #1  // frost
  END

  ADD_STORE_ITEM amul11   LAST #0 #0 #0 IDENTIFIED #1   // pearl
  ADD_STORE_ITEM amul12   LAST #0 #0 #0 IDENTIFIED #1   // laeral's tear
  ADD_STORE_ITEM ring06   LAST #0 #0 #0 IDENTIFIED #1   // of protection +1
  ADD_STORE_ITEM misc36   LAST #0 #0 #0 IDENTIFIED #1   // pearl
  ADD_STORE_ITEM misc41   LAST #0 #0 #0 IDENTIFIED #1   // star sapphire
  ADD_STORE_ITEM misc42   LAST #0 #0 #0 IDENTIFIED #1   // diamond
  ADD_STORE_ITEM misc43   LAST #0 #0 #0 IDENTIFIED #1   // emerald
  ADD_STORE_ITEM misc44   LAST #0 #0 #0 IDENTIFIED #1   // king's tears
  ADD_STORE_ITEM misc45   LAST #0 #0 #0 IDENTIFIED #1   // rogue stone

  ADD_STORE_ITEM DAGG15   LAST #0 #0 #0 IDENTIFIED #1   // Dagger +2
  ADD_STORE_ITEM LEAT05   LAST #0 #0 #0 IDENTIFIED #1   // Studded Leather Armor +1
  ADD_STORE_ITEM LEAT07   LAST #0 #0 #0 IDENTIFIED #1   // Studded Leather Armor +2
  ADD_STORE_ITEM SHLD17   LAST #0 #0 #0 IDENTIFIED #1   // Buckler +1
  ADD_STORE_ITEM SHLD28   LAST #0 #0 #0 IDENTIFIED #1   // Small Shield +2
  ADD_STORE_ITEM BOW06    LAST #0 #0 #0 IDENTIFIED #1   // Short Bow +1

  PATCH_IF comp_rr_equip=1 BEGIN
    ADD_STORE_ITEM ~RR#SAP01~ LAST #0 #0 #0 IDENTIFIED #4  // sap
    ADD_STORE_ITEM ~RR#BOW04~ LAST #0 #0 #0 IDENTIFIED #1  // Composite Short Bow +2
  END

  ADD_STORE_ITEM POTN19   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Agility
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Extra Healing
  ADD_STORE_ITEM POTN17   LAST #1 #0 #0 IDENTIFIED #1   // Elixir of Health
  ADD_STORE_ITEM POTN14   LAST #1 #0 #0 IDENTIFIED #1   // Oil of Speed
  ADD_STORE_ITEM POTN36   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Master Thievery
  ADD_STORE_ITEM POTN10   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Invisibility
  ADD_STORE_ITEM POTN45   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Freedom
  ADD_STORE_ITEM POTN30   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Infravision
  ADD_STORE_ITEM POTN39   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Perception

  ADD_STORE_ITEM SCRL71   LAST #1 #0 #0 IDENTIFIED #3   // Blindness
  ADD_STORE_ITEM SCRL69   LAST #1 #0 #0 IDENTIFIED #3   // Charm Person
  ADD_STORE_ITEM SCRL66   LAST #1 #0 #0 IDENTIFIED #3   // Grease
  ADD_STORE_ITEM SCRL72   LAST #1 #0 #0 IDENTIFIED #3   // Friends
  ADD_STORE_ITEM SCRL75   LAST #1 #0 #0 IDENTIFIED #3   // Identify

  ADD_STORE_ITEM SCRL90   LAST #1 #0 #0 IDENTIFIED #2   // Invisibilty
  ADD_STORE_ITEM SCRL91   LAST #1 #0 #0 IDENTIFIED #2   // Knock
  ADD_STORE_ITEM SCRL93   LAST #1 #0 #0 IDENTIFIED #2   // Luck

  ADD_STORE_ITEM SCRL1D   LAST #1 #0 #0 IDENTIFIED #1   // Clairvoyance
  ADD_STORE_ITEM SCRL6K   LAST #1 #0 #0 IDENTIFIED #1   // Detect Illusion
  ADD_STORE_ITEM SCRL1H   LAST #1 #0 #0 IDENTIFIED #1   // Haste
  ADD_STORE_ITEM SCRL1I   LAST #1 #0 #0 IDENTIFIED #1   // Hold Person
  ADD_STORE_ITEM SCRL1J   LAST #1 #0 #0 IDENTIFIED #1   // Invisibility 10' Radius
  ADD_STORE_ITEM SCRL1M   LAST #1 #0 #0 IDENTIFIED #1   // Non-Detection
  ADD_STORE_ITEM SCRL1P   LAST #1 #0 #0 IDENTIFIED #1   // Skull Trap
  ADD_STORE_ITEM SCRL1O   LAST #1 #0 #0 IDENTIFIED #1   // Slow

  ADD_STORE_ITEM SCRLAQ   LAST #1 #0 #0 IDENTIFIED #1   // Farsight
  ADD_STORE_ITEM SCRL1Y   LAST #1 #0 #0 IDENTIFIED #1   // Improved Invisibility
  ADD_STORE_ITEM SCRLA1   LAST #1 #0 #0 IDENTIFIED #1   // Wizard Eye

  ADD_STORE_ITEM SCRL58   LAST #1 #0 #0 IDENTIFIED #1   // free action
  ADD_STORE_ITEM SCRL5F   LAST #1 #0 #0 IDENTIFIED #1   // chaotic commands
  ADD_STORE_ITEM SCRL61   LAST #1 #0 #0 IDENTIFIED #1   // cure critical wounds

  PATCH_IF comp_ir=1 && comp_rr_equip=0 BEGIN
    ADD_STORE_ITEM dagg04 LAST #0 #0 #0 IDENTIFIED #1   // longtooth +2
  END

END BUT_ONLY

//////////////////////

// SCROLLS - Lady Yuth
// 
// we kick her out of Adenturer's Mart, where spell scrolls are now sold legally by Deidre
// Temple District looks a suitable place for a noblewoman to frequent, she'll conduct her illegalities there

// 100% stock overwrite

COPY_EXISTING ar0702.are override PATCH_IF SOURCE_SIZE>0x11c BEGIN
  GET_OFFSET_ARRAY actor 0x54 4 0x58 2 0 0 0x110
  PHP_EACH actor AS ind => res BEGIN
    READ_ASCII res+0x80 actor (8) NULL
    PATCH_IF ~%actor%~ STRING_EQUAL_CASE scroll01 BEGIN
      index=ind
    END
  END
  LPF fj_are_structure
    INT_VAR fj_delete_mode = index
    STR_VAR fj_structure_type = actor
  END
END

COPY_EXISTING ar0900.are override PATCH_IF SOURCE_SIZE>0x11c BEGIN
  WRITE_SHORT 0x58 SHORT_AT 0x58+1
  offset=LONG_AT 0x54
  INSERT_BYTES offset 0x110
  WRITE_ASCII offset+0x80 scroll01 (8)
  WRITE_SHORT offset+0x20 3527
  WRITE_SHORT offset+0x22 1843 // near Lathander's, under the tree
  WRITE_SHORT offset+0x24 3527
  WRITE_SHORT offset+0x26 1843
  WRITE_BYTE  offset+0x28 1
  WRITE_LONG  offset+0x30 0xca10
  WRITE_LONG  offset+0x34 3
  WRITE_LONG  offset+0x38 `0
  WRITE_LONG  offset+0x40 0b00000000000000111100000011000000
  PATCH_FOR_EACH off IN 0x5c  0x60  0x68  0x70  0x78  0x84  0x88  0xa8  0xb8  0x7c  0xa0  0xb0  0xbc  0xc0  0xc4  0xcc BEGIN
    PATCH_IF LONG_AT off>=offset BEGIN
      WRITE_LONG off LONG_AT off+0x110
    END
  END
END

COPY_EXISTING scroll01.dlg override
  DECOMPILE_DLG_TO_D
    REPLACE_TEXTUALLY CASE_INSENSITIVE ~"YuthTalk","AR0702"~ ~"YuthTalk","AR0900"~
  COMPILE_D_TO_DLG
BUT_ONLY

STRING_SET 46479 @200101
STRING_SET 46481 @200102
STRING_SET 46520 @200103

COPY_EXISTING scrolls.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR magic=1 END
  REMOVE_STORE_ITEM 
    SCRL03    // Protection from Acid
    SCRL04    // Protection from Cold
    SCRL05    // Protection from Electricity
    SCRL06    // Protection from Fire
    SCRL08    // Protection from Poison
    SCRL09    // Protection from Undead
    SCRL66    // Grease
    SCRL67    // Armor
    SCRL68    // Burning Hands
    SCRL70    // Color Spray
    SCRL71    // Blindness
    SCRL72    // Friends
    SCRL76    // Infravision
    SCRL78    // Protection From Evil
    SCRL80    // Shocking Grasp
    SCRL82    // Chill Touch
    SCRL84    // Larloch's Minor Drain
    SCRL85    // Blur
    SCRL86    // Detect Evil
    SCRL87    // Detect Invisibilty
    SCRL89    // Horror
    SCRL90    // Invisibilty
    SCRL91    // Knock
    SCRL92    // Know Alignment
    SCRL93    // Luck
    SCRL94    // Resist Fear
    SCRL95    // Melf's Acid Arrow
    SCRL96    // Mirror Image
    SCRL97    // Stinking Cloud
    SCRL98    // Strength
    SCRL99    // Web
    SCRL1B    // Agannazar's Scorcher
    SCRL1C    // Ghoul Touch
    SCRL1D    // Clairvoyance
    SCRL1E    // Dispel Magic
    SCRL1F    // Flame Arrow
    SCRL1G    // Fireball
    SCRL1H    // Haste
    SCRL1I    // Hold Person
    SCRL1L    // Monster Summoning I
    SCRL1N    // Protection From Normal Missiles
    SCRL1O    // Slow
    SCRL1P    // Skull Trap
    SCRL1Q    // Vampiric Touch
    SCRL1T    // Ghost Armor
    SCRL1U    // Confusion
    SCRL1Y    // Improved Invisibility
    SCRL1Z    // Minor Globe of Invulnerability
    SCRLA4    // Limited Wish
    SCRLA5    // Melf's Minute Meteor
    SCRL75    // Identify
    SCRL3G    // Vocalize
    SCRL5H    // Emotion
    SCRL2B    // Stoneskin
    SCRL6T    // Protection From Normal Weapons
    SCRLA1    // Wizard Eye
    SCRL6V    // Lower Resistance
    SCRLA2    // Deafness
    SCRLA3    // Glitterdust
    RESTORE   // Restoration
    BAG03B    // Scroll Case
    SCRLAI    // Ray of Enfeeblement
    SCRLAJ    // Farsight
    SCRLAK    // Remove Curse
    SCRLAL    // Sunfire
    SCRLAM    // Symbol Death
    SCRLAN    // Symbol Stun

    // Spell Revisions
    scrl1v    // dimension door
    scrlw801  // ghost form

  LPF store INT_VAR
    sell=165
    buy=25
    steal=0
    fence=1
  END

  WRITE_LONG 0xc 46469

  ADD_STORE_ITEM BAG03B   LAST #0 #0 #0 IDENTIFIED #1   // Scroll Case

  ADD_STORE_ITEM SCRL67   LAST #1 #0 #0 IDENTIFIED #2   // Armor
  ADD_STORE_ITEM SCRL71   LAST #1 #0 #0 IDENTIFIED #2   // Blindness
  ADD_STORE_ITEM SCRL68   LAST #1 #0 #0 IDENTIFIED #2   // Burning Hands
  ADD_STORE_ITEM SCRL82   LAST #1 #0 #0 IDENTIFIED #2   // Chill Touch
  ADD_STORE_ITEM SCRL70   LAST #1 #0 #0 IDENTIFIED #2   // Color Spray
  ADD_STORE_ITEM SCRL72   LAST #1 #0 #0 IDENTIFIED #2   // Friends
  ADD_STORE_ITEM SCRL66   LAST #1 #0 #0 IDENTIFIED #2   // Grease
  ADD_STORE_ITEM SCRL75   LAST #1 #0 #0 IDENTIFIED #2   // Identify
  ADD_STORE_ITEM SCRL76   LAST #1 #0 #0 IDENTIFIED #2   // Infravision
  ADD_STORE_ITEM SCRL78   LAST #1 #0 #0 IDENTIFIED #2   // Protection From Evil
  ADD_STORE_ITEM SCRL80   LAST #1 #0 #0 IDENTIFIED #2   // Shocking Grasp
  ADD_STORE_ITEM SCRL84   LAST #1 #0 #0 IDENTIFIED #2   // Larloch's Minor Drain

  ADD_STORE_ITEM SCRL1B   LAST #1 #0 #0 IDENTIFIED #2   // Agannazar's Scorcher
  ADD_STORE_ITEM SCRL85   LAST #1 #0 #0 IDENTIFIED #2   // Blur
  ADD_STORE_ITEM SCRL86   LAST #1 #0 #0 IDENTIFIED #2   // Detect Evil
  ADD_STORE_ITEM SCRL87   LAST #1 #0 #0 IDENTIFIED #2   // Detect Invisibilty
  ADD_STORE_ITEM SCRL91   LAST #1 #0 #0 IDENTIFIED #2   // Knock
  ADD_STORE_ITEM SCRL92   LAST #1 #0 #0 IDENTIFIED #2   // Know Alignment
  ADD_STORE_ITEM SCRL95   LAST #1 #0 #0 IDENTIFIED #2   // Melf's Acid Arrow
  ADD_STORE_ITEM SCRL6F   LAST #1 #0 #0 IDENTIFIED #2   // Ray of Enfeeblement
  ADD_STORE_ITEM SCRL94   LAST #1 #0 #0 IDENTIFIED #2   // Resist Fear
  ADD_STORE_ITEM SCRL98   LAST #1 #0 #0 IDENTIFIED #2   // Strength

  ADD_STORE_ITEM SCRL1D   LAST #1 #0 #0 IDENTIFIED #1   // Clairvoyance
  ADD_STORE_ITEM SCRL1E   LAST #1 #0 #0 IDENTIFIED #1   // Dispel Magic
  ADD_STORE_ITEM SCRL1T   LAST #1 #0 #0 IDENTIFIED #1   // Ghost Armor
  ADD_STORE_ITEM SCRL1I   LAST #1 #0 #0 IDENTIFIED #1   // Hold Person
  ADD_STORE_ITEM SCRL1N   LAST #1 #0 #0 IDENTIFIED #1   // Protection From Normal Missiles
  ADD_STORE_ITEM SCRL1O   LAST #1 #0 #0 IDENTIFIED #1   // Slow
  ADD_STORE_ITEM SCRL1P   LAST #1 #0 #0 IDENTIFIED #1   // Skull Trap

  ADD_STORE_ITEM SCRL1U   LAST #1 #0 #0 IDENTIFIED #1   // Confusion
  ADD_STORE_ITEM SCRL5H   LAST #1 #0 #0 IDENTIFIED #1   // Emotion
  ADD_STORE_ITEM SCRLAQ   LAST #1 #0 #0 IDENTIFIED #1   // Farsight
  ADD_STORE_ITEM SCRL5G   LAST #1 #0 #0 IDENTIFIED #1   // Remove Curse
  ADD_STORE_ITEM SCRLA1   LAST #1 #0 #0 IDENTIFIED #1   // Wizard Eye

  ADD_STORE_ITEM SCRL6T   LAST #1 #0 #0 IDENTIFIED #1   // Protection From Normal Weapons
  ADD_STORE_ITEM SCRL6V   LAST #1 #0 #0 IDENTIFIED #1   // Lower Resistance
  ADD_STORE_ITEM SCRLAR   LAST #1 #0 #0 IDENTIFIED #1   // Sunfire

END BUT_ONLY

/////////////////////

// BERNARD2 - Bernard
// 
// Bernard's special stock

// 100% stock overwrite

COPY_EXISTING kalah2.cre override LPF FJ_CRE_VALIDITY RET valid=valid END PATCH_IF valid BEGIN // rob Kalah of his Girdle of Piercing
  REMOVE_CRE_ITEM belt04
END BUT_ONLY

COPY_EXISTING bernard2.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    AMUL10    // Gold Necklace
    AMUL13    // Bloodstone Amulet
    SHLD03    // Medium Shield
    SHLD08    // Buckler
    SHLD09    // Buckler
    SHLD11    // Small Shield
    SHLD12    // Small Shield
    SHLD14    // Medium Shield
    SHLD15    // Large Shield
    SHLD16    // Large Shield
    SHLD02    // Small Shield +1
    DAGG01    // Dagger
    DAGG05    // Throwing Dagger
    DAGG02    // Dagger +1
    AX1H01    // Battle Axe
    SW1H01    // Bastard Sword 
    SW1H04    // Long Sword 
    SW1H05    // Long Sword +1
    SW1H07    // Short Sword 
    SW1H08    // Short Sword +1
    SW1H20    // Scimitar
    SW1H43    // Katana
    SW1H40    // Blade of Roses +3
    SW1H46    // Wakizashi
    SW1H48    // Ninja-To
    SW2H01    // Two Handed Sword
    LEAT01    // Leather Armor
    LEAT04    // Studded Leather Armor
    CHAN04    // Splint Mail
    CHAN01    // Chain Mail Armor
    STAF01    // Quarterstaff
    HAMM01    // War Hammer
    SPER01    // Spear
    BLUN01    // Club
    BLUN02    // Flail
    BLUN04    // Mace
    BLUN19    // Mauler's Arm +2
    BLUN16    // The Sleeper +2
    BLUN06    // Morning Star
    XBOW01    // Heavy Crossbow
    XBOW04    // Light Crossbow
    XBOW06    // Light Crossbow of Speed 
    BOW01     // Composite Long Bow
    BOW03     // Long Bow
    BOW05     // Short Bow
    SLNG01    // Sling 
    SLNG07    // Sling of Seeking +2
    AX1H01    // Battle Axe
    AX1H04    // Throwing Axe
    AX1H12    // Battle Axe +3, Stonefire
    AX1H10    // Azuredge
    DAGG01    // Dagger
    HALB01    // Halberd
    DART01    // Dart
    AROW01    // Arrows
    BOLT01    // Bolt
    BULL01    // Bullet
    POTN08    // Potion of Healing
    POTN09    // Potion of Heroism
    POTN30    // Potion of Infravision
    POTN44    // Potion of Strength
    SCRL66    // Grease
    SCRL67    // Armor
    SCRL68    // Burning Hands
    SCRL69    // Charm Person
    SCRL70    // Color Spray
    SCRL71    // Blindness
    SCRL82    // Chill Touch
    SCRL83    // Chromatic Orb
    SCRL84    // Larloch's Minor Drain
    SCRL85    // Blur
    SCRL86    // Detect Evil
    SCRL98    // Strength
    SCRL99    // Web
    SCRL1B    // Agannazar's Scorcher
    SCRL1C    // Ghoul Touch
    SCRL3G    // Vocalize
    SCRL1N    // Protection From Normal Missiles
    SCRL1O    // Slow
    SCRL1P    // Skull Trap
    SCRL1Q    // Vampiric Touch
    SCRL1S    // Dire Charm
    SCRL1T    // Ghost Armor
    AROW08    // Arrow of Fire
    AROW04    // Acid Arrows
    RESTORE   // Restoration
    SW1H53    // Sword of Flame +1
    SCRL7S    // Chain Lightning
    SCRL8D    // Spell Turning
    SCRL8I    // Cacofiend
    SCRL8L    // Spell Sequencer
    SCRL8P    // Prismatic Spray
    SCRL9E    // Incendiary Cloud
    SCRL9B    // Summon Fiend
    SCRL8Z    // Simulacrum
    SCRL8S    // Summon Efreet
 // these are RR's additions
    ~RR#BOW02~  // Composite Short Bow
    ~RR#BUC02~  // Buckler +1

  LPF store INT_VAR
    sell=155
    buy=25
    steal=0
    fence=0
  END

  ADD_STORE_ITEM AROW02   LAST #40 #0 #0 IDENTIFIED #2  // Arrows +1
  ADD_STORE_ITEM AROW11   LAST #20 #0 #0 IDENTIFIED #2  // Arrow +2
  ADD_STORE_ITEM BOLT02   LAST #40 #0 #0 IDENTIFIED #2  // Bolt +1
  ADD_STORE_ITEM BOLT06   LAST #20 #0 #0 IDENTIFIED #2  // Bolt +2
  ADD_STORE_ITEM BULL02   LAST #40 #0 #0 IDENTIFIED #2  // Bullet +1
  ADD_STORE_ITEM BULL03   LAST #20 #0 #0 IDENTIFIED #2  // Bullet +2
  ADD_STORE_ITEM DART02   LAST #40 #0 #0 IDENTIFIED #2  // Dart +1
  ADD_STORE_ITEM AROW08   LAST #20 #0 #0 IDENTIFIED #1  // Arrow of Fire
  ADD_STORE_ITEM AROW09   LAST #20 #0 #0 IDENTIFIED #1  // Arrows of Ice
  ADD_STORE_ITEM AROW04   LAST #10 #0 #0 IDENTIFIED #1  // Acid Arrows
  ADD_STORE_ITEM AROW11   LAST #10 #0 #0 IDENTIFIED #1  // Bolt of Biting 
  ADD_STORE_ITEM BOLT03   LAST #10 #0 #0 IDENTIFIED #1  // Bolt of Lightning
  ADD_STORE_ITEM DART03   LAST #10 #0 #0 IDENTIFIED #1  // Dart of Stunning
  ADD_STORE_ITEM DART04   LAST #10 #0 #0 IDENTIFIED #1  // Dart of Wounding

  ADD_STORE_ITEM SHLD02   LAST #0 #0 #0 IDENTIFIED #1   // Small Shield +1
  ADD_STORE_ITEM DAGG02   LAST #0 #0 #0 IDENTIFIED #1   // Dagger +1
  ADD_STORE_ITEM SW1H05   LAST #0 #0 #0 IDENTIFIED #1   // Long Sword +1
  ADD_STORE_ITEM SW1H08   LAST #0 #0 #0 IDENTIFIED #1   // Short Sword +1
  ADD_STORE_ITEM PLAT04   LAST #0 #0 #0 IDENTIFIED #1   // Full Plate Mail
  ADD_STORE_ITEM SHLD06   LAST #0 #0 #0 IDENTIFIED #1   // Large Shield +1

  PATCH_IF comp_rr_equip=1 BEGIN
    ADD_STORE_ITEM ~RR#BOW02~ LAST #0 #0 #0 IDENTIFIED #1  // Composite Short Bow
  END

  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM wand03   LAST #10 #0 #0 IDENTIFIED #1  // mm
  END ELSE BEGIN
    ADD_STORE_ITEM wand03   LAST #50 #0 #0 IDENTIFIED #1  // mm
  END
  ADD_STORE_ITEM belt04   LAST #0 #0 #0 IDENTIFIED #1   // girdle of piercing

  ADD_STORE_ITEM BLUN19   LAST #0 #0 #0 IDENTIFIED #1   // Mauler's Arm +2
  ADD_STORE_ITEM BLUN16   LAST #0 #0 #0 IDENTIFIED #1   // The Sleeper +2
  ADD_STORE_ITEM SW1H53   LAST #0 #0 #0 IDENTIFIED #1   // Sword of Flame +1
  ADD_STORE_ITEM XBOW06   LAST #0 #0 #0 IDENTIFIED #1   // Light Crossbow of Speed 
  ADD_STORE_ITEM SLNG07   LAST #0 #0 #0 IDENTIFIED #1   // Sling of Seeking +2
  ADD_STORE_ITEM AX1H12   LAST #0 #0 #0 IDENTIFIED #1   // Battle Axe +3, Stonefire
  ADD_STORE_ITEM SW1H40   LAST #0 #0 #0 IDENTIFIED #1   // Blade of Roses +3

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #15  // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Extra Healing
  ADD_STORE_ITEM POTN43   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Insight 
  ADD_STORE_ITEM POTN37   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Mind Focusing
  ADD_STORE_ITEM POTN09   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Heroism
  ADD_STORE_ITEM POTN24   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Defense
  ADD_STORE_ITEM POTN42   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Regeneration 
  ADD_STORE_ITEM POTN05   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Fire Giant Strength

  ADD_STORE_ITEM SCRL1E   LAST #1 #0 #0 IDENTIFIED #1   // Dispel Magic
  ADD_STORE_ITEM SCRL1G   LAST #1 #0 #0 IDENTIFIED #1   // Fireball
  ADD_STORE_ITEM SCRL1O   LAST #1 #0 #0 IDENTIFIED #1   // Slow
  ADD_STORE_ITEM SCRL1X   LAST #1 #0 #0 IDENTIFIED #1   // Ice Storm
  ADD_STORE_ITEM SCRL2G   LAST #1 #0 #0 IDENTIFIED #1   // Monster Summoning III
  ADD_STORE_ITEM SCRL8C   LAST #1 #0 #0 IDENTIFIED #1   // Stone to Flesh

  ADD_STORE_ITEM misc36   LAST #0 #0 #0 IDENTIFIED #1   // pearl

END BUT_ONLY

///////////////////////////////////////

// PPSTOR01 - Merchant       
// 
// the merchant from extortion encounter at Gates, he was a duplicate of Brynnlaw's storekeep
// he may need something else beside ammo. hmm...

// 100% stock overwrite

COPY_EXISTING aemerch.dlg override
  DECOMPILE_DLG_TO_D
    REPLACE_EVALUATE CASE_INSENSITIVE ~StartStore("\([0-9a-zA-Z]+\)"~ BEGIN
      PATCH_IF ~%MATCH1%~ STRING_EQUAL_CASE ppstor01 BEGIN // if it is not fixed, then
        SPRINT extortion_store cdaemerc                    // use Fixpack's resource
      END ELSE BEGIN
        SPRINT extortion_store ~%MATCH1%~                  // otherwise leave it intact
      END
    END ~StartStore("%extortion_store%"~
  COMPILE_D_TO_DLG
BUT_ONLY

COPY_EXISTING ppstor01.sto ~override/%extortion_store%.sto~ PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 potn=1 jewel=1 misc=1 END

  // new store, wipe everything
  DELETE_BYTES LONG_AT 0x34 LONG_AT 0x38*0x1c
  PATCH_FOR_EACH off IN 0x2c 0x4c 0x70 BEGIN
    PATCH_IF LONG_AT off>=LONG_AT 0x34 BEGIN
      WRITE_LONG off (LONG_AT off - LONG_AT 0x38*0x1c)
    END
  END
  WRITE_LONG 0x38 0

  LPF store INT_VAR
    sell=120
    buy=25
    steal=0
    fence=0
  END

  ADD_STORE_ITEM AROW02   LAST #40 #0 #0 IDENTIFIED #2  // Arrows +1
  ADD_STORE_ITEM AROW11   LAST #20 #0 #0 IDENTIFIED #1  // Arrow +2
  ADD_STORE_ITEM BOLT02   LAST #40 #0 #0 IDENTIFIED #2  // Bolt +1
  ADD_STORE_ITEM BOLT06   LAST #20 #0 #0 IDENTIFIED #1  // Bolt +2
  ADD_STORE_ITEM BULL02   LAST #40 #0 #0 IDENTIFIED #2  // Bullet +1
  ADD_STORE_ITEM BULL03   LAST #20 #0 #0 IDENTIFIED #1  // Bullet +2

  ADD_STORE_ITEM AROW04   LAST #10 #0 #0 IDENTIFIED #1  // Acid Arrows
  ADD_STORE_ITEM AROW08   LAST #20 #0 #0 IDENTIFIED #1  // Arrow of Fire
  ADD_STORE_ITEM AROW09   LAST #20 #0 #0 IDENTIFIED #1  // Arrows of Ice
  ADD_STORE_ITEM AROW10   LAST #10 #0 #0 IDENTIFIED #1  // Arrows of Piercing

  ADD_STORE_ITEM BOLT03   LAST #20 #0 #0 IDENTIFIED #1  // Bolt of Lightning
  ADD_STORE_ITEM BULL04   LAST #10 #0 #0 IDENTIFIED #1  // Sunstone Bullet

  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM BOLT08   LAST #10 #0 #0 IDENTIFIED #1  // Blessed Bolt
  END

END BUT_ONLY

/////////////////////////

// TRGENI01 - Khan Zahraa
// 
// Trademeet's genie

// 100% stock overwrite

COPY_EXISTING trgeni01.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    AROW01    // Arrows
    AROW11    // Arrow +2
    AROW10    // Arrows of Piercing
    AROW04    // Acid Arrows
    BOLT01    // Bolt
    BOLT04    // Bolt of Biting 
    BOLT03    // Bolt of Lightning
    BULL01    // Bullet
    BULL03    // Bullet +2
    AMUL14    // Amulet of Protection +1
    WAND06    // Wand of Frost
    POTN14    // Oil of Speed
    POTN19    // Potion of Agility
    POTN20    // Antidote
    POTN18    // Potion of Absorbtion 
    POTN52    // Potion of Extra Healing
    POTN39    // Potion of Perception
    POTN36    // Potion of Master Thievery
    POTN05    // Potion of Fire Giant Strength
    SCRL05    // Protection from Electricity
    SCRL1Y    // Improved Invisibility
    SCRL1M    // Non-Detection
    CHAN01    // Chain Mail Armor
    CHAN02    // Chain Mail +1
    CHAN05    // Splint Mail +1
    SHLD04    // Medium Shield +1
    STAF02    // Quarterstaff +1
    SW1H08    // Short Sword +1
    SW1H22    // Scimitar +1
    SW1H44    // Katana +1
    SW2H02    // Two Handed Sword +1
    SPER02    // Spear +1
    BLUN03    // Flail +1
    BLUN05    // Mace +1
    BLUN07    // Morning Star +1
    XBOW02    // Heavy Crossbow +1
    XBOW05    // Light Crossbow +1
    BOW02     // Composite Long Bow +1
    BOW04     // Long Bow +1
    BOW06     // Short Bow +1
    SLNG02    // Sling +1
    AX1H02    // Battle Axe +1
    DAGG02    // Dagger +1
    HALB02    // Halberd +1
    DART02    // Dart +1
    CLCK14    // Adventurer's Robe
 // these are RR's additions
    ~RR#BOW03~  // Composite Short Bow +1

  LPF store INT_VAR
    sell=180
    buy=25
    steal=0
    fence=0
  END

  ADD_STORE_ITEM CHAN01   LAST #0 #0 #0 IDENTIFIED #1   // Chain Mail Armor
  ADD_STORE_ITEM CHAN02   LAST #0 #0 #0 IDENTIFIED #1   // Chain Mail +1
  ADD_STORE_ITEM CHAN05   LAST #0 #0 #0 IDENTIFIED #1   // Splint Mail +1
  ADD_STORE_ITEM SHLD04   LAST #0 #0 #0 IDENTIFIED #1   // Medium Shield +1
  ADD_STORE_ITEM STAF02   LAST #0 #0 #0 IDENTIFIED #1   // Quarterstaff +1
  ADD_STORE_ITEM SW1H08   LAST #0 #0 #0 IDENTIFIED #1   // Short Sword +1
  ADD_STORE_ITEM SW1H22   LAST #0 #0 #0 IDENTIFIED #1   // Scimitar +1
  ADD_STORE_ITEM SW1H44   LAST #0 #0 #0 IDENTIFIED #1   // Katana +1
  ADD_STORE_ITEM SW2H02   LAST #0 #0 #0 IDENTIFIED #1   // Two Handed Sword +1
  ADD_STORE_ITEM SPER02   LAST #0 #0 #0 IDENTIFIED #1   // Spear +1
  ADD_STORE_ITEM BLUN03   LAST #0 #0 #0 IDENTIFIED #1   // Flail +1
  ADD_STORE_ITEM BLUN05   LAST #0 #0 #0 IDENTIFIED #1   // Mace +1
  ADD_STORE_ITEM BLUN07   LAST #0 #0 #0 IDENTIFIED #1   // Morning Star +1
  ADD_STORE_ITEM XBOW02   LAST #0 #0 #0 IDENTIFIED #1   // Heavy Crossbow +1
  ADD_STORE_ITEM XBOW05   LAST #0 #0 #0 IDENTIFIED #1   // Light Crossbow +1
  ADD_STORE_ITEM BOW02    LAST #0 #0 #0 IDENTIFIED #1   // Composite Long Bow +1
  ADD_STORE_ITEM BOW04    LAST #0 #0 #0 IDENTIFIED #1   // Long Bow +1
  ADD_STORE_ITEM BOW06    LAST #0 #0 #0 IDENTIFIED #1   // Short Bow +1
  ADD_STORE_ITEM SLNG02   LAST #0 #0 #0 IDENTIFIED #1   // Sling +1
  ADD_STORE_ITEM AX1H02   LAST #0 #0 #0 IDENTIFIED #1   // Battle Axe +1
  ADD_STORE_ITEM DAGG02   LAST #0 #0 #0 IDENTIFIED #1   // Dagger +1
  ADD_STORE_ITEM HALB02   LAST #0 #0 #0 IDENTIFIED #1   // Halberd +1
  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM CLCK18   LAST #0 #0 #0 IDENTIFIED #1   // Knave Robe/Mage Robe of Acid Resistance
  END
  ADD_STORE_ITEM AMUL14   LAST #0 #0 #0 IDENTIFIED #1   // Amulet of Protection +1

  PATCH_IF comp_rr_equip=1 BEGIN
    ADD_STORE_ITEM ~RR#BOW03~ LAST #0 #0 #0 IDENTIFIED #1  // Composite Short Bow +1
  END

  ADD_STORE_ITEM DART02   LAST #20 #0 #0 IDENTIFIED #5  // Dart +1
  ADD_STORE_ITEM AROW01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED  // Arrows
  ADD_STORE_ITEM BOLT01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED  // Bolt
  ADD_STORE_ITEM BULL01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED  // Bullet
  ADD_STORE_ITEM AROW11   LAST #20 #0 #0 IDENTIFIED #2  // Arrow +2
  ADD_STORE_ITEM AROW10   LAST #10 #0 #0 IDENTIFIED #2  // Arrows of Piercing
  ADD_STORE_ITEM AROW04   LAST #10 #0 #0 IDENTIFIED #1  // Acid Arrows
  ADD_STORE_ITEM BOLT04   LAST #10 #0 #0 IDENTIFIED #1  // Bolt of Biting 
  ADD_STORE_ITEM BOLT03   LAST #10 #0 #0 IDENTIFIED #2  // Bolt of Lightning
  ADD_STORE_ITEM BULL03   LAST #20 #0 #0 IDENTIFIED #1  // Bullet +2

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #7   // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Extra Healing
  ADD_STORE_ITEM POTN14   LAST #1 #0 #0 IDENTIFIED #1   // Oil of Speed
  ADD_STORE_ITEM POTN19   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Agility
  ADD_STORE_ITEM POTN20   LAST #1 #0 #0 IDENTIFIED #1   // Antidote
  ADD_STORE_ITEM POTN18   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Absorbtion 
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Extra Healing
  ADD_STORE_ITEM POTN39   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Perception
  ADD_STORE_ITEM POTN36   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Master Thievery
  ADD_STORE_ITEM POTN05   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Fire Giant Strength

  ADD_STORE_ITEM SCRL05   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Electricity
  ADD_STORE_ITEM SCRL1Y   LAST #1 #0 #0 IDENTIFIED #1   // Improved Invisibility
  ADD_STORE_ITEM SCRL1M   LAST #1 #0 #0 IDENTIFIED #1   // Non-Detection

END BUT_ONLY

////////////////////

// TRRAK01 - Adratha
// 
// Trademeet's rakshasa

// 100% stock overwrite

COPY_EXISTING trrak01.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR potn=1 END
  REMOVE_STORE_ITEM 
    POTN08    // Potion of Healing
    POTN17    // Elixir of Health
    POTN20    // Antidote
    POTN42    // Potion of Regeneration 
    POTN22    // Potion of Cold Resistance
    POTN24    // Potion of Defense
    POTN10    // Potion of Invisibility
    POTN03    // Potion of Hill Giant Strength
    POTN02    // Potion of Fire Resistance
    POTN09    // Potion of Heroism
    POTN46    // Potion of Stone Form
    POTN41    // Potion of Power
    POTN40    // Potion of Invulnerability
    POTN14    // Oil of Speed
    POTN42    // Potion of Regeneration 
    POTN31    // Potion of Insulation
    WAND06    // Wand of Frost

  LPF store INT_VAR
    sell=135
    buy=20
    steal=0
    fence=0
  END

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #8   // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Extra Healing
  ADD_STORE_ITEM POTN17   LAST #1 #0 #0 IDENTIFIED #1   // Elixir of Health
  ADD_STORE_ITEM POTN20   LAST #1 #0 #0 IDENTIFIED #3   // Antidote
  ADD_STORE_ITEM POTN42   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Regeneration 
  ADD_STORE_ITEM POTN22   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Cold Resistance
  ADD_STORE_ITEM POTN10   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Invisibility
  ADD_STORE_ITEM POTN03   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Hill Giant Strength
  ADD_STORE_ITEM POTN02   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Fire Resistance
  ADD_STORE_ITEM POTN09   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Heroism
  ADD_STORE_ITEM POTN46   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Stone Form
  ADD_STORE_ITEM POTN41   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Power
  ADD_STORE_ITEM POTN14   LAST #1 #0 #0 IDENTIFIED #1   // Oil of Speed

END BUT_ONLY

//////////////////

// TANALLY1 - Fael
// 
// Human Flesh armor quest, not touching since he's not really there to trade

COPY_EXISTING tanally1.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END

  LPF store INT_VAR
    sell=155
    buy=25
    steal=0
    fence=0
  END

END BUT_ONLY

////////////////////////////////

// SAHPR1 - Priestess of Sekolah
// 
// sahuagin city, as you might guess

// 100% stock overwrite

COPY_EXISTING sahpr1.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    DART01    // Dart
    DAGG05    // Throwing Dagger
    AX1H04    // Throwing Axe
    AROW01    // Arrows
    AROW02    // Arrows +1
    BOLT01    // Bolt
    BOLT02    // Bolt +1
    BULL01    // Bullet
    BULL02    // Bullet +1
    POTN08    // Potion of Healing
    POTN52    // Potion of Extra Healing
    POTN09    // Potion of Heroism
    POTN30    // Potion of Infravision
    POTN44    // Potion of Strength
    SCRL66    // Grease
    SCRL67    // Armor
    SCRL68    // Burning Hands
    SCRL69    // Charm Person
    SCRL70    // Color Spray
    SCRL71    // Blindness
    SCRL72    // Friends
    SCRL73    // Protection From Petrification
    SCRL75    // Identify
    SCRL76    // Infravision
    SCRL77    // Magic Missile
    SCRL78    // Protection From Evil
    SCRL79    // Shield
    SCRL80    // Shocking Grasp
    SCRL81    // Sleep
    SCRL82    // Chill Touch
    SCRL83    // Chromatic Orb
    SCRL84    // Larloch's Minor Drain
    SCRL85    // Blur
    SCRL86    // Detect Evil
    SCRL87    // Detect Invisibilty
    SCRL89    // Horror
    SCRL90    // Invisibilty
    SCRL91    // Knock
    SCRL92    // Know Alignment
    SCRL93    // Luck
    SCRL94    // Resist Fear
    SCRL95    // Melf's Acid Arrow
    SCRL96    // Mirror Image
    SCRL97    // Stinking Cloud
    SCRL98    // Strength
    SCRL99    // Web
    SCRL1B    // Agannazar's Scorcher
    SCRL1C    // Ghoul Touch
    SCRL3G    // Vocalize
    SCRL1D    // Clairvoyance
    SCRL1E    // Dispel Magic
    SCRL1F    // Flame Arrow
    SCRL1G    // Fireball
    SCRL1H    // Haste
    SCRL1I    // Hold Person
    SCRL1J    // Invisibility 10' Radius
    SCRL1K    // Lightning Bolt
    SCRL1L    // Monster Summoning I
    SCRL1M    // Non-Detection
    SCRL1N    // Protection From Normal Missiles
    SCRL1O    // Slow
    SCRL1P    // Skull Trap
    SCRL1Q    // Vampiric Touch
    SCRL1S    // Dire Charm
    SCRL1T    // Ghost Armor
    SCRL1U    // Confusion
    SCRL1W    // Fireshield (Blue)
    SCRL1V    // Stoneskin
    SCRL1X    // Ice Storm
    SCRL1Y    // Improved Invisibility
    SCRL1Z    // Minor Globe of Invulnerability
    SCRL2A    // Monster Summoning II
    SCRL2B    // Stoneskin
    SCRL2D    // Animate Dead
    SCRL2E    // Cloudkill
    SCRL2F    // Cone of Cold
    SCRL2G    // Monster Summoning III
    SCRL2H    // Shadow Door
    SCRL5H    // Emotion
    SCRL5I    // Greater Malison
    SCRL5J    // Oliluke's Resilient Sphere
    SCRL5K    // Spirit Armor
    SCRL5L    // Polymorph Other
    SCRL5M    // Polymorph Self
    SCRL5N    // Domination
    SCRL5O    // Hold Monster
    SCRL5P    // Chaos
    SCRL5Q    // Feeblemind
    SCRL5T    // Protection from Electricity
    SCRL5U    // Reflected Image
    SCRL6U    // Breach
    SCRL7L    // Pierce Magic
    RESTORE   // Restoration
    DART02    // Dart +1

  LPF store INT_VAR
    sell=135
    buy=30
    steal=0
    fence=1
  END

  LPF temple INT_VAR
    cure_light_wounds=25
    dispel_magic=200
    remove_curse=500
    cure_medium_wounds=50
    cure_disease=300
    cure_serious_wounds=75
    neutralize_poison=300
    lesser_restoration=750
    cure_critical_wounds=100
    raise_dead=1000
    mass_cure= comp_atweaks_temples=1 ? 1000 : 0
    heal=1000
  END

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #10  // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Extra Healing
  ADD_STORE_ITEM POTN20   LAST #1 #0 #0 IDENTIFIED #3   // Antidote

  ADD_STORE_ITEM SCRLPET  LAST #1 #0 #0 IDENTIFIED #1   // Stone to Flesh Scroll
  ADD_STORE_ITEM RESTORE  LAST #1 #0 #0 IDENTIFIED #3   // Restoration
  ADD_STORE_ITEM SCRL63   LAST #1 #0 #0 IDENTIFIED #3   // Raise Dead

  ADD_STORE_ITEM XBOW01   LAST #0 #0 #0 IDENTIFIED #3   // Heavy Crossbow
  ADD_STORE_ITEM XBOW04   LAST #0 #0 #0 IDENTIFIED #3   // Light Crossbow
  ADD_STORE_ITEM BOLT01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED // Bolt
  ADD_STORE_ITEM XBOW02   LAST #0 #0 #0 IDENTIFIED #1   // Heavy Crossbow +1
  ADD_STORE_ITEM XBOW05   LAST #0 #0 #0 IDENTIFIED #1   // Light Crossbow +1
  ADD_STORE_ITEM BOLT02   LAST #40 #0 #0 IDENTIFIED #5  // Bolt +1
  ADD_STORE_ITEM BOLT06   LAST #20 #0 #0 IDENTIFIED #2  // Bolt +2

  ADD_STORE_ITEM SPER01   LAST #0 #0 #0 IDENTIFIED #3   // Spear
  ADD_STORE_ITEM SPER02   LAST #0 #0 #0 IDENTIFIED #1   // Spear +1
  ADD_STORE_ITEM SPER05   LAST #0 #0 #0 IDENTIFIED #1   // Spear +2

END BUT_ONLY

///////////////////

// SUELF10 - Reirra
// 
// Suldanessellar, elf girl priestess

// 100% stock overwrite

COPY_EXISTING gromnir.cre override LPF FJ_CRE_VALIDITY RET valid=valid END PATCH_IF valid BEGIN
  REMOVE_CRE_ITEM compon05
END BUT_ONLY

COPY_EXISTING suelf10.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    DART01    // Dart
    DAGG05    // Throwing Dagger
    AX1H04    // Throwing Axe
    AROW01    // Arrows
    AROW02    // Arrows +1
    BOLT01    // Bolt
    BOLT02    // Bolt +1
    BULL01    // Bullet
    BULL02    // Bullet +1
    POTN08    // Potion of Healing
    POTN52    // Potion of Extra Healing
    POTN09    // Potion of Heroism
    POTN30    // Potion of Infravision
    POTN44    // Potion of Strength
    SCRL66    // Grease
    SCRL67    // Armor
    SCRL68    // Burning Hands
    SCRL69    // Charm Person
    SCRL70    // Color Spray
    SCRL71    // Blindness
    SCRL72    // Friends
    SCRL73    // Protection From Petrification
    SCRL75    // Identify
    SCRL76    // Infravision
    SCRL77    // Magic Missile
    SCRL78    // Protection From Evil
    SCRL79    // Shield
    SCRL80    // Shocking Grasp
    SCRL81    // Sleep
    SCRL82    // Chill Touch
    SCRL83    // Chromatic Orb
    SCRL84    // Larloch's Minor Drain
    SCRL85    // Blur
    SCRL86    // Detect Evil
    SCRL87    // Detect Invisibilty
    SCRL89    // Horror
    SCRL90    // Invisibilty
    SCRL91    // Knock
    SCRL92    // Know Alignment
    SCRL93    // Luck
    SCRL94    // Resist Fear
    SCRL95    // Melf's Acid Arrow
    SCRL96    // Mirror Image
    SCRL97    // Stinking Cloud
    SCRL98    // Strength
    SCRL99    // Web
    SCRL1B    // Agannazar's Scorcher
    SCRL1C    // Ghoul Touch
    SCRL3G    // Vocalize
    SCRL1D    // Clairvoyance
    SCRL1E    // Dispel Magic
    SCRL1F    // Flame Arrow
    SCRL1G    // Fireball
    SCRL1H    // Haste
    SCRL1I    // Hold Person
    SCRL1J    // Invisibility 10' Radius
    SCRL1K    // Lightning Bolt
    SCRL1L    // Monster Summoning I
    SCRL1M    // Non-Detection
    SCRL1N    // Protection From Normal Missiles
    SCRL1O    // Slow
    SCRL1P    // Skull Trap
    SCRL1Q    // Vampiric Touch
    SCRL1S    // Dire Charm
    SCRL1T    // Ghost Armor
    SCRL1U    // Confusion
    SCRL1W    // Fireshield (Blue)
    SCRL1V    // Stoneskin
    SCRL1X    // Ice Storm
    SCRL1Y    // Improved Invisibility
    SCRL1Z    // Minor Globe of Invulnerability
    SCRL2A    // Monster Summoning II
    SCRL2B    // Stoneskin
    SCRL2D    // Animate Dead
    SCRL2E    // Cloudkill
    SCRL2F    // Cone of Cold
    SCRL2G    // Monster Summoning III
    SCRL2H    // Shadow Door
    SCRL5H    // Emotion
    SCRL5I    // Greater Malison
    SCRL5J    // Oliluke's Resilient Sphere
    SCRL5K    // Spirit Armor
    SCRL5L    // Polymorph Other
    SCRL5M    // Polymorph Self
    SCRL5N    // Domination
    SCRL5O    // Hold Monster
    SCRL5P    // Chaos
    SCRL5Q    // Feeblemind
    SCRL5T    // Protection from Electricity
    SCRL5U    // Reflected Image
    SCRL6U    // Breach
    SCRL7L    // Pierce Magic
    RESTORE   // Restoration
    DART02    // Dart +1

  LPF store INT_VAR
    sell=135
    buy=25
    steal=0
    fence=1
  END

  LPF temple INT_VAR
    cure_light_wounds=20
    dispel_magic=160
    remove_curse=400
    cure_medium_wounds=40
    cure_disease=240
    cure_serious_wounds=60
    neutralize_poison=240
    lesser_restoration=600
    cure_critical_wounds=80
    raise_dead=800
    mass_cure= comp_atweaks_temples=1 ? 800 : 0
    heal=800
    resurrection=1600
    greater_restoration=1600
  END

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #10  // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Extra Healing
  ADD_STORE_ITEM POTN17   LAST #1 #0 #0 IDENTIFIED #2   // Elixir of Health

  ADD_STORE_ITEM SCRLPET  LAST #1 #0 #0 IDENTIFIED #1   // Stone to Flesh Scroll
  ADD_STORE_ITEM RESTORE  LAST #1 #0 #0 IDENTIFIED #3   // Restoration
  ADD_STORE_ITEM SCRL63   LAST #1 #0 #0 IDENTIFIED #3   // Raise Dead

  ADD_STORE_ITEM CHAN12   LAST #0 #0 #0 IDENTIFIED #2   // Elven Chain Mail
  ADD_STORE_ITEM CHAN13   LAST #0 #0 #0 IDENTIFIED #1   // Elven Chain +1

  ADD_STORE_ITEM POTN19   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Agility
  ADD_STORE_ITEM POTN39   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Perception
  ADD_STORE_ITEM SW1H04   LAST #0 #0 #0 IDENTIFIED #5   // Long Sword 
  ADD_STORE_ITEM SW1H05   LAST #0 #0 #0 IDENTIFIED #2   // Long Sword +1
  ADD_STORE_ITEM SW1H41   LAST #0 #0 #0 IDENTIFIED #1   // Long Sword +2
  ADD_STORE_ITEM BOW03    LAST #0 #0 #0 IDENTIFIED #4   // Long Bow
  ADD_STORE_ITEM BOW04    LAST #0 #0 #0 IDENTIFIED #2   // Long Bow +1
  ADD_STORE_ITEM BOW17    LAST #0 #0 #0 IDENTIFIED #1   // Long Bow +2
  ADD_STORE_ITEM AROW01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED // Arrows
  ADD_STORE_ITEM AROW02   LAST #40 #0 #0 IDENTIFIED #5  // Arrows +1
  ADD_STORE_ITEM AROW11   LAST #20 #0 #0 IDENTIFIED #2  // Arrow +2

  ADD_STORE_ITEM MISCAU   LAST #1 #0 #0 IDENTIFIED #5   // Elven Holy Water
  ADD_STORE_ITEM COMPON05 LAST #0 #0 #0 IDENTIFIED #1   // Roranach's Horn

END BUT_ONLY

///////////////
// Underdark //
///////////////

////////////////////////////
/*
// UDDROW22 - Drow Bartender
// 
// bartender in Ust Natha, can't trade

COPY_EXISTING uddrow22.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END

END BUT_ONLY
*/
//////////////////

// UDDROW23 - Drow
// 
// weaponmaster

// 100% stock overwrite

// take Psion's Blade for Yaga-Shura's temple
COPY_EXISTING ar5201.are override PATCH_IF SOURCE_SIZE>0x11c BEGIN
  LPF DELETE_AREA_ITEM STR_VAR item_to_delete=sw2h21 END
END BUT_ONLY

// takee Azamantes' Serpent Shaft
COPY_EXISTING ~gorlic01.cre~ ~override~ LPF FJ_CRE_VALIDITY RET valid=valid END PATCH_IF valid BEGIN
  REMOVE_CRE_ITEM staf23
END BUT_ONLY

COPY_EXISTING uddrow23.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 END
  REMOVE_STORE_ITEM 
    AMUL10    // Gold Necklace
    DAGG01    // Dagger
    DAGG05    // Throwing Dagger
    DAGG02    // Dagger +1
    AX1H01    // Battle Axe
    SW1H01    // Bastard Sword 
    SW1H04    // Long Sword 
    SW1H05    // Long Sword +1
    SW1H07    // Short Sword 
    SW1H08    // Short Sword +1
    SW1H20    // Scimitar
    SW1H43    // Katana
    SW1H46    // Wakizashi
    SW1H48    // Ninja-To
    SW2H01    // Two Handed Sword
    SW2H07    // Harbinger +3
    LEAT01    // Leather Armor
    LEAT04    // Studded Leather Armor
    CHAN04    // Splint Mail
    CHAN01    // Chain Mail Armor
    STAF01    // Quarterstaff
    HAMM01    // War Hammer
    SPER01    // Spear
    SPER10    // Spear of Withering +4
    BLUN01    // Club
    BLUN02    // Flail
    BLUN04    // Mace
    BLUN06    // Morning Star
    XBOW01    // Heavy Crossbow
    XBOW04    // Light Crossbow
    BOW01     // Composite Long Bow
    BOW03     // Long Bow
    BOW05     // Short Bow
    SLNG01    // Sling 
    AX1H01    // Battle Axe
    AX1H04    // Throwing Axe
    DAGG01    // Dagger
    DAGG12    // Fire Tooth +3
    HALB01    // Halberd
    DART01    // Dart
    AROW01    // Arrows
    BOLT01    // Bolt
    BOLT06    // Bolt +2
    BULL01    // Bullet
    BULL03    // Bullet +2
    SHLD22    // Sentinel +4
    STAF16    // Staff of Earth +2
    RESTORE   // Restoration
    CLCK17    // Robe of the Evil Archmagi
    SCRL6U    // Breach
    SCRL9H    // Maze
    SCRL6N    // Fireshield (Red)
    SCRL7X    // Conjure Fire Elemental
    SCRL7Z    // Conjure Earth Elemental
    SCRL2D    // Animate Dead
    SCRL2E    // Cloudkill
    SCRL2F    // Cone of Cold
    SCRL2G    // Monster Summoning III
    SCRL2H    // Shadow Door
 // these are RR's additions
    ~RR#BOW02~  // Composite Short Bow

  LPF store INT_VAR
    sell=165
    buy=25
    steal=90
    fence=0
  END

  SAY 0xc @200134 // Drow Weapon Dealer

  ADD_STORE_ITEM dwsw1h02 LAST #0 #0 #0 IDENTIFIED #2   // longsword
  ADD_STORE_ITEM dwsw1h01 LAST #0 #0 #0 IDENTIFIED #2   // scimitar
  ADD_STORE_ITEM dwsper01 LAST #0 #0 #0 IDENTIFIED #2   // lance
  ADD_STORE_ITEM dwblun01 LAST #0 #0 #0 IDENTIFIED #2   // flail
  ADD_STORE_ITEM dwhalb01 LAST #0 #0 #0 IDENTIFIED #2   // halberd
  ADD_STORE_ITEM dwxbow01 LAST #0 #0 #0 IDENTIFIED #2   // crossbow
  ADD_STORE_ITEM dwbolt03 LAST #40 #0 #0 IDENTIFIED #5  // bolt +1
  ADD_STORE_ITEM dwbolt01 LAST #40 #0 #0 IDENTIFIED #5  // bolt of sleep
  ADD_STORE_ITEM dwbolt02 LAST #40 #0 #0 IDENTIFIED #5  // bolt of stunning
  ADD_STORE_ITEM dwchan01 LAST #0 #0 #0 IDENTIFIED #1   // elven chainmail
  ADD_STORE_ITEM dwchan02 LAST #0 #0 #0 IDENTIFIED #1   // adamantine chainmail
  ADD_STORE_ITEM dwshld01 LAST #0 #0 #0 IDENTIFIED #2   // shield

  ADD_STORE_ITEM staf23   LAST #0 #0 #0 IDENTIFIED #1   // Serpent Shaft +3
  ADD_STORE_ITEM waflail  LAST #0 #0 #0 IDENTIFIED #1   // Defender of Easthaven
  ADD_STORE_ITEM SPER10   LAST #0 #0 #0 IDENTIFIED #1   // Spear of Withering +4
  ADD_STORE_ITEM DAGG12   LAST #0 #0 #0 IDENTIFIED #1   // Fire Tooth +3
  ADD_STORE_ITEM SW2H21   LAST #0 #0 #0 IDENTIFIED #1   // Psion's Blade
  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM WA2SHIEL LAST #0 #0 #0 IDENTIFIED #1   // Shield of Balduran -> Mirror Shield
  END ELSE BEGIN
    ADD_STORE_ITEM SHLD22   LAST #0 #0 #0 IDENTIFIED #1   // Sentinel +4
  END

END BUT_ONLY

//////////////////

// UDDROW24 - Drow
// 
// potionmaster

// 100% stock overwrite

COPY_EXISTING uddrow24.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    POTN02    // Potion of Fire Resistance
    POTN04    // Potion of Frost Giant Strength
    POTN05    // Potion of Fire Giant Strength
    POTN06    // Potion of Cloud Giant Strength
    POTN07    // Potion of Storm Giant Strength
    POTN08    // Potion of Healing
    POTN09    // Potion of Heroism
    POTN11    // Potion of Invulnerability
    POTN12    // Potion of Stone Giant Strength
    POTN13    // Oil of Fiery Burning
    POTN17    // Elixir of Health
    POTN18    // Potion of Absorbtion 
    POTN20    // Antidote
    POTN21    // Potion of Clarity
    POTN24    // Potion of Defense
    POTN25    // Potion of Healing
    POTN27    // Potion of Firebreath
    POTN30    // Potion of Infravision
    POTN32    // Antidote
    POTN34    // Potion of Magic Protection
    POTN35    // Potion of Magic Shielding
    POTN37    // Potion of Mind Focusing
    POTN39    // Potion of Perception
    POTN40    // Potion of Invulnerability
    POTN42    // Potion of Regeneration 
    POTN44    // Potion of Strength
    POTN52    // Potion of Extra Healing
    POTN03    // Potion of Hill Giant Strength
    POTN19    // Potion of Agility
    POTN36    // Potion of Master Thievery
    POTN29    // Potion of Genius
    AMUL20    // Kaligun's Amulet of Magic Resistance
    RODS04    // Rod of Smiting

  LPF store INT_VAR
    sell=165
    buy=25
    steal=70
    fence=0
  END

  SAY 0xc @200135 // Drow Potion Dealer

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #20  // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #10  // Potion of Extra Healing
  ADD_STORE_ITEM POTN55   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Superior Healing
  ADD_STORE_ITEM POTN20   LAST #1 #0 #0 IDENTIFIED #3   // Antidote
  ADD_STORE_ITEM POTN17   LAST #1 #0 #0 IDENTIFIED #2   // Elixir of Health
  ADD_STORE_ITEM POTN42   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Regeneration 

  ADD_STORE_ITEM POTN44   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Strength
  ADD_STORE_ITEM POTN19   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Agility
  ADD_STORE_ITEM POTN28   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Fortitude
  ADD_STORE_ITEM POTN29   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Genius
  ADD_STORE_ITEM POTN43   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Insight 
  ADD_STORE_ITEM POTN37   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Mind Focusing

  ADD_STORE_ITEM POTN12   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Stone Giant Strength
  ADD_STORE_ITEM POTN05   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Fire Giant Strength
  ADD_STORE_ITEM POTN07   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Storm Giant Strength

  ADD_STORE_ITEM POTN09   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Heroism
  ADD_STORE_ITEM POTN14   LAST #1 #0 #0 IDENTIFIED #3   // Oil of Speed
  ADD_STORE_ITEM POTN41   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Power

  ADD_STORE_ITEM POTN22   LAST #1 #0 #0 IDENTIFIED #4   // Potion of Cold Resistance
  ADD_STORE_ITEM POTN31   LAST #1 #0 #0 IDENTIFIED #4   // Potion of Insulation
  ADD_STORE_ITEM POTN02   LAST #1 #0 #0 IDENTIFIED #4   // Potion of Fire Resistance
  ADD_STORE_ITEM POTN34   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Magic Protection
  ADD_STORE_ITEM POTN35   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Magic Shielding
  ADD_STORE_ITEM potn33   LAST #1 #0 #0 IDENTIFIED #1   // potion of magic blocking

  ADD_STORE_ITEM potn38   LAST #1 #0 #0 IDENTIFIED #2   // potion of mirrored eyes
  ADD_STORE_ITEM POTN24   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Defense
  ADD_STORE_ITEM POTN11   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Invulnerability
  ADD_STORE_ITEM POTN46   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Stone Form
  ADD_STORE_ITEM POTN18   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Absorbtion 

  ADD_STORE_ITEM POTN30   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Infravision
  ADD_STORE_ITEM POTN39   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Perception
  ADD_STORE_ITEM POTN36   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Master Thievery
  ADD_STORE_ITEM POTN10   LAST #1 #0 #0 IDENTIFIED #4   // Potion of Invisibility
  ADD_STORE_ITEM POTN21   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Clarity
  ADD_STORE_ITEM POTN45   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Freedom

  ADD_STORE_ITEM POTN13   LAST #1 #0 #0 IDENTIFIED #5   // Oil of Fiery Burning
  ADD_STORE_ITEM POTN27   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Firebreath
  ADD_STORE_ITEM POTN26   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Explosions

END BUT_ONLY

//////////////////

// UDDROW25 - Drow
// 
// spellmaster
// he trades all the magic that can be purchased after departing to Brynnlaw

// 100% stock overwrite

COPY_EXISTING ar2101.are override PATCH_IF SOURCE_SIZE>0x11c BEGIN
  LPF DELETE_AREA_ITEM STR_VAR item_to_delete=amul17 END // move greenstone amulet to store
END BUT_ONLY

COPY_EXISTING uddrow25.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR magic=1 END
  REMOVE_STORE_ITEM 
    SCRL6D    // Find Familiar
    SCRL6E    // Power Word Sleep
    SCRL6F    // Ray of Enfeeblement
    SCRL6G    // Minor Spell Deflection
    SCRL6H    // Protection from Fire
    SCRL6I    // Protection from Cold
    SCRL6J    // Spell Thrust
    SCRL6K    // Detect Illusion
    SCRL6L    // Hold Undead
    SCRL6M    // Enchanted Weapon
    SCRL6N    // Fireshield (Red)
    SCRL6O    // Secret Word
    SCRL6P    // Minor Sequencer
    SCRL6Q    // Teleport Field
    SCRL6R    // Spider Spawn
    SCRL6S    // Spell Immunity
    SCRL7B    // Conjure Lesser Air Elemental
    SCRL7C    // Conjure Lesser Earth Elemental
    SCRL7D    // Minor Spell Turning
    RESTORE   // Restoration
    SCRL7S    // Chain Lightning
    SCRL8D    // Spell Turning
    SCRL8I    // Cacofiend
    SCRL8L    // Spell Sequencer
    SCRL8P    // Prismatic Spray
    SCRL9E    // Incendiary Cloud
    SCRL9B    // Summon Fiend
    SCRL8Z    // Simulacrum
    SCRL8S    // Summon Efreet
    SCRL8A    // Carrion Summons
    SCRL7R    // Death Fog
    SCRL8O    // Finger of Death
    SCRL8J    // Mantle
    SCRL8W    // Mass Invisibility
    SCRL8G    // Ruby Ray of Reversal
    SCRL8T    // Summon Djinni

    // spell revisions
    scrl1v     // dimension door
    scrlw801   // ghost form

  LPF store INT_VAR
    sell=185
    buy=25
    steal=70
    fence=0
  END

  SAY 0xc @200136 // Drow Spell Dealer

  ADD_STORE_ITEM SCRL67   LAST #1 #0 #0 IDENTIFIED #5   // Armor
  ADD_STORE_ITEM SCRL71   LAST #1 #0 #0 IDENTIFIED #5   // Blindness
  ADD_STORE_ITEM SCRL68   LAST #1 #0 #0 IDENTIFIED #5   // Burning Hands
  ADD_STORE_ITEM SCRL69   LAST #1 #0 #0 IDENTIFIED #5   // Charm Person
  ADD_STORE_ITEM SCRL82   LAST #1 #0 #0 IDENTIFIED #5   // Chill Touch
  ADD_STORE_ITEM SCRL83   LAST #1 #0 #0 IDENTIFIED #5   // Chromatic Orb
  ADD_STORE_ITEM SCRL70   LAST #1 #0 #0 IDENTIFIED #5   // Color Spray
  ADD_STORE_ITEM SCRL6D   LAST #1 #0 #0 IDENTIFIED #5   // Find Familiar
  ADD_STORE_ITEM SCRL66   LAST #1 #0 #0 IDENTIFIED #5   // Grease
  ADD_STORE_ITEM SCRL84   LAST #1 #0 #0 IDENTIFIED #5   // Larloch's Minor Drain
  ADD_STORE_ITEM SCRL77   LAST #1 #0 #0 IDENTIFIED #5   // Magic Missile

  ADD_STORE_ITEM SCRL1B   LAST #1 #0 #0 IDENTIFIED #5   // Agannazar's Scorcher
  ADD_STORE_ITEM SCRL85   LAST #1 #0 #0 IDENTIFIED #5   // Blur
  ADD_STORE_ITEM SCRL1C   LAST #1 #0 #0 IDENTIFIED #5   // Ghoul Touch
  ADD_STORE_ITEM SCRL6E   LAST #1 #0 #0 IDENTIFIED #5   // Power Word Sleep
  ADD_STORE_ITEM SCRL6F   LAST #1 #0 #0 IDENTIFIED #5   // Ray of Enfeeblement
  ADD_STORE_ITEM SCRL98   LAST #1 #0 #0 IDENTIFIED #5   // Strength
  ADD_STORE_ITEM SCRL3G   LAST #1 #0 #0 IDENTIFIED #5   // Vocalize
  ADD_STORE_ITEM SCRL99   LAST #1 #0 #0 IDENTIFIED #10  // Web

  ADD_STORE_ITEM SCRL6K   LAST #1 #0 #0 IDENTIFIED #2   // Detect Illusion
  ADD_STORE_ITEM SCRL1S   LAST #1 #0 #0 IDENTIFIED #2   // Dire Charm
  ADD_STORE_ITEM SCRL1T   LAST #1 #0 #0 IDENTIFIED #2   // Ghost Armor
  ADD_STORE_ITEM SCRL6L   LAST #1 #0 #0 IDENTIFIED #2   // Hold Undead
  ADD_STORE_ITEM SCRL6G   LAST #1 #0 #0 IDENTIFIED #2   // Minor Spell Deflection
  ADD_STORE_ITEM SCRL1N   LAST #1 #0 #0 IDENTIFIED #2   // Protection From Normal Missiles
  ADD_STORE_ITEM SCRL1P   LAST #1 #0 #0 IDENTIFIED #2   // Skull Trap
  ADD_STORE_ITEM SCRL1O   LAST #1 #0 #0 IDENTIFIED #2   // Slow
  ADD_STORE_ITEM SCRL6J   LAST #1 #0 #0 IDENTIFIED #2   // Spell Thrust
  ADD_STORE_ITEM SCRL1Q   LAST #1 #0 #0 IDENTIFIED #2   // Vampiric Touch

  PATCH_IF comp_sr=1 BEGIN
    ADD_STORE_ITEM scrl1v   LAST #1 #0 #0 IDENTIFIED #2   // dimension door
  END
  ADD_STORE_ITEM SCRL6M   LAST #1 #0 #0 IDENTIFIED #2   // Enchanted Weapon
  ADD_STORE_ITEM SCRL6N   LAST #1 #0 #0 IDENTIFIED #2   // Fireshield (Red)
  ADD_STORE_ITEM SCRL6P   LAST #1 #0 #0 IDENTIFIED #2   // Minor Sequencer
  ADD_STORE_ITEM SCRL6Q   LAST #1 #0 #0 IDENTIFIED #2   // Teleport Field
  ADD_STORE_ITEM SCRL6O   LAST #1 #0 #0 IDENTIFIED #2   // Secret Word
  ADD_STORE_ITEM SCRL6R   LAST #1 #0 #0 IDENTIFIED #5   // Spider Spawn
  ADD_STORE_ITEM SCRL1V   LAST #1 #0 #0 IDENTIFIED #2   // Stoneskin

  ADD_STORE_ITEM SCRL2D   LAST #1 #0 #0 IDENTIFIED #2   // Animate Dead
  ADD_STORE_ITEM SCRL6U   LAST #1 #0 #0 IDENTIFIED #2   // Breach
  ADD_STORE_ITEM SCRL5P   LAST #1 #0 #0 IDENTIFIED #2   // Chaos
  ADD_STORE_ITEM SCRL2E   LAST #1 #0 #0 IDENTIFIED #2   // Cloudkill
  ADD_STORE_ITEM SCRL2F   LAST #1 #0 #0 IDENTIFIED #2   // Cone of Cold
  ADD_STORE_ITEM SCRL7B   LAST #1 #0 #0 IDENTIFIED #2   // Conjure Lesser Air Elemental
  ADD_STORE_ITEM SCRL7C   LAST #1 #0 #0 IDENTIFIED #2   // Conjure Lesser Earth Elemental
  ADD_STORE_ITEM SCRL5N   LAST #1 #0 #0 IDENTIFIED #2   // Domination
  ADD_STORE_ITEM SCRL5O   LAST #1 #0 #0 IDENTIFIED #2   // Hold Monster
  ADD_STORE_ITEM SCRL7D   LAST #1 #0 #0 IDENTIFIED #2   // Minor Spell Turning
  ADD_STORE_ITEM SCRL2G   LAST #1 #0 #0 IDENTIFIED #2   // Monster Summoning III
  ADD_STORE_ITEM SCRL6Y   LAST #1 #0 #0 IDENTIFIED #2   // Protection from Acid
  ADD_STORE_ITEM SCRL6I   LAST #1 #0 #0 IDENTIFIED #2   // Protection from Cold
  ADD_STORE_ITEM SCRL5T   LAST #1 #0 #0 IDENTIFIED #2   // Protection from Electricity
  ADD_STORE_ITEM SCRL6H   LAST #1 #0 #0 IDENTIFIED #2   // Protection from Fire
  ADD_STORE_ITEM SCRL2H   LAST #1 #0 #0 IDENTIFIED #2   // Shadow Door
  ADD_STORE_ITEM SCRL6S   LAST #1 #0 #0 IDENTIFIED #2   // Spell Immunity
  PATCH_IF comp_sr=0 BEGIN
    ADD_STORE_ITEM SCRL8X   LAST #1 #0 #0 IDENTIFIED #2   // Spell Shield
  END
  ADD_STORE_ITEM SCRLAR   LAST #1 #0 #0 IDENTIFIED #2   // Sunfire

  ADD_STORE_ITEM SCRL8A   LAST #1 #0 #0 IDENTIFIED #2   // Carrion Summons
  ADD_STORE_ITEM SCRL7S   LAST #1 #0 #0 IDENTIFIED #2   // Chain Lightning
  ADD_STORE_ITEM SCRL7Z   LAST #1 #0 #0 IDENTIFIED #2   // Conjure Earth Elemental
  ADD_STORE_ITEM SCRL7X   LAST #1 #0 #0 IDENTIFIED #2   // Conjure Fire Elemental
  ADD_STORE_ITEM SCRL7R   LAST #1 #0 #0 IDENTIFIED #2   // Death Fog
  ADD_STORE_ITEM SCRL7I   LAST #1 #0 #0 IDENTIFIED #2   // Death Spell
  ADD_STORE_ITEM SCRL7T   LAST #1 #0 #0 IDENTIFIED #2   // Disintegrate
  ADD_STORE_ITEM SCRL7H   LAST #1 #0 #0 IDENTIFIED #2   // Flesh to Stone
  ADD_STORE_ITEM SCRL7F   LAST #1 #0 #0 IDENTIFIED #2   // Globe of Invunerability
  ADD_STORE_ITEM SCRL7Q   LAST #1 #0 #0 IDENTIFIED #2   // Improved Haste
  ADD_STORE_ITEM SCRL7E   LAST #1 #0 #0 IDENTIFIED #2   // Invisible Stalker
  ADD_STORE_ITEM SCRL7P   LAST #1 #0 #0 IDENTIFIED #2   // Power Word Silence
  ADD_STORE_ITEM SCRL8C   LAST #1 #0 #0 IDENTIFIED #2   // Stone to Flesh
  ADD_STORE_ITEM SCRL8B   LAST #1 #0 #0 IDENTIFIED #2   // Summon Nishru
  ADD_STORE_ITEM SCRL7G   LAST #1 #0 #0 IDENTIFIED #2   // Tenser's Transformation
  ADD_STORE_ITEM SCRL7M   LAST #1 #0 #0 IDENTIFIED #2   // True Sight

  ADD_STORE_ITEM SCRL8I   LAST #1 #0 #0 IDENTIFIED #3   // Cacofiend
  ADD_STORE_ITEM SCRL8O   LAST #1 #0 #0 IDENTIFIED #1   // Finger of Death
  ADD_STORE_ITEM SCRLA4   LAST #1 #0 #0 IDENTIFIED #1   // Limited Wish
  ADD_STORE_ITEM SCRL8J   LAST #1 #0 #0 IDENTIFIED #1   // Mantle
  ADD_STORE_ITEM SCRL8W   LAST #1 #0 #0 IDENTIFIED #1   // Mass Invisibility
  ADD_STORE_ITEM SCRL8R   LAST #1 #0 #0 IDENTIFIED #1   // Mordenkainen's Sword
  ADD_STORE_ITEM SCRL8P   LAST #1 #0 #0 IDENTIFIED #1   // Prismatic Spray
  ADD_STORE_ITEM SCRL8F   LAST #1 #0 #0 IDENTIFIED #1   // Project Image
  ADD_STORE_ITEM SCRL8G   LAST #1 #0 #0 IDENTIFIED #1   // Ruby Ray of Reversal
  ADD_STORE_ITEM SCRL8L   LAST #1 #0 #0 IDENTIFIED #1   // Spell Sequencer
  ADD_STORE_ITEM SCRL8D   LAST #1 #0 #0 IDENTIFIED #1   // Spell Turning
  ADD_STORE_ITEM SCRL8T   LAST #1 #0 #0 IDENTIFIED #1   // Summon Djinni
  ADD_STORE_ITEM SCRL8S   LAST #1 #0 #0 IDENTIFIED #1   // Summon Efreet
  ADD_STORE_ITEM SCRL8H   LAST #1 #0 #0 IDENTIFIED #1   // Warding Whip

  PATCH_IF comp_sr=1 BEGIN
    ADD_STORE_ITEM scrlw801 LAST #1 #0 #0 IDENTIFIED #1   // Ghost Form
  END
  ADD_STORE_ITEM SCRL9C   LAST #1 #0 #0 IDENTIFIED #1   // Improved Mantle
  ADD_STORE_ITEM SCRL9E   LAST #1 #0 #0 IDENTIFIED #1   // Incendiary Cloud
  ADD_STORE_ITEM SCRL9H   LAST #1 #0 #0 IDENTIFIED #1   // Maze
  ADD_STORE_ITEM SCRL9A   LAST #1 #0 #0 IDENTIFIED #1   // Pierce Shield
  ADD_STORE_ITEM SCRL8Z   LAST #1 #0 #0 IDENTIFIED #1   // Simulacrum
  PATCH_IF comp_sr=1 BEGIN
    ADD_STORE_ITEM SCRL8X   LAST #1 #0 #0 IDENTIFIED #1   // Spell Shield
  END
  ADD_STORE_ITEM SCRL9B   LAST #1 #0 #0 IDENTIFIED #2   // Summon Fiend
  ADD_STORE_ITEM SCRLAO   LAST #1 #0 #0 IDENTIFIED #1   // Symbol Death
  ADD_STORE_ITEM SCRL9F   LAST #1 #0 #0 IDENTIFIED #1   // Symbol Fear
  ADD_STORE_ITEM SCRLAP   LAST #1 #0 #0 IDENTIFIED #1   // Symbol Stun

  ADD_STORE_ITEM SCRL9Z   LAST #1 #0 #0 IDENTIFIED #2   // Freedom

  ADD_STORE_ITEM RESTORE  LAST #1 #0 #0 IDENTIFIED #1   // Restoration
  ADD_STORE_ITEM SCRL07   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Magic
  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM AMUL17   LAST #0 #0 #0 IDENTIFIED #1   // Greenstone Amulet
  END ELSE BEGIN
    ADD_STORE_ITEM AMUL17   LAST #50 #0 #0 IDENTIFIED #1  // Greenstone Amulet
  END  
  ADD_STORE_ITEM RODS04   LAST #20 #0 #0 IDENTIFIED #1  // Rod of Smiting
  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM AMUL20   LAST #1 #0 #0 IDENTIFIED #1   // Kaligun's Amulet of Magic Resistance
  END ELSE BEGIN
    ADD_STORE_ITEM AMUL20   LAST #0 #0 #0 IDENTIFIED #1   // Kaligun's Amulet of Magic Resistance
  END

END BUT_ONLY

////////////////////

// UDDUER01 - Carlig
// 
// when approached for the first time

// 100% stock overwrite

COPY_EXISTING udduer01.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    SW1H07    // Short Sword 
    SW1H20    // Scimitar
    SW2H01    // Two Handed Sword
    LEAT01    // Leather Armor
    CHAN04    // Splint Mail
    SLNG01    // Sling 
    AROW01    // Arrows
    BOLT01    // Bolt
    BULL01    // Bullet
    SCRL9Z    // Freedom
    SCRLPET   // Stone to Flesh Scroll
    SCRL2D    // Animate Dead
    SCRL6U    // Breach
    SCRL1V    // Stoneskin
    SCRL2E    // Cloudkill
    SCRL2F    // Cone of Cold
    SCRL5N    // Domination
    SCRL5O    // Hold Monster
    SCRL5P    // Chaos
    SCRL5T    // Protection from Electricity
    SCRL8X    // Spell Shield
    SCRLAL    // Sunfire
    SCRL7Q    // Improved Haste
    SCRL7P    // Power Word Silence
    SCRL8C    // Stone to Flesh
    SCRL7M    // True Sight
    SCRL8W    // Mass Invisibility
    SCRL8P    // Prismatic Spray
    SCRL8F    // Project Image
    SCRL8L    // Spell Sequencer

  LPF store INT_VAR
    sell=165
    buy=25
    steal=70
    fence=0
  END

  ADD_STORE_ITEM SW1H07   LAST #0 #0 #0 IDENTIFIED #1   // Short Sword 
  ADD_STORE_ITEM LEAT01   LAST #0 #0 #0 IDENTIFIED #1   // Leather Armor
  ADD_STORE_ITEM CHAN04   LAST #0 #0 #0 IDENTIFIED #1   // Splint Mail
  ADD_STORE_ITEM SLNG01   LAST #0 #0 #0 IDENTIFIED #1   // Sling 
  ADD_STORE_ITEM AROW01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED  // Arrows
  ADD_STORE_ITEM BOLT01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED  // Bolt
  ADD_STORE_ITEM BULL01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED  // Bullet
  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #7   // Potion of Healing
  ADD_STORE_ITEM misc25   LAST #0 #0 #0 IDENTIFIED #1   // zircone
  ADD_STORE_ITEM ring15   LAST #0 #0 #0 IDENTIFIED #1   // bloodstone

END BUT_ONLY

////////////////////

// UDDUER02 - Carlig
// 
// when disguised as drow

// 100% stock overwrite

COPY_EXISTING udduer02.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    PLAT10    // Plate Mail +1
    LEAT02    // Leather Armor +1
    LEAT05    // Studded Leather Armor +1
    CHAN02    // Chain Mail +1
    CHAN05    // Splint Mail +1
    SHLD02    // Small Shield +1
    SHLD04    // Medium Shield +1
    SHLD06    // Large Shield +1
    SW1H02    // Bastard Sword +1
    SW1H05    // Long Sword +1
    SW1H08    // Short Sword +1
    SW1H22    // Scimitar +1
    SW2H02    // Two Handed Sword +1
    SW1H44    // Katana +1
    SPER02    // Spear +1
    BLUN03    // Flail +1
    BLUN05    // Mace +1
    BLUN07    // Morning Star +1
    XBOW02    // Heavy Crossbow +1
    XBOW05    // Light Crossbow +1
    BOW02     // Composite Long Bow +1
    BOW04     // Long Bow +1
    BOW06     // Short Bow +1
    SLNG02    // Sling +1
    AX1H02    // Battle Axe +1
    DAGG02    // Dagger +1
    HALB02    // Halberd +1
    DART01    // Dart
    DART02    // Dart +1
    AROW01    // Arrows
    AROW11    // Arrow +2
    BOLT01    // Bolt
    BOLT06    // Bolt +2
    BULL01    // Bullet
    BULL03    // Bullet +2
    POTN20    // Antidote
    POTN36    // Potion of Master Thievery
    POTN19    // Potion of Agility
    POTN29    // Potion of Genius
    POTN22    // Potion of Cold Resistance
    POTN12    // Potion of Stone Giant Strength
    POTN07    // Potion of Storm Giant Strength
    POTN11    // Potion of Invulnerability
    POTN17    // Elixir of Health
    POTN52    // Potion of Extra Healing
    POTN34    // Potion of Magic Protection
    SCRL6D    // Find Familiar
    SCRL6E    // Power Word Sleep
    SCRL6F    // Ray of Enfeeblement
    SCRL6G    // Minor Spell Deflection
    SCRL6H    // Protection from Fire
    SCRL6O    // Secret Word
    SCRL6P    // Minor Sequencer
    SCRL6Q    // Teleport Field
    SCRL6R    // Spider Spawn
    SCRL6S    // Spell Immunity
    SCRL7E    // Invisible Stalker
    SCRL7F    // Globe of Invunerability
    SCRL7G    // Tenser's Transformation
    SCRL7H    // Flesh to Stone
    SCRL7I    // Death Spell
    SCRL9Z    // Freedom
    SCRLA4    // Limited Wish
    SCRL9C    // Improved Mantle
    SCRL8R    // Mordenkainen's Sword
    SCRL8H    // Warding Whip
    SCRL8O    // Finger of Death
    SCRL7T    // Disintegrate
    SCRL8I    // Cacofiend
    RESTORE   // Restoration
 // these are RR's additions
    BLUN01    // Club
    ~RR#SAP01~  // Sap
    ~RR#BOW03~  // Composite Short Bow +1
    ~RR#BUC02~  // Buckler +1

  LPF store INT_VAR
    sell=155
    buy=25
    steal=0
    fence=1 // he'll buy anything, else the visiting 'drow' party might become upset :)
            // yeah, and it makes the best place ever to sell stolen stuff - quite fine, since it's as late as in Ch.5
  END

  ADD_STORE_ITEM misc5k   LAST #0 #0 #0 IDENTIFIED #1   // illithium ore

  ADD_STORE_ITEM POTN20   LAST #1 #0 #0 IDENTIFIED #1   // Antidote
  ADD_STORE_ITEM POTN36   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Master Thievery
  ADD_STORE_ITEM POTN19   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Agility
  ADD_STORE_ITEM POTN29   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Genius
  ADD_STORE_ITEM POTN22   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Cold Resistance
  ADD_STORE_ITEM POTN12   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Stone Giant Strength
  ADD_STORE_ITEM POTN11   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Invulnerability
  ADD_STORE_ITEM POTN17   LAST #1 #0 #0 IDENTIFIED #1   // Elixir of Health
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Extra Healing
  ADD_STORE_ITEM POTN34   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Magic Protection

  ADD_STORE_ITEM PLAT02   LAST #0 #0 #0 IDENTIFIED #1   // Plate Mail +1
  ADD_STORE_ITEM LEAT02   LAST #0 #0 #0 IDENTIFIED #1   // Leather Armor +1
  ADD_STORE_ITEM LEAT05   LAST #0 #0 #0 IDENTIFIED #1   // Studded Leather Armor +1
  ADD_STORE_ITEM CHAN02   LAST #0 #0 #0 IDENTIFIED #1   // Chain Mail +1
  ADD_STORE_ITEM CHAN05   LAST #0 #0 #0 IDENTIFIED #1   // Splint Mail +1
  ADD_STORE_ITEM SHLD02   LAST #0 #0 #0 IDENTIFIED #1   // Small Shield +1
  ADD_STORE_ITEM SHLD04   LAST #0 #0 #0 IDENTIFIED #1   // Medium Shield +1
  ADD_STORE_ITEM SHLD06   LAST #0 #0 #0 IDENTIFIED #1   // Large Shield +1
  ADD_STORE_ITEM SW1H08   LAST #0 #0 #0 IDENTIFIED #1   // Short Sword +1
  ADD_STORE_ITEM BLUN05   LAST #0 #0 #0 IDENTIFIED #1   // Mace +1
  ADD_STORE_ITEM BLUN07   LAST #0 #0 #0 IDENTIFIED #1   // Morning Star +1
  ADD_STORE_ITEM XBOW02   LAST #0 #0 #0 IDENTIFIED #1   // Heavy Crossbow +1
  ADD_STORE_ITEM XBOW05   LAST #0 #0 #0 IDENTIFIED #1   // Light Crossbow +1
  ADD_STORE_ITEM SLNG02   LAST #0 #0 #0 IDENTIFIED #1   // Sling +1
  ADD_STORE_ITEM AX1H02   LAST #0 #0 #0 IDENTIFIED #1   // Battle Axe +1
  ADD_STORE_ITEM DAGG02   LAST #0 #0 #0 IDENTIFIED #1   // Dagger +1

  ADD_STORE_ITEM DART01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED // Dart
  ADD_STORE_ITEM DART02   LAST #40 #0 #0 IDENTIFIED #2  // Dart +1
  ADD_STORE_ITEM BOLT01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED // Bolt
  ADD_STORE_ITEM BOLT06   LAST #20 #0 #0 IDENTIFIED #2  // Bolt +2
  ADD_STORE_ITEM BULL01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED // Bullet
  ADD_STORE_ITEM BULL03   LAST #20 #0 #0 IDENTIFIED #2  // Bullet +2

  ADD_STORE_ITEM SCRL7G   LAST #1 #0 #0 IDENTIFIED #1   // Tenser's Transformation

  ADD_STORE_ITEM RESTORE  LAST #1 #0 #0 IDENTIFIED #1   // Restoration

END BUT_ONLY

///////////////////////
/*
// UDSVIR04 - Innkeeper
// 
// svirf innkeeper, can't trade

COPY_EXISTING udsvir04.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END

END BUT_ONLY
*/
////////////////////////////////

// UDSVIR05 - Therndle Daglefodd
// 
// he asks to rescue his imprisoned son
// give him stuff related to illusions, stone, mining, some combat too

// 100% stock overwrite

COPY_EXISTING udsvir05.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM
    PLAT10    // Plate Mail +1
    LEAT02    // Leather Armor +1
    LEAT05    // Studded Leather Armor +1
    CHAN02    // Chain Mail +1
    CHAN05    // Splint Mail +1
    SHLD02    // Small Shield +1
    SHLD04    // Medium Shield +1
    SHLD06    // Large Shield +1
    SW1H02    // Bastard Sword +1
    SW1H05    // Long Sword +1
    SW1H08    // Short Sword +1
    SW1H22    // Scimitar +1
    SW2H02    // Two Handed Sword +1
    SW1H44    // Katana +1
    SPER02    // Spear +1
    BLUN03    // Flail +1
    BLUN05    // Mace +1
    BLUN07    // Morning Star +1
    XBOW02    // Heavy Crossbow +1
    XBOW05    // Light Crossbow +1
    BOW02     // Composite Long Bow +1
    BOW04     // Long Bow +1
    BOW06     // Short Bow +1
    SLNG02    // Sling +1
    AX1H02    // Battle Axe +1
    DAGG02    // Dagger +1
    HALB02    // Halberd +1
    DART01    // Dart
    DART02    // Dart +1
    AROW01    // Arrows
    AROW11    // Arrow +2
    BOLT01    // Bolt
    BOLT06    // Bolt +2
    BULL01    // Bullet
    BULL03    // Bullet +2
    POTN20    // Antidote
    POTN36    // Potion of Master Thievery
    POTN19    // Potion of Agility
    POTN29    // Potion of Genius
    POTN22    // Potion of Cold Resistance
    POTN12    // Potion of Stone Giant Strength
    SCRL6D    // Find Familiar
    SCRL6E    // Power Word Sleep
    SCRL6F    // Ray of Enfeeblement
    SCRL6G    // Minor Spell Deflection
    SCRL6H    // Protection from Fire
    SCRL6O    // Secret Word
    SCRL6P    // Minor Sequencer
    SCRL6Q    // Teleport Field
    SCRL6R    // Spider Spawn
    SCRL6S    // Spell Immunity
    SCRL7E    // Invisible Stalker
    SCRL7F    // Globe of Invunerability
    SCRL7G    // Tenser's Transformation
    SCRL7H    // Flesh to Stone
    SCRL7I    // Death Spell
    RESTORE   // Restoration
 // these are RR's additions
    ~RR#BOW03~  // Composite Short Bow +1
    ~RR#BUC02~  // Buckler +1

  LPF store INT_VAR
    sell=155
    buy=25
    steal=65
    fence=0
  END

  ADD_STORE_ITEM LEAT01   LAST #0 #0 #0 IDENTIFIED #2   // Leather Armor
  ADD_STORE_ITEM LEAT04   LAST #0 #0 #0 IDENTIFIED #2   // Studded Leather Armor
  ADD_STORE_ITEM CHAN04   LAST #0 #0 #0 IDENTIFIED #2   // Splint Mail
  ADD_STORE_ITEM CHAN01   LAST #0 #0 #0 IDENTIFIED #2   // Chain Mail Armor
  ADD_STORE_ITEM LEAT05   LAST #0 #0 #0 IDENTIFIED #1   // Studded Leather Armor +1
  ADD_STORE_ITEM CHAN02   LAST #0 #0 #0 IDENTIFIED #1   // Chain Mail +1

  ADD_STORE_ITEM SHLD08   LAST #0 #0 #0 IDENTIFIED #5   // Buckler
  ADD_STORE_ITEM SHLD01   LAST #0 #0 #0 IDENTIFIED #5   // Small Shield
  ADD_STORE_ITEM SHLD17   LAST #0 #0 #0 IDENTIFIED #1   // Buckler +1
  ADD_STORE_ITEM SHLD02   LAST #0 #0 #0 IDENTIFIED #1   // Small Shield +1

  ADD_STORE_ITEM HELM01   LAST #0 #0 #0 IDENTIFIED #10  // Helmet

  ADD_STORE_ITEM STAF01   LAST #0 #0 #0 IDENTIFIED #5   // Quarterstaff
  ADD_STORE_ITEM DAGG01   LAST #0 #0 #0 IDENTIFIED #5   // Dagger
  ADD_STORE_ITEM DAGG02   LAST #0 #0 #0 IDENTIFIED #1   // Dagger +1
  ADD_STORE_ITEM HAMM01   LAST #0 #0 #0 IDENTIFIED #5   // War Hammer
  ADD_STORE_ITEM HAMM08   LAST #0 #0 #0 IDENTIFIED #1   // War Hammer +2

  ADD_STORE_ITEM XBOW02   LAST #0 #0 #0 IDENTIFIED #1   // Heavy Crossbow +1
  ADD_STORE_ITEM XBOW05   LAST #0 #0 #0 IDENTIFIED #1   // Light Crossbow +1
  ADD_STORE_ITEM BOLT01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED  // Bolt
  ADD_STORE_ITEM BOLT02   LAST #20 #0 #0 IDENTIFIED #2  // Bolt +1
  ADD_STORE_ITEM BOLT06   LAST #20 #0 #0 IDENTIFIED #1  // Bolt +2

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #10  // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Extra Healing
  ADD_STORE_ITEM POTN20   LAST #1 #0 #0 IDENTIFIED #2   // Antidote
  ADD_STORE_ITEM POTN12   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Stone Giant Strength
  ADD_STORE_ITEM POTN46   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Stone Form
  ADD_STORE_ITEM POTN18   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Absorbtion 

  ADD_STORE_ITEM SCRL71   LAST #1 #0 #0 IDENTIFIED #3   // Blindness
  ADD_STORE_ITEM SCRL83   LAST #1 #0 #0 IDENTIFIED #3   // Chromatic Orb
  ADD_STORE_ITEM SCRL66   LAST #1 #0 #0 IDENTIFIED #3   // Grease
  ADD_STORE_ITEM SCRL76   LAST #1 #0 #0 IDENTIFIED #3   // Infravision
  ADD_STORE_ITEM SCRL5U   LAST #1 #0 #0 IDENTIFIED #3   // Reflected Image
  ADD_STORE_ITEM SCRL80   LAST #1 #0 #0 IDENTIFIED #3   // Shocking Grasp
  ADD_STORE_ITEM SCRLA6   LAST #1 #0 #0 IDENTIFIED #3   // Spook

  ADD_STORE_ITEM SCRL85   LAST #1 #0 #0 IDENTIFIED #3   // Blur
  ADD_STORE_ITEM SCRL90   LAST #1 #0 #0 IDENTIFIED #3   // Invisibilty
  ADD_STORE_ITEM SCRL91   LAST #1 #0 #0 IDENTIFIED #3   // Knock
  ADD_STORE_ITEM SCRL96   LAST #1 #0 #0 IDENTIFIED #3   // Mirror Image

  ADD_STORE_ITEM SCRL1T   LAST #1 #0 #0 IDENTIFIED #2   // Ghost Armor
  ADD_STORE_ITEM SCRL1J   LAST #1 #0 #0 IDENTIFIED #2   // Invisibility 10' Radius
  ADD_STORE_ITEM SCRL1M   LAST #1 #0 #0 IDENTIFIED #2   // Non-Detection
  ADD_STORE_ITEM SCRL1P   LAST #1 #0 #0 IDENTIFIED #2   // Skull Trap

  ADD_STORE_ITEM SCRL1Y   LAST #1 #0 #0 IDENTIFIED #2   // Improved Invisibility
  ADD_STORE_ITEM SCRL6O   LAST #1 #0 #0 IDENTIFIED #2   // Secret Word
  ADD_STORE_ITEM SCRL2B   LAST #1 #0 #0 IDENTIFIED #2   // Stoneskin

  ADD_STORE_ITEM SCRL7C   LAST #1 #0 #0 IDENTIFIED #1   // Conjure Lesser Earth Elemental
  ADD_STORE_ITEM SCRL2H   LAST #1 #0 #0 IDENTIFIED #1   // Shadow Door

  ADD_STORE_ITEM SCRL7Z   LAST #1 #0 #0 IDENTIFIED #1   // Conjure Earth Elemental
  ADD_STORE_ITEM SCRL7H   LAST #1 #0 #0 IDENTIFIED #1   // Flesh to Stone
  ADD_STORE_ITEM SCRL7K   LAST #1 #0 #0 IDENTIFIED #1   // Mislead
  ADD_STORE_ITEM SCRL8C   LAST #1 #0 #0 IDENTIFIED #1   // Stone to Flesh

  ADD_STORE_ITEM SCRL8W   LAST #1 #0 #0 IDENTIFIED #1   // Mass Invisibility

  ADD_STORE_ITEM SCRL15   LAST #1 #0 #0 IDENTIFIED #3   // Protection from Petrification
  ADD_STORE_ITEM SCRLPET  LAST #1 #0 #0 IDENTIFIED #3   // Stone to Flesh Scroll
  ADD_STORE_ITEM SCRL63   LAST #1 #0 #0 IDENTIFIED #1   // Raise Dead
  ADD_STORE_ITEM RESTORE  LAST #1 #0 #0 IDENTIFIED #1   // Restoration

  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM RING05   LAST #3 #0 #0 IDENTIFIED #1   // Ring of Invisibility
  END ELSE BEGIN
    ADD_STORE_ITEM RING05   LAST #1 #0 #0 IDENTIFIED #1   // Ring of Invisibility
  END

// i'm not a spec when it comes to mineralogy, if you think some of
// these gems don't belong to Underdark then do go ahead and fix it

  ADD_STORE_ITEM misc20   LAST #0 #0 #0 IDENTIFIED #6   // bloodstone
  ADD_STORE_ITEM misc22   LAST #0 #0 #0 IDENTIFIED #11  // andar
  ADD_STORE_ITEM misc23   LAST #0 #0 #0 IDENTIFIED #7   // jasper
  ADD_STORE_ITEM misc24   LAST #0 #0 #0 IDENTIFIED #3   // tchazar
  ADD_STORE_ITEM misc25   LAST #0 #0 #0 IDENTIFIED #5   // zircone
  ADD_STORE_ITEM misc29   LAST #0 #0 #0 IDENTIFIED #5   // ziose
  ADD_STORE_ITEM misc34   LAST #0 #0 #0 IDENTIFIED #3   // garnet
  ADD_STORE_ITEM misc37   LAST #0 #0 #0 IDENTIFIED #2   // sphene

END BUT_ONLY

/////////////////////
// Throne of Bhaal //
/////////////////////

/////////////////////////////

// 25SPELL - Lazarus Librarus
// 
// Saradush archmage

// 100% stock overwrite

COPY_EXISTING 25spell.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR magic=1 END
  REMOVE_STORE_ITEM 
    SCRL03    // Protection from Acid
    SCRL04    // Protection from Cold
    SCRL05    // Protection from Electricity
    SCRL06    // Protection from Fire
    SCRL08    // Protection from Poison
    SCRL09    // Protection from Undead
    SCRL68    // Burning Hands
    SCRL69    // Charm Person
    SCRL70    // Color Spray
    SCRL80    // Shocking Grasp
    SCRL84    // Larloch's Minor Drain
    SCRL79    // Shield
    SCRL77    // Magic Missile
    SCRL82    // Chill Touch
    SCRL83    // Chromatic Orb
    SCRL75    // Identify
    SCRL76    // Infravision
    SCRL5U    // Reflected Image
    SCRLA6    // Spook
    SCRL71    // Blindness
    SCRL78    // Protection From Evil
    SCRL67    // Armor
    SCRL66    // Grease
    SCRL6D    // Find Familiar
    SCRL72    // Friends
    SCRL91    // Knock
    SCRL98    // Strength
    SCRL3G    // Vocalize
    SCRL1C    // Ghoul Touch
    SCRL89    // Horror
    SCRL92    // Know Alignment
    SCRL87    // Detect Invisibilty
    SCRL86    // Detect Evil
    SCRL1B    // Agannazar's Scorcher
    SCRL99    // Web
    SCRL3G    // Vocalize
    SCRL97    // Stinking Cloud
    SCRL85    // Blur
    SCRLA2    // Deafness
    SCRL90    // Invisibilty
    SCRL96    // Mirror Image
    SCRL94    // Resist Fear
    SCRL6E    // Power Word Sleep
    SCRL95    // Melf's Acid Arrow
    SCRLA3    // Glitterdust
    SCRL6F    // Ray of Enfeeblement
    SCRL93    // Luck
    SCRL1H    // Haste
    SCRL1S    // Dire Charm
    SCRL1O    // Slow
    SCRL1P    // Skull Trap
    SCRL6L    // Hold Undead
    SCRL1Q    // Vampiric Touch
    SCRL6K    // Detect Illusion
    SCRL1D    // Clairvoyance
    SCRLA5    // Melf's Minute Meteor
    SCRL1K    // Lightning Bolt
    SCRL1G    // Fireball
    SCRL1J    // Invisibility 10' Radius
    SCRL6J    // Spell Thrust
    SCRL1N    // Protection From Normal Missiles
    SCRL6G    // Minor Spell Deflection
    SCRLA7    // Remove Magic
    SCRL1M    // Non-Detection
    SCRL6I    // Protection from Cold
    SCRL6H    // Protection from Fire
    SCRL1E    // Dispel Magic
    SCRL1T    // Ghost Armor
    SCRL1L    // Monster Summoning I
    SCRL1F    // Flame Arrow
    SCRL1I    // Hold Person
    SCRL5J    // Oliluke's Resilient Sphere
    SCRL5L    // Polymorph Other
    SCRL5M    // Polymorph Self
    SCRL6Q    // Teleport Field
    SCRLA1    // Wizard Eye
    SCRLA8    // Contagion
    SCRL5K    // Spirit Armor
    SCRLAQ    // Farsight
    SCRL6P    // Minor Sequencer
    SCRL1X    // Ice Storm
    SCRL6N    // Fireshield (Red)
    SCRL1W    // Fireshield (Blue)
    SCRL2B    // Stoneskin
    SCRL1Y    // Improved Invisibility
    SCRL1Z    // Minor Globe of Invulnerability
    SCRL5G    // Remove Curse
    SCRL6O    // Secret Word
    SCRL2A    // Monster Summoning II
    SCRL6R    // Spider Spawn
    SCRL1U    // Confusion
    SCRL5I    // Greater Malison
    SCRL5H    // Emotion
    SCRL6M    // Enchanted Weapon
    SCRL2D    // Animate Dead
    SCRL6W    // Oracle
    SCRL6Z    // Phantom Blade
    SCRL2E    // Cloudkill
    SCRL2F    // Cone of Cold
    SCRLAR    // Sunfire
    SCRL2H    // Shadow Door
    SCRL6U    // Breach
    SCRL6V    // Lower Resistance
    SCRL7D    // Minor Spell Turning
    SCRL6S    // Spell Immunity
    SCRL8X    // Spell Shield
    SCRL6Y    // Protection from Acid
    SCRL5T    // Protection from Electricity
    SCRL6T    // Protection From Normal Weapons
    SCRL7B    // Conjure Lesser Air Elemental
    SCRL7C    // Conjure Lesser Earth Elemental
    SCRL6X    // Conjure Lesser Fire Elemental
    SCRL2G    // Monster Summoning III
    SCRL5O    // Hold Monster
    SCRL5P    // Chaos
    SCRL5N    // Domination
    SCRL5Q    // Feeblemind
    SCRL7T    // Disintegrate
    SCRL7H    // Flesh to Stone
    SCRL8C    // Stone to Flesh
    SCRL7G    // Tenser's Transformation
    SCRL7Q    // Improved Haste
    SCRL7I    // Death Spell
    SCRL7M    // True Sight
    SCRL7S    // Chain Lightning
    SCRL7U    // Contingency
    SCRL7R    // Death Fog
    SCRL7K    // Mislead
    SCRL7V    // Spell Deflection
    SCRL7F    // Globe of Invunerability
    SCRL7L    // Pierce Magic
    SCRL7J    // Protection From Magic Energy
    SCRL7O    // Protection From Magic Weapons
    SCRL7E    // Invisible Stalker
    SCRL8B    // Summon Nishru
    SCRL8A    // Carrion Summons
    SCRL7W    // Wyvern Call
    SCRL7Y    // Conjure Air Elemental
    SCRL7Z    // Conjure Earth Elemental
    SCRL7X    // Conjure Fire Elemental
    SCRL7P    // Power Word Silence
    SCRL8M    // Sphere of Chaos
    SCRL8G    // Ruby Ray of Reversal
    SCRL8V    // Control Undead
    SCRL8O    // Finger of Death
    SCRL8R    // Mordenkainen's Sword
    SCRL8N    // Delayed Blast Fireball
    SCRL8L    // Spell Sequencer
    SCRL8F    // Project Image
    SCRL8W    // Mass Invisibility
    SCRL8E    // Protection From The Elements
    SCRL8D    // Spell Turning
    SCRL8H    // Warding Whip
    SCRL8J    // Mantle
    SCRLA4    // Limited Wish
    SCRL8I    // Cacofiend
    SCRL8Q    // Power Word Stun
    SCRL8T    // Summon Djinni
    SCRL8S    // Summon Efreet
    SCRL8U    // Summon Hakeashar
    SCRL8P    // Prismatic Spray
    SCRL9G    // Abi Dalzim's Horrid Wilting
    SCRLB1    // Bigby's Clenched Fist
    SCRL9E    // Incendiary Cloud
    SCRL9D    // Spell Trigger
    SCRL8Z    // Simulacrum
    SCRL9A    // Pierce Shield
    SCRL9C    // Improved Mantle
    SCRL8Y    // Protection From Energy
    SCRL9J    // Power Word Blind
    SCRL9H    // Maze
    SCRL9B    // Summon Fiend
    SCRLAO    // Symbol Death
    SCRL9F    // Symbol Fear
    SCRLAP    // Symbol Stun
    SCRL9Y    // Shapechange
    SCRL9R    // Time Stop
    SCRL9W    // Energy Drain
    SCRL9V    // Wail of the Banshee
    SCRL9X    // Black Blade of Disaster
    SCRL9Q    // Chain Contingency
    SCRL9T    // Meteor Swarm
    SCRL9M    // Spellstrike
    SCRL9P    // Absolute Immunity
    SCRL9Z    // Freedom
    SCRL9S    // Imprisonment
    SCRL9L    // Spell Trap
    SCRL9U    // Power Word Kill
    SCRL9N    // Gate
    SCRLB2    // Bigby's Crushing Hand
    SCRLB4    // Wish
    RESTORE   // Restoration
    CLCK12    // Knave's Robe
    CLCK13    // Traveller's Robe
    CLCK14    // Adventurer's Robe
    CLCK15    // Robe of the Good Archmagi
    CLCK16    // Robe of the Neutral Archmagi
    CLCK17    // Robe of the Evil Archmagi
    CLCK09    // Mage Robe of Cold Resistance
    CLCK10    // Mage Robe of Fire Resistance
    CLCK11    // Mage Robe of Electric Resistance
    POTN02    // Potion of Fire Resistance
    POTN03    // Potion of Hill Giant Strength
    POTN04    // Potion of Frost Giant Strength
    POTN05    // Potion of Fire Giant Strength
    POTN06    // Potion of Cloud Giant Strength
    POTN08    // Potion of Healing
    POTN09    // Potion of Heroism
    POTN10    // Potion of Invisibility
    POTN14    // Oil of Speed
    POTN17    // Elixir of Health
    POTN19    // Potion of Agility
    POTN20    // Antidote
    POTN22    // Potion of Cold Resistance
    POTN31    // Potion of Insulation
    POTN36    // Potion of Master Thievery
    POTN39    // Potion of Perception
    POTN42    // Potion of Regeneration 
    POTN44    // Potion of Strength
    POTN45    // Potion of Freedom
    POTN52    // Potion of Extra Healing
    POTN55    // Potion of Superior Healing
    BAG06     // Potion Case
    BAG03G    // Scroll Case
    BAG31     // Bag of Holding
    RING02    // Ring of Fire Resistance
    BOOT01    // Boots of Speed
    HELM23    // Golden Ioun Stone

    // spell revisions
    scrl1v     // dimension door
    scrlw801   // ghost form

  LPF store INT_VAR
    sell=200
    buy=10
    steal=0
    fence=0
  END

  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM wand02   LAST #10 #0 #0 IDENTIFIED #1  // fear
    ADD_STORE_ITEM wand03   LAST #10 #0 #0 IDENTIFIED #1  // mm
    ADD_STORE_ITEM wand04   LAST #10 #0 #0 IDENTIFIED #1  // paralyze
    ADD_STORE_ITEM wand05   LAST #10 #0 #0 IDENTIFIED #1  // fire
    ADD_STORE_ITEM wand06   LAST #10 #0 #0 IDENTIFIED #1  // frost
    ADD_STORE_ITEM wand07   LAST #10 #0 #0 IDENTIFIED #1  // lightning
    ADD_STORE_ITEM wand08   LAST #10 #0 #0 IDENTIFIED #1  // sleep
    ADD_STORE_ITEM wand09   LAST #10 #0 #0 IDENTIFIED #1  // polymorph
    ADD_STORE_ITEM wand10   LAST #10 #0 #0 IDENTIFIED #1  // monster
    ADD_STORE_ITEM wand13   LAST #10 #0 #0 IDENTIFIED #1  // cloudkill
  END ELSE BEGIN
    ADD_STORE_ITEM wand02   LAST #50 #0 #0 IDENTIFIED #1  // fear
    ADD_STORE_ITEM wand03   LAST #50 #0 #0 IDENTIFIED #1  // mm
    ADD_STORE_ITEM wand04   LAST #50 #0 #0 IDENTIFIED #1  // paralyze
    ADD_STORE_ITEM wand05   LAST #50 #50 #0 IDENTIFIED #1 // fire
    ADD_STORE_ITEM wand06   LAST #50 #0 #0 IDENTIFIED #1  // frost
    ADD_STORE_ITEM wand07   LAST #50 #0 #0 IDENTIFIED #1  // lightning
    ADD_STORE_ITEM wand08   LAST #50 #0 #0 IDENTIFIED #1  // sleep
    ADD_STORE_ITEM wand09   LAST #50 #0 #0 IDENTIFIED #1  // polymorph
    ADD_STORE_ITEM wand10   LAST #50 #0 #0 IDENTIFIED #1  // monster
    ADD_STORE_ITEM wand13   LAST #50 #0 #0 IDENTIFIED #1  // cloudkill
  END

  ADD_STORE_ITEM SCRL03   LAST #1 #0 #0 IDENTIFIED #5   // Protection from Acid
  ADD_STORE_ITEM SCRL04   LAST #1 #0 #0 IDENTIFIED #5   // Protection from Cold
  ADD_STORE_ITEM SCRL05   LAST #1 #0 #0 IDENTIFIED #5   // Protection from Electricity
  ADD_STORE_ITEM SCRL06   LAST #1 #0 #0 IDENTIFIED #5   // Protection from Fire
  ADD_STORE_ITEM SCRL07   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Magic
  ADD_STORE_ITEM SCRL08   LAST #1 #0 #0 IDENTIFIED #5   // Protection from Poison
  ADD_STORE_ITEM SCRL09   LAST #1 #0 #0 IDENTIFIED #5   // Protection from Undead
  ADD_STORE_ITEM SCRL15   LAST #1 #0 #0 IDENTIFIED #5   // Protection from Petrification

  ADD_STORE_ITEM SCRL67   LAST #1 #0 #0 IDENTIFIED #5   // Armor
  ADD_STORE_ITEM SCRL71   LAST #1 #0 #0 IDENTIFIED #5   // Blindness
  ADD_STORE_ITEM SCRL68   LAST #1 #0 #0 IDENTIFIED #5   // Burning Hands
  ADD_STORE_ITEM SCRL69   LAST #1 #0 #0 IDENTIFIED #5   // Charm Person
  ADD_STORE_ITEM SCRL82   LAST #1 #0 #0 IDENTIFIED #5   // Chill Touch
  ADD_STORE_ITEM SCRL83   LAST #1 #0 #0 IDENTIFIED #5   // Chromatic Orb
  ADD_STORE_ITEM SCRL70   LAST #1 #0 #0 IDENTIFIED #5   // Color Spray
  ADD_STORE_ITEM SCRL66   LAST #1 #0 #0 IDENTIFIED #5   // Grease
  ADD_STORE_ITEM SCRL6D   LAST #1 #0 #0 IDENTIFIED #5   // Find Familiar
  ADD_STORE_ITEM SCRL72   LAST #1 #0 #0 IDENTIFIED #5   // Friends
  ADD_STORE_ITEM SCRL75   LAST #1 #0 #0 IDENTIFIED #5   // Identify
  ADD_STORE_ITEM SCRL76   LAST #1 #0 #0 IDENTIFIED #5   // Infravision
  ADD_STORE_ITEM SCRL84   LAST #1 #0 #0 IDENTIFIED #5   // Larloch's Minor Drain
  ADD_STORE_ITEM SCRL77   LAST #1 #0 #0 IDENTIFIED #5   // Magic Missile
  ADD_STORE_ITEM SCRL78   LAST #1 #0 #0 IDENTIFIED #5   // Protection From Evil
  ADD_STORE_ITEM SCRL73   LAST #1 #0 #0 IDENTIFIED #5   // Protection From Petrification
  ADD_STORE_ITEM SCRL5U   LAST #1 #0 #0 IDENTIFIED #5   // Reflected Image
  ADD_STORE_ITEM SCRL79   LAST #1 #0 #0 IDENTIFIED #5   // Shield
  ADD_STORE_ITEM SCRL80   LAST #1 #0 #0 IDENTIFIED #5   // Shocking Grasp
  ADD_STORE_ITEM SCRL81   LAST #1 #0 #0 IDENTIFIED #5   // Sleep
  ADD_STORE_ITEM SCRLA6   LAST #1 #0 #0 IDENTIFIED #5   // Spook

  ADD_STORE_ITEM SCRL1B   LAST #1 #0 #0 IDENTIFIED #5   // Agannazar's Scorcher
  ADD_STORE_ITEM SCRL85   LAST #1 #0 #0 IDENTIFIED #5   // Blur
  ADD_STORE_ITEM SCRLA2   LAST #1 #0 #0 IDENTIFIED #5   // Deafness
  ADD_STORE_ITEM SCRL86   LAST #1 #0 #0 IDENTIFIED #5   // Detect Evil
  ADD_STORE_ITEM SCRL87   LAST #1 #0 #0 IDENTIFIED #5   // Detect Invisibilty
  ADD_STORE_ITEM SCRL1C   LAST #1 #0 #0 IDENTIFIED #5   // Ghoul Touch
  ADD_STORE_ITEM SCRLA3   LAST #1 #0 #0 IDENTIFIED #5   // Glitterdust
  ADD_STORE_ITEM SCRL89   LAST #1 #0 #0 IDENTIFIED #5   // Horror
  ADD_STORE_ITEM SCRL90   LAST #1 #0 #0 IDENTIFIED #5   // Invisibilty
  ADD_STORE_ITEM SCRL91   LAST #1 #0 #0 IDENTIFIED #5   // Knock
  ADD_STORE_ITEM SCRL92   LAST #1 #0 #0 IDENTIFIED #5   // Know Alignment
  ADD_STORE_ITEM SCRL93   LAST #1 #0 #0 IDENTIFIED #5   // Luck
  ADD_STORE_ITEM SCRL95   LAST #1 #0 #0 IDENTIFIED #5   // Melf's Acid Arrow
  ADD_STORE_ITEM SCRL96   LAST #1 #0 #0 IDENTIFIED #5   // Mirror Image
  ADD_STORE_ITEM SCRL6E   LAST #1 #0 #0 IDENTIFIED #5   // Power Word Sleep
  ADD_STORE_ITEM SCRL6F   LAST #1 #0 #0 IDENTIFIED #5   // Ray of Enfeeblement
  ADD_STORE_ITEM SCRL94   LAST #1 #0 #0 IDENTIFIED #5   // Resist Fear
  ADD_STORE_ITEM SCRL97   LAST #1 #0 #0 IDENTIFIED #5   // Stinking Cloud
  ADD_STORE_ITEM SCRL98   LAST #1 #0 #0 IDENTIFIED #5   // Strength
  ADD_STORE_ITEM SCRL3G   LAST #1 #0 #0 IDENTIFIED #5   // Vocalize
  ADD_STORE_ITEM SCRL99   LAST #1 #0 #0 IDENTIFIED #5   // Web

  ADD_STORE_ITEM SCRL1D   LAST #1 #0 #0 IDENTIFIED #5   // Clairvoyance
  ADD_STORE_ITEM SCRL6K   LAST #1 #0 #0 IDENTIFIED #5   // Detect Illusion
  ADD_STORE_ITEM SCRL1S   LAST #1 #0 #0 IDENTIFIED #5   // Dire Charm
  ADD_STORE_ITEM SCRL1E   LAST #1 #0 #0 IDENTIFIED #5   // Dispel Magic
  ADD_STORE_ITEM SCRL1G   LAST #1 #0 #0 IDENTIFIED #5   // Fireball
  ADD_STORE_ITEM SCRL1F   LAST #1 #0 #0 IDENTIFIED #5   // Flame Arrow
  ADD_STORE_ITEM SCRL1T   LAST #1 #0 #0 IDENTIFIED #5   // Ghost Armor
  ADD_STORE_ITEM SCRL1H   LAST #1 #0 #0 IDENTIFIED #5   // Haste
  ADD_STORE_ITEM SCRL1I   LAST #1 #0 #0 IDENTIFIED #5   // Hold Person
  ADD_STORE_ITEM SCRL6L   LAST #1 #0 #0 IDENTIFIED #5   // Hold Undead
  ADD_STORE_ITEM SCRL1J   LAST #1 #0 #0 IDENTIFIED #5   // Invisibility 10' Radius
  ADD_STORE_ITEM SCRL1K   LAST #1 #0 #0 IDENTIFIED #5   // Lightning Bolt
  ADD_STORE_ITEM SCRLA5   LAST #1 #0 #0 IDENTIFIED #5   // Melf's Minute Meteor
  ADD_STORE_ITEM SCRL6G   LAST #1 #0 #0 IDENTIFIED #5   // Minor Spell Deflection
  ADD_STORE_ITEM SCRL1L   LAST #1 #0 #0 IDENTIFIED #5   // Monster Summoning I
  ADD_STORE_ITEM SCRL1M   LAST #1 #0 #0 IDENTIFIED #5   // Non-Detection
  PATCH_IF comp_sr=0 BEGIN
    ADD_STORE_ITEM SCRL6I   LAST #1 #0 #0 IDENTIFIED #5   // Protection from Cold
    ADD_STORE_ITEM SCRL6H   LAST #1 #0 #0 IDENTIFIED #5   // Protection from Fire
  END
  ADD_STORE_ITEM SCRL1N   LAST #1 #0 #0 IDENTIFIED #5   // Protection From Normal Missiles
  ADD_STORE_ITEM SCRLA7   LAST #1 #0 #0 IDENTIFIED #5   // Remove Magic
  ADD_STORE_ITEM SCRL1P   LAST #1 #0 #0 IDENTIFIED #5   // Skull Trap
  ADD_STORE_ITEM SCRL1O   LAST #1 #0 #0 IDENTIFIED #5   // Slow
  ADD_STORE_ITEM SCRL6J   LAST #1 #0 #0 IDENTIFIED #5   // Spell Thrust
  ADD_STORE_ITEM SCRL1Q   LAST #1 #0 #0 IDENTIFIED #5   // Vampiric Touch

  ADD_STORE_ITEM SCRL5G   LAST #1 #0 #0 IDENTIFIED #5   // Remove Curse/Break Enchantment
  ADD_STORE_ITEM SCRL1U   LAST #1 #0 #0 IDENTIFIED #5   // Confusion
  ADD_STORE_ITEM SCRLA8   LAST #1 #0 #0 IDENTIFIED #5   // Contagion
  PATCH_IF comp_sr=1 BEGIN
    ADD_STORE_ITEM scrl1v   LAST #1 #0 #0 IDENTIFIED #5   // Dimension Door
  END
  ADD_STORE_ITEM SCRL5H   LAST #1 #0 #0 IDENTIFIED #5   // Emotion
  ADD_STORE_ITEM SCRL6M   LAST #1 #0 #0 IDENTIFIED #5   // Enchanted Weapon
  ADD_STORE_ITEM SCRLAQ   LAST #1 #0 #0 IDENTIFIED #5   // Farsight
  ADD_STORE_ITEM SCRL1W   LAST #1 #0 #0 IDENTIFIED #5   // Fireshield (Blue)
  ADD_STORE_ITEM SCRL6N   LAST #1 #0 #0 IDENTIFIED #5   // Fireshield (Red)
  ADD_STORE_ITEM SCRL5I   LAST #1 #0 #0 IDENTIFIED #5   // Greater Malison
  ADD_STORE_ITEM SCRL1X   LAST #1 #0 #0 IDENTIFIED #5   // Ice Storm
  ADD_STORE_ITEM SCRL1Y   LAST #1 #0 #0 IDENTIFIED #5   // Improved Invisibility
  ADD_STORE_ITEM SCRL1Z   LAST #1 #0 #0 IDENTIFIED #5   // Minor Globe of Invulnerability
  ADD_STORE_ITEM SCRL6P   LAST #1 #0 #0 IDENTIFIED #5   // Minor Sequencer
  ADD_STORE_ITEM SCRL2A   LAST #1 #0 #0 IDENTIFIED #5   // Monster Summoning II
  ADD_STORE_ITEM SCRL5J   LAST #1 #0 #0 IDENTIFIED #5   // Oliluke's Resilient Sphere
  ADD_STORE_ITEM SCRL5L   LAST #1 #0 #0 IDENTIFIED #5   // Polymorph Other
  ADD_STORE_ITEM SCRL5M   LAST #1 #0 #0 IDENTIFIED #5   // Polymorph Self
  ADD_STORE_ITEM SCRL6O   LAST #1 #0 #0 IDENTIFIED #5   // Secret Word
  ADD_STORE_ITEM SCRL6R   LAST #1 #0 #0 IDENTIFIED #5   // Spider Spawn
  ADD_STORE_ITEM SCRL5K   LAST #1 #0 #0 IDENTIFIED #5   // Spirit Armor
  ADD_STORE_ITEM SCRL2B   LAST #1 #0 #0 IDENTIFIED #5   // Stoneskin
  ADD_STORE_ITEM SCRL6Q   LAST #1 #0 #0 IDENTIFIED #5   // Teleport Field
  ADD_STORE_ITEM SCRLA1   LAST #1 #0 #0 IDENTIFIED #5   // Wizard Eye

  ADD_STORE_ITEM SCRL2D   LAST #1 #0 #0 IDENTIFIED #3   // Animate Dead
  ADD_STORE_ITEM SCRL6U   LAST #1 #0 #0 IDENTIFIED #3   // Breach
  ADD_STORE_ITEM SCRL5P   LAST #1 #0 #0 IDENTIFIED #3   // Chaos
  ADD_STORE_ITEM SCRL2E   LAST #1 #0 #0 IDENTIFIED #3   // Cloudkill
  ADD_STORE_ITEM SCRL2F   LAST #1 #0 #0 IDENTIFIED #3   // Cone of Cold
  ADD_STORE_ITEM SCRL7B   LAST #1 #0 #0 IDENTIFIED #3   // Conjure Lesser Air Elemental
  ADD_STORE_ITEM SCRL7C   LAST #1 #0 #0 IDENTIFIED #3   // Conjure Lesser Earth Elemental
  ADD_STORE_ITEM SCRL6X   LAST #1 #0 #0 IDENTIFIED #3   // Conjure Lesser Fire Elemental
  ADD_STORE_ITEM SCRL5N   LAST #1 #0 #0 IDENTIFIED #3   // Domination
  ADD_STORE_ITEM SCRL5Q   LAST #1 #0 #0 IDENTIFIED #3   // Feeblemind
  ADD_STORE_ITEM SCRL5O   LAST #1 #0 #0 IDENTIFIED #3   // Hold Monster
  ADD_STORE_ITEM SCRL6V   LAST #1 #0 #0 IDENTIFIED #3   // Lower Resistance
  ADD_STORE_ITEM SCRL7D   LAST #1 #0 #0 IDENTIFIED #3   // Minor Spell Turning
  ADD_STORE_ITEM SCRL2G   LAST #1 #0 #0 IDENTIFIED #3   // Monster Summoning III
  ADD_STORE_ITEM SCRL6W   LAST #1 #0 #0 IDENTIFIED #3   // Oracle
  ADD_STORE_ITEM SCRL6Z   LAST #0 #0 #0 IDENTIFIED #3   // Phantom Blade
  ADD_STORE_ITEM SCRL6Y   LAST #1 #0 #0 IDENTIFIED #3   // Protection from Acid
  PATCH_IF comp_sr=1 BEGIN
    ADD_STORE_ITEM SCRL6I   LAST #1 #0 #0 IDENTIFIED #3   // Protection from Cold
    ADD_STORE_ITEM SCRL6H   LAST #1 #0 #0 IDENTIFIED #3   // Protection from Fire
  END
  ADD_STORE_ITEM SCRL5T   LAST #1 #0 #0 IDENTIFIED #3   // Protection from Electricity
  ADD_STORE_ITEM SCRL6T   LAST #1 #0 #0 IDENTIFIED #3   // Protection From Normal Weapons
  ADD_STORE_ITEM SCRL2H   LAST #1 #0 #0 IDENTIFIED #3   // Shadow Door
  ADD_STORE_ITEM SCRL6S   LAST #1 #0 #0 IDENTIFIED #3   // Spell Immunity
  PATCH_IF comp_sr=0 BEGIN
    ADD_STORE_ITEM SCRL8X   LAST #0 #0 #0 IDENTIFIED #3   // Spell Shield
  END
  ADD_STORE_ITEM SCRLAR   LAST #1 #0 #0 IDENTIFIED #3   // Sunfire

  ADD_STORE_ITEM SCRL8A   LAST #1 #0 #0 IDENTIFIED #3   // Carrion Summons
  ADD_STORE_ITEM SCRL7S   LAST #1 #0 #0 IDENTIFIED #3   // Chain Lightning
  ADD_STORE_ITEM SCRL7Y   LAST #1 #0 #0 IDENTIFIED #3   // Conjure Air Elemental
  ADD_STORE_ITEM SCRL7Z   LAST #1 #0 #0 IDENTIFIED #3   // Conjure Earth Elemental
  ADD_STORE_ITEM SCRL7X   LAST #1 #0 #0 IDENTIFIED #3   // Conjure Fire Elemental
  ADD_STORE_ITEM SCRL7U   LAST #1 #0 #0 IDENTIFIED #3   // Contingency
  ADD_STORE_ITEM SCRL7R   LAST #1 #0 #0 IDENTIFIED #3   // Death Fog
  ADD_STORE_ITEM SCRL7I   LAST #1 #0 #0 IDENTIFIED #3   // Death Spell
  ADD_STORE_ITEM SCRL7T   LAST #1 #0 #0 IDENTIFIED #3   // Disintegrate
  ADD_STORE_ITEM SCRL7H   LAST #1 #0 #0 IDENTIFIED #3   // Flesh to Stone
  ADD_STORE_ITEM SCRL7F   LAST #1 #0 #0 IDENTIFIED #3   // Globe of Invunerability
  ADD_STORE_ITEM SCRL7Q   LAST #1 #0 #0 IDENTIFIED #3   // Improved Haste
  ADD_STORE_ITEM SCRL7E   LAST #1 #0 #0 IDENTIFIED #3   // Invisible Stalker
  ADD_STORE_ITEM SCRL7K   LAST #1 #0 #0 IDENTIFIED #3   // Mislead
  ADD_STORE_ITEM SCRL7L   LAST #1 #0 #0 IDENTIFIED #3   // Pierce Magic
  ADD_STORE_ITEM SCRL7P   LAST #1 #0 #0 IDENTIFIED #3   // Power Word Silence
  ADD_STORE_ITEM SCRL7J   LAST #1 #0 #0 IDENTIFIED #3   // Protection From Magic Energy
  ADD_STORE_ITEM SCRL7O   LAST #1 #0 #0 IDENTIFIED #3   // Protection From Magic Weapons
  ADD_STORE_ITEM SCRL7V   LAST #1 #0 #0 IDENTIFIED #3   // Spell Deflection
  ADD_STORE_ITEM SCRL8C   LAST #1 #0 #0 IDENTIFIED #3   // Stone to Flesh
  ADD_STORE_ITEM SCRL8B   LAST #1 #0 #0 IDENTIFIED #3   // Summon Nishru
  ADD_STORE_ITEM SCRL7G   LAST #1 #0 #0 IDENTIFIED #3   // Tenser's Transformation
  ADD_STORE_ITEM SCRL7M   LAST #1 #0 #0 IDENTIFIED #3   // True Sight
  ADD_STORE_ITEM SCRL7W   LAST #1 #0 #0 IDENTIFIED #3   // Wyvern Call

  ADD_STORE_ITEM SCRL8I   LAST #1 #0 #0 IDENTIFIED #2   // Cacofiend
  ADD_STORE_ITEM SCRL8V   LAST #1 #0 #0 IDENTIFIED #2   // Control Undead
  ADD_STORE_ITEM SCRL8N   LAST #1 #0 #0 IDENTIFIED #2   // Delayed Blast Fireball
  ADD_STORE_ITEM SCRL8O   LAST #1 #0 #0 IDENTIFIED #2   // Finger of Death
  ADD_STORE_ITEM SCRLA4   LAST #1 #0 #0 IDENTIFIED #2   // Limited Wish
  ADD_STORE_ITEM SCRL8J   LAST #1 #0 #0 IDENTIFIED #2   // Mantle
  ADD_STORE_ITEM SCRL8W   LAST #1 #0 #0 IDENTIFIED #2   // Mass Invisibility
  ADD_STORE_ITEM SCRL8R   LAST #1 #0 #0 IDENTIFIED #2   // Mordenkainen's Sword
  ADD_STORE_ITEM SCRL8Q   LAST #1 #0 #0 IDENTIFIED #2   // Power Word Stun
  ADD_STORE_ITEM SCRL8P   LAST #1 #0 #0 IDENTIFIED #2   // Prismatic Spray
  ADD_STORE_ITEM SCRL8F   LAST #1 #0 #0 IDENTIFIED #2   // Project Image
  ADD_STORE_ITEM SCRL8E   LAST #1 #0 #0 IDENTIFIED #2   // Protection From The Elements
  ADD_STORE_ITEM SCRL8G   LAST #1 #0 #0 IDENTIFIED #2   // Ruby Ray of Reversal
  ADD_STORE_ITEM SCRL8L   LAST #1 #0 #0 IDENTIFIED #2   // Spell Sequencer
  ADD_STORE_ITEM SCRL8D   LAST #1 #0 #0 IDENTIFIED #2   // Spell Turning
  ADD_STORE_ITEM SCRL8M   LAST #1 #0 #0 IDENTIFIED #2   // Sphere of Chaos
  ADD_STORE_ITEM SCRL8T   LAST #1 #0 #0 IDENTIFIED #2   // Summon Djinni
  ADD_STORE_ITEM SCRL8S   LAST #1 #0 #0 IDENTIFIED #2   // Summon Efreet
  ADD_STORE_ITEM SCRL8U   LAST #1 #0 #0 IDENTIFIED #2   // Summon Hakeashar
  ADD_STORE_ITEM SCRL8H   LAST #1 #0 #0 IDENTIFIED #2   // Warding Whip

  ADD_STORE_ITEM SCRL9G   LAST #1 #0 #0 IDENTIFIED #2   // Abi Dalzim's Horrid Wilting
  ADD_STORE_ITEM SCRLB1   LAST #1 #0 #0 IDENTIFIED #2   // Bigby's Clenched Fist
  PATCH_IF comp_sr=1 BEGIN
    ADD_STORE_ITEM scrlw801 LAST #1 #0 #0 IDENTIFIED #2   // ghost form
  END
  ADD_STORE_ITEM SCRL9C   LAST #1 #0 #0 IDENTIFIED #2   // Improved Mantle
  ADD_STORE_ITEM SCRL9E   LAST #1 #0 #0 IDENTIFIED #2   // Incendiary Cloud
  ADD_STORE_ITEM SCRL9H   LAST #1 #0 #0 IDENTIFIED #2   // Maze
  ADD_STORE_ITEM SCRL9A   LAST #1 #0 #0 IDENTIFIED #2   // Pierce Shield
  ADD_STORE_ITEM SCRL9J   LAST #1 #0 #0 IDENTIFIED #2   // Power Word Blind
  ADD_STORE_ITEM SCRL8Y   LAST #1 #0 #0 IDENTIFIED #2   // Protection From Energy
  ADD_STORE_ITEM SCRL8Z   LAST #1 #0 #0 IDENTIFIED #2   // Simulacrum
  ADD_STORE_ITEM SCRL9D   LAST #1 #0 #0 IDENTIFIED #2   // Spell Trigger
  ADD_STORE_ITEM SCRL9B   LAST #1 #0 #0 IDENTIFIED #2   // Summon Fiend
  ADD_STORE_ITEM SCRLAO   LAST #1 #0 #0 IDENTIFIED #2   // Symbol Death
  ADD_STORE_ITEM SCRL9F   LAST #1 #0 #0 IDENTIFIED #2   // Symbol Fear
  ADD_STORE_ITEM SCRLAP   LAST #1 #0 #0 IDENTIFIED #2   // Symbol Stun
  PATCH_IF comp_sr=1 BEGIN
    ADD_STORE_ITEM SCRL8X   LAST #0 #0 #0 IDENTIFIED #2   // Spell Shield
  END

  ADD_STORE_ITEM SCRL9P   LAST #1 #0 #0 IDENTIFIED #2   // Absolute Immunity
  ADD_STORE_ITEM SCRLB2   LAST #1 #0 #0 IDENTIFIED #2   // Bigby's Crushing Hand
  ADD_STORE_ITEM SCRL9X   LAST #1 #0 #0 IDENTIFIED #2   // Black Blade of Disaster
  ADD_STORE_ITEM SCRL9Q   LAST #1 #0 #0 IDENTIFIED #2   // Chain Contingency
  ADD_STORE_ITEM SCRL9W   LAST #1 #0 #0 IDENTIFIED #2   // Energy Drain
  ADD_STORE_ITEM SCRL9Z   LAST #1 #0 #0 IDENTIFIED #2   // Freedom
  ADD_STORE_ITEM SCRL9N   LAST #1 #0 #0 IDENTIFIED #2   // Gate
  ADD_STORE_ITEM SCRL9S   LAST #1 #0 #0 IDENTIFIED #2   // Imprisonment
  ADD_STORE_ITEM SCRL9T   LAST #1 #0 #0 IDENTIFIED #2   // Meteor Swarm
  ADD_STORE_ITEM SCRL9U   LAST #1 #0 #0 IDENTIFIED #2   // Power Word Kill
  ADD_STORE_ITEM SCRL9Y   LAST #1 #0 #0 IDENTIFIED #2   // Shapechange
  ADD_STORE_ITEM SCRL9M   LAST #1 #0 #0 IDENTIFIED #2   // Spellstrike
  ADD_STORE_ITEM SCRL9L   LAST #1 #0 #0 IDENTIFIED #2   // Spell Trap
  ADD_STORE_ITEM SCRL9R   LAST #1 #0 #0 IDENTIFIED #2   // Time Stop
  ADD_STORE_ITEM SCRL9V   LAST #1 #0 #0 IDENTIFIED #2   // Wail of the Banshee
  ADD_STORE_ITEM SCRLB4   LAST #1 #0 #0 IDENTIFIED #2   // Wish

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #50  // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #20  // Potion of Extra Healing
  ADD_STORE_ITEM POTN55   LAST #1 #0 #0 IDENTIFIED #10  // Potion of Superior Healing
  ADD_STORE_ITEM POTN20   LAST #1 #0 #0 IDENTIFIED #10  // Antidote
  ADD_STORE_ITEM POTN17   LAST #1 #0 #0 IDENTIFIED #5   // Elixir of Health
  ADD_STORE_ITEM POTN42   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Regeneration 

  ADD_STORE_ITEM POTN44   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Strength
  ADD_STORE_ITEM POTN19   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Agility
  ADD_STORE_ITEM POTN28   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Fortitude
  ADD_STORE_ITEM POTN29   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Genius
  ADD_STORE_ITEM POTN43   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Insight 
  ADD_STORE_ITEM POTN37   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Mind Focusing

  ADD_STORE_ITEM POTN03   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Hill Giant Strength
  ADD_STORE_ITEM POTN12   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Stone Giant Strength
  ADD_STORE_ITEM POTN04   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Frost Giant Strength
  ADD_STORE_ITEM POTN05   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Fire Giant Strength
  ADD_STORE_ITEM POTN06   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Cloud Giant Strength
  ADD_STORE_ITEM POTN07   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Storm Giant Strength

  ADD_STORE_ITEM POTN09   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Heroism
  ADD_STORE_ITEM POTN14   LAST #1 #0 #0 IDENTIFIED #3   // Oil of Speed
  ADD_STORE_ITEM POTN41   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Power

  ADD_STORE_ITEM POTN22   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Cold Resistance
  ADD_STORE_ITEM POTN31   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Insulation
  ADD_STORE_ITEM POTN02   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Fire Resistance
  ADD_STORE_ITEM POTN34   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Magic Protection
  ADD_STORE_ITEM POTN35   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Magic Shielding
  ADD_STORE_ITEM potn33   LAST #1 #0 #0 IDENTIFIED #2   // potion of magic blocking

  ADD_STORE_ITEM potn38   LAST #1 #0 #0 IDENTIFIED #3   // potion of mirrored eyes
  ADD_STORE_ITEM POTN24   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Defense
  ADD_STORE_ITEM POTN11   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Invulnerability
  ADD_STORE_ITEM POTN46   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Stone Form
  ADD_STORE_ITEM POTN18   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Absorbtion 

  ADD_STORE_ITEM POTN30   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Infravision
  ADD_STORE_ITEM POTN39   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Perception
  ADD_STORE_ITEM POTN36   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Master Thievery
  ADD_STORE_ITEM POTN10   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Invisibility
  ADD_STORE_ITEM POTN21   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Clarity
  ADD_STORE_ITEM POTN45   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Freedom

  ADD_STORE_ITEM POTN13   LAST #1 #0 #0 IDENTIFIED #10  // Oil of Fiery Burning
  ADD_STORE_ITEM POTN27   LAST #1 #0 #0 IDENTIFIED #10  // Potion of Firebreath
  ADD_STORE_ITEM POTN26   LAST #1 #0 #0 IDENTIFIED #10  // Potion of Explosions

  ADD_STORE_ITEM CLCK12   LAST #0 #0 #0 IDENTIFIED #1   // Knave's Robe
  ADD_STORE_ITEM CLCK13   LAST #0 #0 #0 IDENTIFIED #1   // Traveller's Robe
  ADD_STORE_ITEM CLCK14   LAST #0 #0 #0 IDENTIFIED #1   // Adventurer's Robe
  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM CLCK18   LAST #0 #0 #0 IDENTIFIED #1   // Knave Robe/Mage Robe of Acid Resistance
  END
  ADD_STORE_ITEM CLCK09   LAST #0 #0 #0 IDENTIFIED #1   // Mage Robe of Cold Resistance
  ADD_STORE_ITEM CLCK10   LAST #0 #0 #0 IDENTIFIED #1   // Mage Robe of Fire Resistance
  ADD_STORE_ITEM CLCK11   LAST #0 #0 #0 IDENTIFIED #1   // Mage Robe of Electric Resistance
  ADD_STORE_ITEM CLCK15   LAST #0 #0 #0 IDENTIFIED #1   // Robe of the Good Archmagi/Robe of the Weave
  ADD_STORE_ITEM CLCK16   LAST #0 #0 #0 IDENTIFIED #1   // Robe of the Neutral Archmagi/Robe of the Battlemage
  ADD_STORE_ITEM CLCK17   LAST #0 #0 #0 IDENTIFIED #1   // Robe of the Evil Archmagi/Robe of Arcane Might

  ADD_STORE_ITEM BAG06    LAST #0 #0 #0 IDENTIFIED #1   // Potion Case
  ADD_STORE_ITEM BAG03G   LAST #0 #0 #0 IDENTIFIED #1   // Scroll Case
  ADD_STORE_ITEM BOOT01   LAST #0 #0 #0 IDENTIFIED #2   // Boots of Speed
  ADD_STORE_ITEM HELM23   LAST #0 #0 #0 IDENTIFIED #1   // Golden Ioun Stone
  ADD_STORE_ITEM HELM24   LAST #0 #0 #0 IDENTIFIED #1   // Obsidian Ioun Stone

END BUT_ONLY

/////////////////////////

// AMBAR01 - Zakee Rafeha
// 
// Amkethran bartender
// nobody's gonna care for his trash, move his ioun stone to smugglers nearby

// 100% stock overwrite

COPY_EXISTING ambar01.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    AROW01    // Arrows
    AX1H01    // Battle Axe
    AX1H04    // Throwing Axe
    BLUN01    // Club
    BLUN02    // Flail
    BLUN04    // Mace
    BLUN06    // Morning Star
    BOLT01    // Bolt
    BOW01     // Composite Long Bow
    BOW03     // Long Bow
    BOW05     // Short Bow
    BULL01    // Bullet
    CHAN01    // Chain Mail Armor
    CHAN04    // Splint Mail
    DAGG01    // Dagger
    DAGG05    // Throwing Dagger
    DART01    // Dart
    HALB01    // Halberd
    HAMM01    // War Hammer
    HELM01    // Helmet
    LEAT01    // Leather Armor
    LEAT04    // Studded Leather Armor
    PLAT01    // Plate Mail Armor
    SHLD01    // Small Shield
    SHLD03    // Medium Shield
    SHLD05    // Large Shield
    SHLD08    // Buckler
    SHLD09    // Buckler
    SHLD10    // Buckler
    SHLD11    // Small Shield
    SHLD12    // Small Shield
    SHLD13    // Medium Shield
    SHLD14    // Medium Shield
    SHLD15    // Large Shield
    SHLD16    // Large Shield
    SLNG01    // Sling 
    SPER01    // Spear
    STAF01    // Quarterstaff
    SW1H01    // Bastard Sword 
    SW1H04    // Long Sword 
    SW1H07    // Short Sword 
    SW1H20    // Scimitar
    SW1H43    // Katana
    SW1H46    // Wakizashi
    SW1H48    // Ninja-To
    SW2H01    // Two Handed Sword
    XBOW01    // Heavy Crossbow
    XBOW04    // Light Crossbow
    HELM25    // Silver Ioun Stone
 // these are RR's additions
    ~RR#BOW02~  // Composite Short Bow

  LPF store INT_VAR
    sell=155
    buy=10
    steal=35
    fence=0
  END

  // and i know, it's beyond silly...
  ADD_STORE_ITEM POTN55   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Superior Healing

END BUT_ONLY

////////////////////

// AMSMUG01 - Carras
// 
// Amkethran smuggler

// 100% stock overwrite

COPY_EXISTING amsmug01.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    AROW01    // Arrows
    AROW11    // Arrow +2
    AROW10    // Arrows of Piercing
    AROW04    // Acid Arrows
    AROW15    // Arrow +3
    BOLT01    // Bolt
    BOLT04    // Bolt of Biting 
    BOLT03    // Bolt of Lightning
    BOLT09    // Bolt +3
    BULL01    // Bullet
    BULL03    // Bullet +2
    BULL05    // Bullet +3
    AMUL14    // Amulet of Protection +1
    WAND06    // Wand of Frost
    POTN14    // Oil of Speed
    POTN19    // Potion of Agility
    POTN20    // Antidote
    POTN18    // Potion of Absorbtion 
    POTN52    // Potion of Extra Healing
    POTN39    // Potion of Perception
    POTN36    // Potion of Master Thievery
    POTN05    // Potion of Fire Giant Strength
    POTN55    // Potion of Superior Healing
    SCRL05    // Protection from Electricity
    SCRL1Y    // Improved Invisibility
    SCRL1M    // Non-Detection
    CHAN01    // Chain Mail Armor
    CHAN02    // Chain Mail +1
    CHAN05    // Splint Mail +1
    SHLD04    // Medium Shield +1
    STAF01    // Quarterstaff
    STAF02    // Quarterstaff +1
    SW1H01    // Bastard Sword 
    SW1H04    // Long Sword 
    SW1H07    // Short Sword 
    SW1H08    // Short Sword +1
    SW1H22    // Scimitar +1
    SW1H44    // Katana +1
    SW1H72    // Bastard Sword +3
    SW1H73    // Long Sword +3
    SW1H74    // Short Sword +3
    SW1H75    // Katana +3
    SW2H01    // Two Handed Sword
    SW2H02    // Two Handed Sword +1
    SW2H20    // Two Handed Sword +3
    SPER01    // Spear
    SPER02    // Spear +1
    SPER06    // Spear +3
    BLUN01    // Club
    BLUN02    // Flail
    BLUN03    // Flail +1
    BLUN04    // Mace
    BLUN05    // Mace +1
    BLUN06    // Morning Star
    BLUN07    // Morning Star +1
    BLUN31    // Club +3
    BLUN32    // Flail +3
    BLUN33    // Mace +3
    BLUN34    // Morning Star +3
    XBOW02    // Heavy Crossbow +1
    XBOW05    // Light Crossbow +1
    XBOW17    // Heavy Crossbow +3
    XBOW18    // Light Crossbow +3
    BOW02     // Composite Long Bow +1
    BOW04     // Long Bow +1
    BOW06     // Short Bow +1
    BOW24     // Composite Long Bow +3
    BOW25     // Long Bow +3
    BOW26     // Short Bow +3
    SLNG02    // Sling +1
    SLNG10    // Sling +3
    AX1H01    // Battle Axe
    AX1H02    // Battle Axe +1
    AX1H17    // Battle Axe +3
    DAGG02    // Dagger +1
    HALB02    // Halberd +1
    DART01    // Dart
    DART02    // Dart +1
    DAGG01    // Dagger
    DAGG24    // Dagger +3
    HAMM01    // War Hammer
    HAMM12    // War Hammer +3
    HALB01    // Halberd
    HALB12    // Halberd +3
    RESTORE   // Restoration
    BAG02D    // Gem bag
    MISC3P    // Glasses of Identification
    CLCK13    // Traveller's Robe
    RODS06    // Rod of Reversal
    MISC41    // Star Sapphire
    MISC44    // King's Tears
    MISC42    // Diamond
    MISC43    // Emerald
    MISC45    // Rogue Stone
 // these are RR's additions
    BLUN01    // Club
    ~RR#SAP01~  // Sap
    ~RR#BOW03~  // Composite Short Bow +1
    ~RR#BOW05~  // Composite Short Bow +3

  LPF store INT_VAR
    sell=145
    buy=5
    steal=0
    fence=1
  END

  ADD_STORE_ITEM AROW01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED // Arrows
  ADD_STORE_ITEM AROW11   LAST #20 #0 #0 IDENTIFIED #4  // Arrow +2
  ADD_STORE_ITEM AROW10   LAST #20 #0 #0 IDENTIFIED #2  // Arrows of Piercing
  ADD_STORE_ITEM AROW04   LAST #20 #0 #0 IDENTIFIED #2  // Acid Arrows
  ADD_STORE_ITEM AROW15   LAST #20 #0 #0 IDENTIFIED #2  // Arrow +3
  ADD_STORE_ITEM BOLT01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED  // Bolt
  ADD_STORE_ITEM BOLT04   LAST #20 #0 #0 IDENTIFIED #2  // Bolt of Biting 
  ADD_STORE_ITEM BOLT03   LAST #20 #0 #0 IDENTIFIED #2  // Bolt of Lightning
  ADD_STORE_ITEM BOLT09   LAST #20 #0 #0 IDENTIFIED #2  // Bolt +3
  ADD_STORE_ITEM BULL01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED // Bullet
  ADD_STORE_ITEM BULL03   LAST #20 #0 #0 IDENTIFIED #4  // Bullet +2
  ADD_STORE_ITEM BULL05   LAST #20 #0 #0 IDENTIFIED #2  // Bullet +3

  ADD_STORE_ITEM AMUL14   LAST #0 #0 #0 IDENTIFIED #1   // Amulet of Protection +1
  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM WAND06   LAST #10 #0 #0 IDENTIFIED #1  // Wand of Frost
  END ELSE BEGIN
    ADD_STORE_ITEM WAND06   LAST #50 #0 #0 IDENTIFIED #1  // Wand of Frost
  END

  ADD_STORE_ITEM POTN14   LAST #1 #0 #0 IDENTIFIED #2   // Oil of Speed
  ADD_STORE_ITEM POTN19   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Agility
  ADD_STORE_ITEM POTN20   LAST #1 #0 #0 IDENTIFIED #1   // Antidote
  ADD_STORE_ITEM POTN18   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Absorbtion 
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #8   // Potion of Extra Healing
  ADD_STORE_ITEM POTN39   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Perception
  ADD_STORE_ITEM POTN36   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Master Thievery
  ADD_STORE_ITEM POTN05   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Fire Giant Strength
  ADD_STORE_ITEM POTN55   LAST #1 #0 #0 IDENTIFIED #4   // Potion of Superior Healing

  ADD_STORE_ITEM SCRL05   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Electricity
  ADD_STORE_ITEM SCRL1Y   LAST #1 #0 #0 IDENTIFIED #2   // Improved Invisibility
  ADD_STORE_ITEM SCRL1M   LAST #1 #0 #0 IDENTIFIED #1   // Non-Detection

  ADD_STORE_ITEM SW1H43   LAST #0 #0 #0 IDENTIFIED #1   // Katana
  ADD_STORE_ITEM SW1H44   LAST #0 #0 #0 IDENTIFIED #1   // Katana +1
  ADD_STORE_ITEM SW1H55   LAST #0 #0 #0 IDENTIFIED #1   // Katana +2
  ADD_STORE_ITEM SW1H46   LAST #0 #0 #0 IDENTIFIED #1   // Wakizashi
  ADD_STORE_ITEM SW1H47   LAST #0 #0 #0 IDENTIFIED #1   // Wakizashi +1
  ADD_STORE_ITEM SW1H48   LAST #0 #0 #0 IDENTIFIED #1   // Ninja-To
  ADD_STORE_ITEM SW1H49   LAST #0 #0 #0 IDENTIFIED #1   // Ninja-To +1

  PATCH_IF comp_rr_equip=1 BEGIN
    ADD_STORE_ITEM ~RR#SAP01~ LAST #0 #0 #0 IDENTIFIED #1  // sap
  END

  ADD_STORE_ITEM MISC3P   LAST #3 #0 #0 IDENTIFIED #1   // Glasses of Identification
  ADD_STORE_ITEM CLCK13   LAST #0 #0 #0 IDENTIFIED #1   // Traveller's Robe
  ADD_STORE_ITEM HELM25   LAST #0 #0 #0 IDENTIFIED #1   // Silver Ioun Stone

  ADD_STORE_ITEM MISC41   LAST #0 #0 #0 IDENTIFIED #1   // Star Sapphire
  ADD_STORE_ITEM MISC44   LAST #0 #0 #0 IDENTIFIED #1   // King's Tears
  ADD_STORE_ITEM MISC42   LAST #0 #0 #0 IDENTIFIED #1   // Diamond
  ADD_STORE_ITEM MISC43   LAST #0 #0 #0 IDENTIFIED #1   // Emerald
  ADD_STORE_ITEM MISC45   LAST #0 #0 #0 IDENTIFIED #1   // Rogue Stone

END BUT_ONLY

////////////////////

// AMSMUG02 - Carras
// 
// Amkethran smuggler, special stock

// 100% stock overwrite

// Trollhide Armor
COPY_EXISTING sendai.cre override LPF FJ_CRE_VALIDITY RET valid=valid END PATCH_IF valid BEGIN
  REMOVE_CRE_ITEM leat23
END BUT_ONLY

COPY_EXISTING amsmug02.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    AROW01    // Arrows
    AROW11    // Arrow +2
    AROW10    // Arrows of Piercing
    AROW04    // Acid Arrows
    AROW15    // Arrow +3
    BOLT01    // Bolt
    BOLT04    // Bolt of Biting 
    BOLT03    // Bolt of Lightning
    BOLT09    // Bolt +3
    BULL01    // Bullet
    BULL03    // Bullet +2
    BULL05    // Bullet +3
    AMUL14    // Amulet of Protection +1
    WAND06    // Wand of Frost
    POTN14    // Oil of Speed
    POTN19    // Potion of Agility
    POTN20    // Antidote
    POTN18    // Potion of Absorbtion 
    POTN52    // Potion of Extra Healing
    POTN39    // Potion of Perception
    POTN36    // Potion of Master Thievery
    POTN05    // Potion of Fire Giant Strength
    POTN55    // Potion of Superior Healing
    SCRL05    // Protection from Electricity
    SCRL1Y    // Improved Invisibility
    SCRL1M    // Non-Detection
    CHAN01    // Chain Mail Armor
    CHAN02    // Chain Mail +1
    CHAN05    // Splint Mail +1
    SHLD04    // Medium Shield +1
    STAF01    // Quarterstaff
    STAF02    // Quarterstaff +1
    SW1H01    // Bastard Sword 
    SW1H04    // Long Sword 
    SW1H07    // Short Sword 
    SW1H08    // Short Sword +1
    SW1H22    // Scimitar +1
    SW1H44    // Katana +1
    SW1H72    // Bastard Sword +3
    SW1H73    // Long Sword +3
    SW1H74    // Short Sword +3
    SW1H75    // Katana +3
    SW2H01    // Two Handed Sword
    SW2H02    // Two Handed Sword +1
    SW2H20    // Two Handed Sword +3
    SPER01    // Spear
    SPER02    // Spear +1
    SPER06    // Spear +3
    BLUN01    // Club
    BLUN02    // Flail
    BLUN03    // Flail +1
    BLUN04    // Mace
    BLUN05    // Mace +1
    BLUN06    // Morning Star
    BLUN07    // Morning Star +1
    BLUN31    // Club +3
    BLUN32    // Flail +3
    BLUN33    // Mace +3
    BLUN34    // Morning Star +3
    XBOW02    // Heavy Crossbow +1
    XBOW05    // Light Crossbow +1
    XBOW17    // Heavy Crossbow +3
    XBOW18    // Light Crossbow +3
    BOW02     // Composite Long Bow +1
    BOW04     // Long Bow +1
    BOW06     // Short Bow +1
    BOW24     // Composite Long Bow +3
    BOW25     // Long Bow +3
    BOW26     // Short Bow +3
    SLNG02    // Sling +1
    SLNG10    // Sling +3
    AX1H01    // Battle Axe
    AX1H02    // Battle Axe +1
    AX1H16    // K'logarath +4
    AX1H17    // Battle Axe +3
    DAGG02    // Dagger +1
    HALB02    // Halberd +1
    DART01    // Dart
    DART02    // Dart +1
    DAGG01    // Dagger
    DAGG24    // Dagger +3
    HAMM01    // War Hammer
    HAMM12    // War Hammer +3
    HALB01    // Halberd
    HALB12    // Halberd +3
    RESTORE   // Restoration
    BAG02D    // Gem bag
    MISC3P    // Glasses of Identification
    CLCK13    // Traveller's Robe
    RODS06    // Rod of Reversal
    PLAT21    // Enkidu's Full Plate +3
    BOOT12    // Gargoyle Boots
    MISC41    // Star Sapphire
    MISC42    // Diamond
    MISC43    // Emerald
    MISC44    // King's Tears
    MISC45    // Rogue Stone
    BAG02I    // Gem bag
 // these are RR's additions
    BLUN01    // Club
    ~RR#SAP01~  // Sap
    ~RR#BOW03~  // Composite Short Bow +1
    ~RR#BOW05~  // Composite Short Bow +3

  LPF store INT_VAR
    sell=145
    buy=5
    steal=0
    fence=1
  END

  ADD_STORE_ITEM AROW11   LAST #20 #0 #0 IDENTIFIED #5   // Arrow +2
  ADD_STORE_ITEM AROW10   LAST #20 #0 #0 IDENTIFIED #2   // Arrows of Piercing
  ADD_STORE_ITEM AROW04   LAST #20 #0 #0 IDENTIFIED #2   // Acid Arrows
  ADD_STORE_ITEM AROW15   LAST #20 #0 #0 IDENTIFIED #2   // Arrow +3
  ADD_STORE_ITEM BOLT04   LAST #20 #0 #0 IDENTIFIED #2   // Bolt of Biting 
  ADD_STORE_ITEM BOLT03   LAST #20 #0 #0 IDENTIFIED #2   // Bolt of Lightning
  ADD_STORE_ITEM BOLT09   LAST #20 #0 #0 IDENTIFIED #2   // Bolt +3
  ADD_STORE_ITEM BULL05   LAST #20 #0 #0 IDENTIFIED #2   // Bullet +3
  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM BOLT05   LAST #10 #0 #0 IDENTIFIED #2  // Blessed Bolt
    ADD_STORE_ITEM BULL06   LAST #20 #0 #0 IDENTIFIED #2  // Bullet of Smiting (Bullet +4)
  END ELSE BEGIN
    ADD_STORE_ITEM BULL06   LAST #10 #0 #0 IDENTIFIED #2   // Bullet +4
  END

  ADD_STORE_ITEM bull04   LAST #20 #0 #0 IDENTIFIED #2  // sunstone bullet
  ADD_STORE_ITEM DART05   LAST #20 #0 #0 IDENTIFIED #3  // Asp's Nest
  ADD_STORE_ITEM AROW05   LAST #20 #0 #0 IDENTIFIED #2  // Arrow of Biting
  PATCH_IF comp_nodispel=0 BEGIN
    ADD_STORE_ITEM arow07   LAST #5 #0 #0 IDENTIFIED #2   // arrow of dispelling
  END
  ADD_STORE_ITEM arow06   LAST #5 #0 #0 IDENTIFIED #1   // arrow of detonation

  ADD_STORE_ITEM POTN14   LAST #1 #0 #0 IDENTIFIED #1   // Oil of Speed
  ADD_STORE_ITEM POTN05   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Fire Giant Strength
  ADD_STORE_ITEM potn06   LAST #1 #0 #0 IDENTIFIED #2   // cloud
  ADD_STORE_ITEM potn07   LAST #1 #0 #0 IDENTIFIED #1   // storm
  ADD_STORE_ITEM POTN11   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Invulnerability
  ADD_STORE_ITEM potn18   LAST #1 #0 #0 IDENTIFIED #2   // absorbtion
  ADD_STORE_ITEM potn41   LAST #1 #0 #0 IDENTIFIED #1   // power
  ADD_STORE_ITEM potn34   LAST #1 #0 #0 IDENTIFIED #2   // magic protection
  ADD_STORE_ITEM potn35   LAST #1 #0 #0 IDENTIFIED #1   // magic shielding
  ADD_STORE_ITEM potn33   LAST #1 #0 #0 IDENTIFIED #1   // magic blocking
  ADD_STORE_ITEM POTN39   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Perception
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #10  // Potion of Extra Healing
  ADD_STORE_ITEM POTN55   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Superior Healing

  ADD_STORE_ITEM SW1H72   LAST #0 #0 #0 IDENTIFIED #1   // Bastard Sword +3
  ADD_STORE_ITEM SW1H73   LAST #0 #0 #0 IDENTIFIED #1   // Long Sword +3
  ADD_STORE_ITEM SW1H74   LAST #0 #0 #0 IDENTIFIED #1   // Short Sword +3
  ADD_STORE_ITEM SW1H75   LAST #0 #0 #0 IDENTIFIED #1   // Katana +3
  ADD_STORE_ITEM SW2H20   LAST #0 #0 #0 IDENTIFIED #1   // Two Handed Sword +3
  ADD_STORE_ITEM AX1H17   LAST #0 #0 #0 IDENTIFIED #1   // Battle Axe +3
  ADD_STORE_ITEM DAGG24   LAST #0 #0 #0 IDENTIFIED #1   // Dagger +3
  ADD_STORE_ITEM HAMM12   LAST #0 #0 #0 IDENTIFIED #1   // War Hammer +3
  ADD_STORE_ITEM HALB12   LAST #0 #0 #0 IDENTIFIED #1   // Halberd +3
  ADD_STORE_ITEM SPER06   LAST #0 #0 #0 IDENTIFIED #1   // Spear +3
  ADD_STORE_ITEM BLUN31   LAST #0 #0 #0 IDENTIFIED #1   // Club +3
  ADD_STORE_ITEM BLUN32   LAST #0 #0 #0 IDENTIFIED #1   // Flail +3
  ADD_STORE_ITEM BLUN33   LAST #0 #0 #0 IDENTIFIED #1   // Mace +3
  ADD_STORE_ITEM BLUN34   LAST #0 #0 #0 IDENTIFIED #1   // Morning Star +3

  ADD_STORE_ITEM XBOW17   LAST #0 #0 #0 IDENTIFIED #1   // Heavy Crossbow +3
  ADD_STORE_ITEM XBOW18   LAST #0 #0 #0 IDENTIFIED #1   // Light Crossbow +3
  ADD_STORE_ITEM BOW24    LAST #0 #0 #0 IDENTIFIED #1   // Composite Long Bow +3
  ADD_STORE_ITEM BOW25    LAST #0 #0 #0 IDENTIFIED #1   // Long Bow +3
  ADD_STORE_ITEM BOW26    LAST #0 #0 #0 IDENTIFIED #1   // Short Bow +3
  ADD_STORE_ITEM SLNG10   LAST #0 #0 #0 IDENTIFIED #1   // Sling +3

  PATCH_IF comp_rr_equip=1 BEGIN
    ADD_STORE_ITEM ~RR#BOW05~ LAST #0 #0 #0 IDENTIFIED #1  // Composite Short Bow +3
    ADD_STORE_ITEM ~RR#BUC04~ LAST #0 #0 #0 IDENTIFIED #1  // Buckler +3
  END

  ADD_STORE_ITEM AX1H16   LAST #0 #0 #0 IDENTIFIED #1   // K'logarath +4
  ADD_STORE_ITEM RODS06   LAST #10 #0 #0 IDENTIFIED #1  // Rod of Reversal
  ADD_STORE_ITEM PLAT21   LAST #0 #0 #0 IDENTIFIED #1   // Enkidu's Full Plate +3
  ADD_STORE_ITEM leat23   LAST #0 #0 #0 IDENTIFIED #1   // Trollhide Armor
  ADD_STORE_ITEM BOOT12   LAST #2 #0 #0 IDENTIFIED #1   // Gargoyle Boots
  ADD_STORE_ITEM BAG02I   LAST #0 #0 #0 IDENTIFIED #1   // Gem bag

  ADD_STORE_ITEM MISC41   LAST #0 #0 #0 IDENTIFIED #1   // Star Sapphire
  ADD_STORE_ITEM MISC42   LAST #0 #0 #0 IDENTIFIED #1   // Diamond
  ADD_STORE_ITEM MISC43   LAST #0 #0 #0 IDENTIFIED #1   // Emerald
  ADD_STORE_ITEM MISC44   LAST #0 #0 #0 IDENTIFIED #1   // King's Tears
  ADD_STORE_ITEM MISC45   LAST #0 #0 #0 IDENTIFIED #1   // Rogue Stone

END BUT_ONLY

///////////////////

// AMCLER02 - Chyil
// 
// Amkethran temple of Waukeen

// 100% stock overwrite

COPY_EXISTING amcler02.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy END
  REMOVE_STORE_ITEM 
    POTN08    // Potion of Healing
    POTN29    // Potion of Genius
    POTN37    // Potion of Mind Focusing
    POTN43    // Potion of Insight 
    POTN17    // Elixir of Health
    POTN25    // Potion of Healing
    POTN20    // Antidote
    SCRLPET   // Stone to Flesh Scroll
    SCRL63    // Raise Dead
    SCRL08    // Protection from Poison
    SCRL04    // Protection from Cold
    RING03    // Ring of Animal Friendship
    RESTORE   // Restoration
    POTN52    // Potion of Extra Healing
    POTN55    // Potion of Superior Healing
    BAG06D    // Potion Case
    BAG03I    // Scroll Case

  LPF store INT_VAR
    sell=155
    buy=10
    steal=0
    fence=0
  END

  LPF temple INT_VAR
    cure_light_wounds=25
    dispel_magic=200
    remove_curse=500
    cure_medium_wounds=50
    cure_disease=300
    cure_serious_wounds=75
    lesser_restoration=750
    cure_critical_wounds=100
    raise_dead=1000
  END

  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #10  // Potion of Extra Healing
  ADD_STORE_ITEM POTN55   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Superior Healing
  ADD_STORE_ITEM POTN17   LAST #1 #0 #0 IDENTIFIED #1   // Elixir of Health

  ADD_STORE_ITEM SCRLPET  LAST #1 #0 #0 IDENTIFIED #1   // Stone to Flesh Scroll
  ADD_STORE_ITEM RESTORE  LAST #1 #0 #0 IDENTIFIED #3   // Restoration
  ADD_STORE_ITEM SCRL63   LAST #1 #0 #0 IDENTIFIED #3   // Raise Dead

  ADD_STORE_ITEM STAF19   LAST #0 #0 #0 IDENTIFIED #1   // Cleric's Staff +3

  ADD_STORE_ITEM BAG03I   LAST #0 #0 #0 IDENTIFIED #1   // Scroll Case

  ADD_STORE_ITEM misc43   LAST #0 #0 #0 IDENTIFIED #1   // emerald

  ADD_STORE_ITEM ~ag#ir01~  LAST #1 #0 #0 IDENTIFIED #3   // Bless
  ADD_STORE_ITEM ~ag#ir02~  LAST #1 #0 #0 IDENTIFIED #3   // Sanctuary
  ADD_STORE_ITEM ~ag#ir05~  LAST #1 #0 #0 IDENTIFIED #2   // Find Traps
  ADD_STORE_ITEM ~ag#ir0b~  LAST #1 #0 #0 IDENTIFIED #2   // Remove Curse/Break Enchantment
  ADD_STORE_ITEM scrl56     LAST #1 #0 #0 IDENTIFIED #2   // cure serious wounds
  ADD_STORE_ITEM scrl58     LAST #1 #0 #0 IDENTIFIED #1   // free action
  ADD_STORE_ITEM scrl5d     LAST #1 #0 #0 IDENTIFIED #1   // protection from evil 10' radius

END BUT_ONLY

///////////////////////

// SARBAR01 - Bartender
// 
// Saradush bartender
// this guy's assortiment is snafu, but so are most of tob stores

// 100% stock overwrite

COPY_EXISTING sarbar01.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    SW1H01    // Bastard Sword 
    SW1H02    // Bastard Sword +1
    SW1H42    // Bastard Sword +2
    SW1H72    // Bastard Sword +3
    SW1H04    // Long Sword 
    SW1H05    // Long Sword +1
    SW1H41    // Long Sword +2
    SW1H73    // Long Sword +3
    SW1H07    // Short Sword 
    SW1H08    // Short Sword +1
    SW1H29    // Short Sword +2
    SW1H74    // Short Sword +3
    SW1H20    // Scimitar
    SW1H22    // Scimitar +1
    SW1H76    // Scimitar +3
    SW1H43    // Katana
    SW1H44    // Katana +1
    SW1H55    // Katana +2
    SW1H75    // Katana +3
    SW1H46    // Wakizashi
    SW1H47    // Wakizashi +1
    SW1H48    // Ninja-To
    SW1H49    // Ninja-To +1
    SW2H01    // Two Handed Sword
    SW2H02    // Two Handed Sword +1
    SW2H11    // Two Handed Sword +2
    SW2H20    // Two Handed Sword +3
    DAGG01    // Dagger
    DAGG02    // Dagger +1
    DAGG15    // Dagger +2
    DAGG24    // Dagger +3
    AX1H01    // Battle Axe
    AX1H02    // Battle Axe +1
    AX1H11    // Battle Axe +2
    AX1H17    // Battle Axe +3
    SPER01    // Spear
    SPER02    // Spear +1
    SPER05    // Spear +2
    SPER06    // Spear +3
    HALB01    // Halberd
    HALB02    // Halberd +1
    HALB07    // Halberd +2
    HALB12    // Halberd +3
    STAF01    // Quarterstaff
    STAF02    // Quarterstaff +1
    STAF18    // Quarter Staff +2
    STAF19    // Cleric's Staff +3
    STAF24    // Quarter Staff +3
    BLUN01    // Club
    BLUN31    // Club +3
    BLUN02    // Flail
    BLUN03    // Flail +1
    BLUN13    // Flail +2
    BLUN32    // Flail +3
    BLUN04    // Mace
    BLUN05    // Mace +1
    BLUN21    // Mace +2
    BLUN33    // Mace +3
    BLUN06    // Morning Star
    BLUN07    // Morning Star +1
    BLUN15    // Morning Star +2
    BLUN34    // Morning Star +3
    HAMM01    // War Hammer
    HAMM02    // War Hammer +1
    HAMM08    // War Hammer +2
    HAMM12    // War Hammer +3
    BOW01     // Composite Long Bow
    BOW02     // Composite Long Bow +1
    BOW16     // Composite Long Bow +2
    BOW24     // Composite Long Bow +3
    BOW03     // Long Bow
    BOW04     // Long Bow +1
    BOW17     // Long Bow +2
    BOW25     // Long Bow +3
    BOW05     // Short Bow
    BOW06     // Short Bow +1
    BOW18     // Short Bow +2
    BOW26     // Short Bow +3
    AROW01    // Arrows
    AROW02    // Arrows +1
    AROW11    // Arrow +2
    AROW15    // Arrow +3
    XBOW01    // Heavy Crossbow
    XBOW02    // Heavy Crossbow +1
    XBOW07    // Heavy Crossbow +2
    XBOW17    // Heavy Crossbow +3
    XBOW04    // Light Crossbow
    XBOW05    // Light Crossbow +1
    XBOW09    // Light Crossbow +2
    XBOW18    // Light Crossbow +3
    BOLT01    // Bolt
    BOLT02    // Bolt +1
    BOLT06    // Bolt +2
    BOLT09    // Bolt +3
    SLNG01    // Sling 
    SLNG02    // Sling +1
    SLNG04    // Sling +2
    SLNG10    // Sling +3
    BULL01    // Bullet
    BULL02    // Bullet +1
    BULL03    // Bullet +2
    BULL05    // Bullet +3
    BULL06    // Bullet +4
    DART01    // Dart
    DART02    // Dart +1
    LEAT01    // Leather Armor
    LEAT02    // Leather Armor +1
    LEAT11    // Leather Armor +2
    LEAT12    // Leather Armor +3
    LEAT04    // Studded Leather Armor
    LEAT05    // Studded Leather Armor +1
    LEAT15    // Studded Leather Armor +2
    CHAN01    // Chain Mail Armor
    CHAN02    // Chain Mail +1
    CHAN08    // Chain Mail +2
    CHAN04    // Splint Mail
    CHAN05    // Splint Mail +1
    PLAT01    // Plate Mail Armor
    PLAT10    // Plate Mail +1
    PLAT04    // Full Plate Mail
    PLAT14    // Full Plate Mail +1
    SHLD01    // Small Shield
    SHLD02    // Small Shield +1
    SHLD28    // Small Shield +2
    SHLD03    // Medium Shield
    SHLD04    // Medium Shield +1
    SHLD29    // Medium Shield +2
    SHLD05    // Large Shield
    SHLD06    // Large Shield +1
    SHLD30    // Large Shield +2
    SW1H66    // Yamato +4
    BOOT01    // Boots of Speed
 // these are RR's additions
    ~RR#BOW02~  // Composite Short Bow
    ~RR#BOW03~  // Composite Short Bow +1
    ~RR#BOW04~  // Composite Short Bow +2
    ~RR#BOW05~  // Composite Short Bow +3
    ~RR#BUC02~  // Buckler +1
    ~RR#BUC03~  // Buckler +2
    ~RR#BUC04~  // Buckler +3

  LPF store INT_VAR
    sell=155
    buy=10
    steal=55
    fence=0
  END

  ADD_STORE_ITEM SW1H02   LAST #0 #0 #0 IDENTIFIED #1   // Bastard Sword +1
  ADD_STORE_ITEM SW1H05   LAST #0 #0 #0 IDENTIFIED #1   // Long Sword +1
  ADD_STORE_ITEM SW1H08   LAST #0 #0 #0 IDENTIFIED #1   // Short Sword +1
  ADD_STORE_ITEM SW1H22   LAST #0 #0 #0 IDENTIFIED #1   // Scimitar +1
  ADD_STORE_ITEM SW1H44   LAST #0 #0 #0 IDENTIFIED #1   // Katana +1
  ADD_STORE_ITEM SW1H47   LAST #0 #0 #0 IDENTIFIED #1   // Wakizashi +1
  ADD_STORE_ITEM SW1H49   LAST #0 #0 #0 IDENTIFIED #1   // Ninja-To +1
  ADD_STORE_ITEM SW2H02   LAST #0 #0 #0 IDENTIFIED #1   // Two Handed Sword +1
  ADD_STORE_ITEM DAGG02   LAST #0 #0 #0 IDENTIFIED #1   // Dagger +1
  ADD_STORE_ITEM AX1H02   LAST #0 #0 #0 IDENTIFIED #1   // Battle Axe +1
  ADD_STORE_ITEM SPER02   LAST #0 #0 #0 IDENTIFIED #1   // Spear +1
  ADD_STORE_ITEM HALB02   LAST #0 #0 #0 IDENTIFIED #1   // Halberd +1
  ADD_STORE_ITEM STAF02   LAST #0 #0 #0 IDENTIFIED #1   // Quarterstaff +1
  ADD_STORE_ITEM BLUN03   LAST #0 #0 #0 IDENTIFIED #1   // Flail +1
  ADD_STORE_ITEM BLUN05   LAST #0 #0 #0 IDENTIFIED #1   // Mace +1
  ADD_STORE_ITEM BLUN07   LAST #0 #0 #0 IDENTIFIED #1   // Morning Star +1
  ADD_STORE_ITEM HAMM02   LAST #0 #0 #0 IDENTIFIED #1   // War Hammer +1
  ADD_STORE_ITEM BOW02    LAST #0 #0 #0 IDENTIFIED #1   // Composite Long Bow +1
  ADD_STORE_ITEM BOW04    LAST #0 #0 #0 IDENTIFIED #1   // Long Bow +1
  ADD_STORE_ITEM BOW06    LAST #0 #0 #0 IDENTIFIED #1   // Short Bow +1
  ADD_STORE_ITEM XBOW02   LAST #0 #0 #0 IDENTIFIED #1   // Heavy Crossbow +1
  ADD_STORE_ITEM XBOW05   LAST #0 #0 #0 IDENTIFIED #1   // Light Crossbow +1

  ADD_STORE_ITEM AROW01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED  // Arrows
  ADD_STORE_ITEM AROW02   LAST #40 #0 #0 IDENTIFIED #6   // Arrows +1
  ADD_STORE_ITEM AROW11   LAST #20 #0 #0 IDENTIFIED #3   // Arrow +2
  ADD_STORE_ITEM AROW15   LAST #20 #0 #0 IDENTIFIED #1   // Arrow +3
  ADD_STORE_ITEM BOLT01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED  // Bolt
  ADD_STORE_ITEM BOLT02   LAST #40 #0 #0 IDENTIFIED #6   // Bolt +1
  ADD_STORE_ITEM BOLT06   LAST #20 #0 #0 IDENTIFIED #3   // Bolt +2
  ADD_STORE_ITEM BOLT09   LAST #20 #0 #0 IDENTIFIED #1   // Bolt +3
  ADD_STORE_ITEM BULL01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED  // Bullet
  ADD_STORE_ITEM BULL02   LAST #40 #0 #0 IDENTIFIED #6   // Bullet +1
  ADD_STORE_ITEM BULL03   LAST #20 #0 #0 IDENTIFIED #3   // Bullet +2
  ADD_STORE_ITEM BULL05   LAST #20 #0 #0 IDENTIFIED #1   // Bullet +3

  ADD_STORE_ITEM LEAT11   LAST #0 #0 #0 IDENTIFIED #1   // Leather Armor +2
  ADD_STORE_ITEM LEAT05   LAST #0 #0 #0 IDENTIFIED #1   // Studded Leather Armor +1
  ADD_STORE_ITEM CHAN08   LAST #0 #0 #0 IDENTIFIED #1   // Chain Mail +2
  ADD_STORE_ITEM CHAN05   LAST #0 #0 #0 IDENTIFIED #1   // Splint Mail +1
  ADD_STORE_ITEM PLAT10   LAST #0 #0 #0 IDENTIFIED #1   // Plate Mail +2
  ADD_STORE_ITEM PLAT04   LAST #0 #0 #0 IDENTIFIED #1   // Full Plate Mail
  ADD_STORE_ITEM SHLD28   LAST #0 #0 #0 IDENTIFIED #1   // Small Shield +2
  ADD_STORE_ITEM SHLD04   LAST #0 #0 #0 IDENTIFIED #1   // Medium Shield +1
  ADD_STORE_ITEM SHLD06   LAST #0 #0 #0 IDENTIFIED #1   // Large Shield +1

  PATCH_IF comp_rr_equip=1 BEGIN
    ADD_STORE_ITEM ~RR#BOW03~ LAST #0 #0 #0 IDENTIFIED #1  // Composite Short Bow +1
    ADD_STORE_ITEM ~RR#BUC03~ LAST #0 #0 #0 IDENTIFIED #1  // Buckler +2
  END

END BUT_ONLY

/////////////////////////////

// SARTEM01 - Sister Farielle
// 
// Saradush temple of Waukeen

// 100% stock overwrite

COPY_EXISTING sartem01.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy END
  REMOVE_STORE_ITEM 
    POTN08    // Potion of Healing
    POTN29    // Potion of Genius
    POTN37    // Potion of Mind Focusing
    POTN43    // Potion of Insight 
    POTN17    // Elixir of Health
    POTN20    // Antidote
    SCRLPET   // Stone to Flesh Scroll
    SCRL63    // Raise Dead
    SCRL08    // Protection from Poison
    SCRL04    // Protection from Cold
    RING03    // Ring of Animal Friendship
    RESTORE   // Restoration
    MISCAU    // Elven Holy Water

  LPF store INT_VAR
    sell=155
    buy=10
    steal=0
    fence=0
  END

  LPF temple INT_VAR
    cure_light_wounds=25
    dispel_magic=200
    remove_curse=500
    cure_medium_wounds=50
    cure_disease=300
    cure_serious_wounds=75
    lesser_restoration=750
    cure_critical_wounds=100
    raise_dead=1000
    mass_cure= comp_atweaks_temples=1 ? 1000 : 0
  END

  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #10  // Potion of Extra Healing
  ADD_STORE_ITEM POTN55   LAST #1 #0 #0 IDENTIFIED #4   // Potion of Superior Healing
  ADD_STORE_ITEM POTN17   LAST #1 #0 #0 IDENTIFIED #1   // Elixir of Health

  ADD_STORE_ITEM SCRLPET  LAST #1 #0 #0 IDENTIFIED #3   // Stone to Flesh Scroll
  ADD_STORE_ITEM RESTORE  LAST #1 #0 #0 IDENTIFIED #3   // Restoration
  ADD_STORE_ITEM SCRL63   LAST #1 #0 #0 IDENTIFIED #3   // Raise Dead

  ADD_STORE_ITEM SCRL08   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Poison
  ADD_STORE_ITEM SCRL04   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Cold

  ADD_STORE_ITEM MISCAU   LAST #1 #0 #0 IDENTIFIED #1  UNLIMITED // Elven Holy Water

  ADD_STORE_ITEM CLCK14   LAST #0 #0 #0 IDENTIFIED #1   // Adventurer's Robe
  ADD_STORE_ITEM STAF19   LAST #0 #0 #0 IDENTIFIED #1   // Cleric's Staff +3
  ADD_STORE_ITEM RODS03   LAST #10 #0 #0 IDENTIFIED #1  // Rod of Resurrection

  ADD_STORE_ITEM amul10   LAST #0 #0 #0 IDENTIFIED #1   // gold
  ADD_STORE_ITEM ring10   LAST #0 #0 #0 IDENTIFIED #1   // gold

  ADD_STORE_ITEM ~ag#ir03~  LAST #1 #0 #0 IDENTIFIED #3   // Armor of Faith
  ADD_STORE_ITEM ~ag#ir01~  LAST #1 #0 #0 IDENTIFIED #3   // Bless
  ADD_STORE_ITEM ~ag#ir02~  LAST #1 #0 #0 IDENTIFIED #3   // Sanctuary
  ADD_STORE_ITEM ~ag#ir05~  LAST #1 #0 #0 IDENTIFIED #2   // Find Traps
  ADD_STORE_ITEM ~ag#ir0b~  LAST #1 #0 #0 IDENTIFIED #2   // Remove Curse/Break Enchantment
  ADD_STORE_ITEM scrl56     LAST #1 #0 #0 IDENTIFIED #2   // cure serious wounds
  ADD_STORE_ITEM ~ag#ir0c~  LAST #1 #0 #0 IDENTIFIED #2   // Remove Paralysis
  ADD_STORE_ITEM scrl61     LAST #1 #0 #0 IDENTIFIED #2   // cure critical wounds
  ADD_STORE_ITEM scrl58     LAST #1 #0 #0 IDENTIFIED #2   // free action
  ADD_STORE_ITEM scrl5d     LAST #1 #0 #0 IDENTIFIED #2   // protection from evil 10' radius
  ADD_STORE_ITEM ~ag#ir0f~  LAST #1 #0 #0 IDENTIFIED #1   // Magic Resistance

END BUT_ONLY

//////////////////////////////

// HGKAR01 - Karthis al-Hezzar
// 
// i think it's the fool we get to rescue from Yaga-Shura's marauders

// 100% stock overwrite

COPY_EXISTING hgkar01.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM
    SW1H42    // Bastard Sword +2
    SW1H72    // Bastard Sword +3
    SW1H41    // Long Sword +2
    SW1H73    // Long Sword +3
    SW1H29    // Short Sword +2
    SW1H74    // Short Sword +3
    SW1H76    // Scimitar +3
    SW1H44    // Katana +1
    SW1H55    // Katana +2
    SW1H75    // Katana +3
    SW2H11    // Two Handed Sword +2
    SW2H20    // Two Handed Sword +3
    DAGG15    // Dagger +2
    DAGG24    // Dagger +3
    AX1H11    // Battle Axe +2
    AX1H17    // Battle Axe +3
    SPER05    // Spear +2
    SPER06    // Spear +3
    HALB07    // Halberd +2
    HALB12    // Halberd +3
    STAF18    // Quarter Staff +2
    STAF24    // Quarter Staff +3
    BLUN31    // Club +3
    BLUN32    // Flail +3
    BLUN21    // Mace +2
    BLUN33    // Mace +3
    BLUN15    // Morning Star +2
    BLUN34    // Morning Star +3
    HAMM08    // War Hammer +2
    HAMM12    // War Hammer +3
    BOW16     // Composite Long Bow +2
    BOW24     // Composite Long Bow +3
    BOW17     // Long Bow +2
    BOW25     // Long Bow +3
    BOW18     // Short Bow +2
    BOW26     // Short Bow +3
    AROW01    // Arrows
    AROW02    // Arrows +1
    AROW11    // Arrow +2
    AROW15    // Arrow +3
    XBOW17    // Heavy Crossbow +3
    XBOW18    // Light Crossbow +3
    BOLT01    // Bolt
    BOLT02    // Bolt +1
    BOLT06    // Bolt +2
    BOLT09    // Bolt +3
    SLNG04    // Sling +2
    SLNG10    // Sling +3
    BULL01    // Bullet
    BULL02    // Bullet +1
    BULL03    // Bullet +2
    BULL05    // Bullet +3
    BULL06    // Bullet +4
    DART02    // Dart +1
    POTN02    // Potion of Fire Resistance
    POTN03    // Potion of Hill Giant Strength
    POTN10    // Potion of Invisibility
    POTN14    // Oil of Speed
    POTN22    // Potion of Cold Resistance
    POTN08    // Potion of Healing
    POTN52    // Potion of Extra Healing
    POTN55    // Potion of Superior Healing
    SCRL7K    // Mislead
    SCRL7L    // Pierce Magic
    SCRL7S    // Chain Lightning
    SCRL9H    // Maze
    SCRL9M    // Spellstrike
    SCRL9X    // Black Blade of Disaster
    SCRLAO    // Symbol Death
    SCRLAP    // Symbol Stun
    HELM24    // Obsidian Ioun Stone
    RESTORE   // Restoration
    RODS03    // Rod of Resurrection
    BAG02H    // Gem bag
    BAG03H    // Scroll Case
    BAG06C    // Potion Case
 // these are RR's additions
    ~RR#BOW04~  // Composite Short Bow +2
    ~RR#BOW05~  // Composite Short Bow +3

  LPF store INT_VAR
    sell=155
    buy=10
    steal=75 // ffs, let's pretend there's some rp to be found in tob - that we can steal SSoM; so f2cking what?!
    fence=0
  END

  ADD_STORE_ITEM SW1H58   LAST #0 #0 #0 IDENTIFIED #1   // Short Sword of Mask +4

  ADD_STORE_ITEM SW1H73   LAST #0 #0 #0 IDENTIFIED #1   // Long Sword +3
  ADD_STORE_ITEM SW1H55   LAST #0 #0 #0 IDENTIFIED #1   // Katana +2
  ADD_STORE_ITEM DAGG24   LAST #0 #0 #0 IDENTIFIED #1   // Dagger +3
  ADD_STORE_ITEM XBOW17   LAST #0 #0 #0 IDENTIFIED #1   // Heavy Crossbow +3

  PATCH_IF comp_rr_equip=1 BEGIN
    ADD_STORE_ITEM ~RR#BOW04~ LAST #0 #0 #0 IDENTIFIED #1  // Composite Short Bow +2
  END

  ADD_STORE_ITEM AROW15   LAST #20 #0 #0 IDENTIFIED #2  // Arrow +3
  ADD_STORE_ITEM BOLT09   LAST #20 #0 #0 IDENTIFIED #2  // Bolt +3
  ADD_STORE_ITEM BULL05   LAST #20 #0 #0 IDENTIFIED #2  // Bullet +3

  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #8   // Potion of Extra Healing
  ADD_STORE_ITEM POTN55   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Superior Healing
  ADD_STORE_ITEM POTN03   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Hill Giant Strength
  ADD_STORE_ITEM POTN10   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Invisibility
  ADD_STORE_ITEM POTN14   LAST #1 #0 #0 IDENTIFIED #1   // Oil of Speed

  ADD_STORE_ITEM RESTORE  LAST #1 #0 #0 IDENTIFIED #1   // Restoration
  ADD_STORE_ITEM BAG02H   LAST #0 #0 #0 IDENTIFIED #1   // Gem bag
  ADD_STORE_ITEM BAG03H   LAST #0 #0 #0 IDENTIFIED #1   // Scroll Case
  ADD_STORE_ITEM BAG06C   LAST #0 #0 #0 IDENTIFIED #1   // Potion Case

END BUT_ONLY

///////////////////////////

// GARLENA - Sister Garlena
// 
// Watcher's Keep

// 100% stock overwrite

COPY_EXISTING garlena.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy INT_VAR weap=1 armor=1 rang=1 magic=1 potn=1 jewel=1 misc=1 END
  REMOVE_STORE_ITEM 
    DART01    // Dart
    DAGG05    // Throwing Dagger
    AX1H04    // Throwing Axe
    AROW01    // Arrows
    AROW02    // Arrows +1
    BOLT01    // Bolt
    BOLT02    // Bolt +1
    BULL01    // Bullet
    BULL02    // Bullet +1
    POTN08    // Potion of Healing
    POTN52    // Potion of Extra Healing
    POTN09    // Potion of Heroism
    POTN30    // Potion of Infravision
    POTN44    // Potion of Strength
    SCRL66    // Grease
    SCRL67    // Armor
    SCRL68    // Burning Hands
    SCRL69    // Charm Person
    SCRL70    // Color Spray
    SCRL71    // Blindness
    SCRL72    // Friends
    SCRL73    // Protection From Petrification
    SCRL75    // Identify
    SCRL76    // Infravision
    SCRL77    // Magic Missile
    SCRL78    // Protection From Evil
    SCRL79    // Shield
    SCRL80    // Shocking Grasp
    SCRL81    // Sleep
    SCRL82    // Chill Touch
    SCRL83    // Chromatic Orb
    SCRL84    // Larloch's Minor Drain
    SCRL85    // Blur
    SCRL86    // Detect Evil
    SCRL87    // Detect Invisibilty
    SCRL89    // Horror
    SCRL90    // Invisibilty
    SCRL91    // Knock
    SCRL92    // Know Alignment
    SCRL93    // Luck
    SCRL94    // Resist Fear
    SCRL95    // Melf's Acid Arrow
    SCRL96    // Mirror Image
    SCRL97    // Stinking Cloud
    SCRL98    // Strength
    SCRL99    // Web
    SCRL1B    // Agannazar's Scorcher
    SCRL1C    // Ghoul Touch
    SCRL3G    // Vocalize
    SCRL1D    // Clairvoyance
    SCRL1E    // Dispel Magic
    SCRL1F    // Flame Arrow
    SCRL1G    // Fireball
    SCRL1H    // Haste
    SCRL1I    // Hold Person
    SCRL1J    // Invisibility 10' Radius
    SCRL1K    // Lightning Bolt
    SCRL1L    // Monster Summoning I
    SCRL1M    // Non-Detection
    SCRL1N    // Protection From Normal Missiles
    SCRL1O    // Slow
    SCRL1P    // Skull Trap
    SCRL1Q    // Vampiric Touch
    SCRL1S    // Dire Charm
    SCRL1T    // Ghost Armor
    SCRL1U    // Confusion
    SCRL1W    // Fireshield (Blue)
    SCRL1V    // Stoneskin
    SCRL1X    // Ice Storm
    SCRL1Y    // Improved Invisibility
    SCRL1Z    // Minor Globe of Invulnerability
    SCRL2A    // Monster Summoning II
    SCRL2B    // Stoneskin
    SCRL2D    // Animate Dead
    SCRL2E    // Cloudkill
    SCRL2F    // Cone of Cold
    SCRL2G    // Monster Summoning III
    SCRL2H    // Shadow Door
    SCRL5H    // Emotion
    SCRL5I    // Greater Malison
    SCRL5J    // Oliluke's Resilient Sphere
    SCRL5K    // Spirit Armor
    SCRL5L    // Polymorph Other
    SCRL5M    // Polymorph Self
    SCRL5N    // Domination
    SCRL5O    // Hold Monster
    SCRL5P    // Chaos
    SCRL5Q    // Feeblemind
    SCRL5T    // Protection from Electricity
    SCRL5U    // Reflected Image
    SCRL6U    // Breach
    SCRL7L    // Pierce Magic
    RESTORE   // Restoration
    SCRLPET   // Stone to Flesh Scroll
    DART02    // Dart +1
    XBOW15    // Firetooth +4
    SW1H58    // Short Sword of Mask +4
    BAG02G    // Gem bag
    BAG06B    // Potion Case

  LPF store INT_VAR
    sell=155
    buy=10
    steal=0
    fence=0 // or maybe she should? those folks didn't seem to be visiting civilization in the most recent past
  END

  LPF temple INT_VAR
    cure_light_wounds=25
    dispel_magic=200
    remove_curse=500
    cure_medium_wounds=50
    cure_disease=300
    cure_serious_wounds=75
    neutralize_poison=300
    lesser_restoration=750
    cure_critical_wounds=100
    raise_dead=1000
    mass_cure= comp_atweaks_temples=1 ? 1000 : 0
    heal=1000
    resurrection=2000
    greater_restoration=2000
  END

  ADD_STORE_ITEM AROW01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED  // Arrows
  ADD_STORE_ITEM AROW02   LAST #40 #0 #0 IDENTIFIED #5   // Arrows +1
  ADD_STORE_ITEM BOLT01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED  // Bolt
  ADD_STORE_ITEM BOLT02   LAST #40 #0 #0 IDENTIFIED #5   // Bolt +1
  ADD_STORE_ITEM BULL01   LAST #40 #0 #0 IDENTIFIED #1 UNLIMITED  // Bullet
  ADD_STORE_ITEM BULL02   LAST #40 #0 #0 IDENTIFIED #5   // Bullet +1

  ADD_STORE_ITEM SW1H01   LAST #0 #0 #0 IDENTIFIED #2   // Bastard Sword 
  ADD_STORE_ITEM SW1H02   LAST #0 #0 #0 IDENTIFIED #1   // Bastard Sword +1
  ADD_STORE_ITEM SW1H42   LAST #0 #0 #0 IDENTIFIED #1   // Bastard Sword +2
  ADD_STORE_ITEM SW1H72   LAST #0 #0 #0 IDENTIFIED #1   // Bastard Sword +3

  ADD_STORE_ITEM SHLD05   LAST #0 #0 #0 IDENTIFIED #1   // Large Shield
  ADD_STORE_ITEM SHLD06   LAST #0 #0 #0 IDENTIFIED #1   // Large Shield +1
  ADD_STORE_ITEM SHLD30   LAST #0 #0 #0 IDENTIFIED #1   // Large Shield +2

  ADD_STORE_ITEM helm10   LAST #0 #0 #0 IDENTIFIED #1   // helmet
  ADD_STORE_ITEM helm11   LAST #0 #0 #0 IDENTIFIED #2   // helmet

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #20  // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #10  // Potion of Extra Healing
  ADD_STORE_ITEM POTN55   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Superior Healing
  ADD_STORE_ITEM POTN09   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Heroism
  ADD_STORE_ITEM POTN44   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Strength

  ADD_STORE_ITEM SCRL67   LAST #1 #0 #0 IDENTIFIED #3   // Armor
  ADD_STORE_ITEM SCRL73   LAST #1 #0 #0 IDENTIFIED #3   // Protection From Petrification
  ADD_STORE_ITEM SCRL78   LAST #1 #0 #0 IDENTIFIED #3   // Protection From Evil
  ADD_STORE_ITEM SCRL79   LAST #1 #0 #0 IDENTIFIED #3   // Shield
  ADD_STORE_ITEM SCRL86   LAST #1 #0 #0 IDENTIFIED #3   // Detect Evil
  ADD_STORE_ITEM SCRL87   LAST #1 #0 #0 IDENTIFIED #3   // Detect Invisibilty
  ADD_STORE_ITEM SCRL92   LAST #1 #0 #0 IDENTIFIED #3   // Know Alignment
  ADD_STORE_ITEM SCRL94   LAST #1 #0 #0 IDENTIFIED #3   // Resist Fear
  ADD_STORE_ITEM SCRL98   LAST #1 #0 #0 IDENTIFIED #3   // Strength
  ADD_STORE_ITEM SCRL1D   LAST #1 #0 #0 IDENTIFIED #2   // Clairvoyance
  ADD_STORE_ITEM SCRL1E   LAST #1 #0 #0 IDENTIFIED #2   // Dispel Magic
  ADD_STORE_ITEM SCRL1N   LAST #1 #0 #0 IDENTIFIED #2   // Protection From Normal Missiles
  ADD_STORE_ITEM SCRL1Z   LAST #1 #0 #0 IDENTIFIED #1   // Minor Globe of Invulnerability
  ADD_STORE_ITEM SCRL2B   LAST #1 #0 #0 IDENTIFIED #1   // Stoneskin
  ADD_STORE_ITEM SCRL5T   LAST #1 #0 #0 IDENTIFIED #1   // Protection from Electricity
  ADD_STORE_ITEM SCRL6U   LAST #1 #0 #0 IDENTIFIED #1   // Breach
  ADD_STORE_ITEM SCRL7L   LAST #1 #0 #0 IDENTIFIED #1   // Pierce Magic

  ADD_STORE_ITEM RESTORE  LAST #1 #0 #0 IDENTIFIED #3   // Restoration
  ADD_STORE_ITEM SCRL63   LAST #1 #0 #0 IDENTIFIED #3   // Raise Dead
  ADD_STORE_ITEM SCRLPET  LAST #1 #0 #0 IDENTIFIED #3   // Stone to Flesh Scroll

  ADD_STORE_ITEM SHLD23   LAST #0 #0 #0 IDENTIFIED #1   // Fortress Shield +3
  ADD_STORE_ITEM XBOW15   LAST #0 #0 #0 IDENTIFIED #1   // Firetooth +4
  ADD_STORE_ITEM SW1H66   LAST #0 #0 #0 IDENTIFIED #1   // Yamato +4
  ADD_STORE_ITEM BAG02G   LAST #0 #0 #0 IDENTIFIED #1   // Gem bag
  ADD_STORE_ITEM BAG06B   LAST #0 #0 #0 IDENTIFIED #1   // Potion Case

  ADD_STORE_ITEM ~ag#ir03~  LAST #1 #0 #0 IDENTIFIED #4   // Armor of Faith
  ADD_STORE_ITEM ~ag#ir01~  LAST #1 #0 #0 IDENTIFIED #4   // Bless
  ADD_STORE_ITEM ~ag#ir02~  LAST #1 #0 #0 IDENTIFIED #4   // Sanctuary
  ADD_STORE_ITEM ~ag#ir04~  LAST #1 #0 #0 IDENTIFIED #4   // Chant
  ADD_STORE_ITEM ~ag#ir08~  LAST #1 #0 #0 IDENTIFIED #4   // Draw Upon Holy Might
  ADD_STORE_ITEM ~ag#ir05~  LAST #1 #0 #0 IDENTIFIED #4   // Find Traps
  ADD_STORE_ITEM ~ag#ir06~  LAST #1 #0 #0 IDENTIFIED #4   // Silence
  ADD_STORE_ITEM ~ag#ir0b~  LAST #1 #0 #0 IDENTIFIED #3   // Remove Curse/Break Enchantment
  ADD_STORE_ITEM scrl56     LAST #1 #0 #0 IDENTIFIED #3   // cure serious wounds
  ADD_STORE_ITEM ~ag#ir09~  LAST #1 #0 #0 IDENTIFIED #3   // Dispel Magic
  ADD_STORE_ITEM ~ag#ir0a~  LAST #1 #0 #0 IDENTIFIED #3   // Glyph of Warding
  ADD_STORE_ITEM ~ag#ir0c~  LAST #1 #0 #0 IDENTIFIED #3   // Remove Paralysis
  ADD_STORE_ITEM scrl61     LAST #1 #0 #0 IDENTIFIED #3   // cure critical wounds
  ADD_STORE_ITEM scrl5b     LAST #1 #0 #0 IDENTIFIED #3   // defensive harmony
  ADD_STORE_ITEM scrl5d     LAST #1 #0 #0 IDENTIFIED #3   // protection from evil 10' radius
  ADD_STORE_ITEM scrl5e     LAST #1 #0 #0 IDENTIFIED #2   // champion's strength
  ADD_STORE_ITEM ~ag#ir0f~  LAST #1 #0 #0 IDENTIFIED #2   // Magic Resistance
  ADD_STORE_ITEM scrl5c     LAST #1 #0 #0 IDENTIFIED #2   // protection from lightning
  ADD_STORE_ITEM ~ag#ir07~  LAST #1 #0 #0 IDENTIFIED #2   // True Sight
  ADD_STORE_ITEM ~ag#ir0h~  LAST #1 #0 #0 IDENTIFIED #1   // Aerial Servant
  ADD_STORE_ITEM ~ag#ir0i~  LAST #1 #0 #0 IDENTIFIED #1   // Blade Barrier
  ADD_STORE_ITEM ~ag#ir0k~  LAST #1 #0 #0 IDENTIFIED #1   // Bolt of Glory
  ADD_STORE_ITEM ~ag#ir0j~  LAST #1 #0 #0 IDENTIFIED #1   // Heal

END BUT_ONLY

///////////////////////////////////////////////////////////////////

///////////////////
// New Additions //
///////////////////

///////////////////////////

// Order of the Radiant Heart
//
// Only for members, paladin PCs with >16 reputation, good aligned PCs with 20 reputation

<<<<<<<<ag#inlined/hprelate.d
APPEND hprelate

IF ~~ BEGIN member
SAY @200200
IF ~~ THEN DO ~StartStore("ag#ir01",LastTalkedToBy())~ EXIT
END

IF ~~ BEGIN paladin
SAY @200201
IF ~~ THEN DO ~StartStore("ag#ir01",LastTalkedToBy())~ EXIT
END

IF ~~ BEGIN good_highrep
SAY @200202
IF ~~ THEN DO ~StartStore("ag#ir01",LastTalkedToBy())~ EXIT
END

IF ~~ BEGIN neutral_lowrep
SAY @200203
IF ~~ THEN EXIT
END

END


ALTER_TRANS hprelate
BEGIN 62 64 END
BEGIN 0 END
BEGIN
  "EPILOGUE" ~GOTO 24~
END


EXTEND_BOTTOM hprelate 24
// member
+~Global("PaladinOrder","GLOBAL",1)~+ @200204 + member
// paladin & !member & rep>16
+~Class(Player1,PALADIN_ALL)
  !Global("PaladinOrder","GLOBAL",1)
  !Global("PaladinOrder","GLOBAL",3)
  ReputationGT(Player1,16)~+ @200204 + paladin
// !paladin & good & rep=20
+~!Class(Player1,PALADIN_ALL)
  Alignment(Player1,MASK_GOOD)
  Reputation(Player1,20)~+ @200204 + good_highrep
// rep>10 & ( (paladin & !member & rep<17) | (!paladin & good & rep<20) | neutral )
+~ReputationGT(Player1,9)
  !Global("PaladinOrder","GLOBAL",3)
  OR(3)
    Class(Player1,PALADIN_ALL)
    !Class(Player1,PALADIN_ALL)
    Alignment(Player1,MASK_GENEUTRAL)
  OR(3)
    Class(Player1,PALADIN_ALL)
    Alignment(Player1,MASK_GOOD)
    Alignment(Player1,MASK_GENEUTRAL)
  OR(3)
    Class(Player1,PALADIN_ALL)
    ReputationLT(Player1,20)
    Alignment(Player1,MASK_GENEUTRAL)
  OR(3)
    !Global("PaladinOrder","GLOBAL",1)
    !Class(Player1,PALADIN_ALL)
    Alignment(Player1,MASK_GENEUTRAL)
  OR(3)
    !Global("PaladinOrder","GLOBAL",1)
    Alignment(Player1,MASK_GOOD)
    Alignment(Player1,MASK_GENEUTRAL)
  OR(3)
    !Global("PaladinOrder","GLOBAL",1)
    ReputationLT(Player1,20)
    Alignment(Player1,MASK_GENEUTRAL)
  OR(3)
    ReputationLT(Player1,17)
    !Class(Player1,PALADIN_ALL)
    Alignment(Player1,MASK_GENEUTRAL)
  OR(3)
    ReputationLT(Player1,17)
    Alignment(Player1,MASK_GOOD)
    Alignment(Player1,MASK_GENEUTRAL)
  OR(3)
    ReputationLT(Player1,17)
    ReputationLT(Player1,20)
    Alignment(Player1,MASK_GENEUTRAL)~+ @200204 + neutral_lowrep
END
>>>>>>>>
COMPILE ~ag#inlined/hprelate.d~


<<<<<<<<ag#dummy
>>>>>>>>
COPY ag#dummy ~override/ag#ir01.sto~
INSERT_BYTES 0 0x9c
WRITE_ASCII 0 ~STORV1.0~
WRITE_BYTE 0x10 1
WRITE_LONG 0x2c 0x9c
WRITE_LONG 0x34 0x9c
WRITE_LONG 0x4c 0x9c
WRITE_LONG 0x70 0x9c


// remove Wyrmcleaver from Unseeing Eye's lair
COPY_EXISTING ar0205.are override PATCH_IF SOURCE_SIZE>0x11c BEGIN
  LPF DELETE_AREA_ITEM STR_VAR item_to_delete=halb04 END
END BUT_ONLY


COPY_EXISTING ag#ir01.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  LPF buy END

  LPF store INT_VAR
    sell=145
    steal=0
  END

  SAY 0xc @200205 // Order of the Radiant Heart

  ADD_STORE_ITEM SW1H41   LAST #0 #0 #0 IDENTIFIED #1   // Long Sword +2
  ADD_STORE_ITEM SW2H11   LAST #0 #0 #0 IDENTIFIED #1   // Two Handed Sword +2
  ADD_STORE_ITEM AX1H11   LAST #0 #0 #0 IDENTIFIED #1   // Battle Axe +2
  ADD_STORE_ITEM SPER05   LAST #0 #0 #0 IDENTIFIED #1   // Spear +2
  ADD_STORE_ITEM HALB07   LAST #0 #0 #0 IDENTIFIED #1   // Halberd +2
  ADD_STORE_ITEM BLUN21   LAST #0 #0 #0 IDENTIFIED #1   // Mace +2
  ADD_STORE_ITEM BLUN15   LAST #0 #0 #0 IDENTIFIED #1   // Morning Star +2
  ADD_STORE_ITEM HAMM08   LAST #0 #0 #0 IDENTIFIED #1   // War Hammer +2
  ADD_STORE_ITEM XBOW07   LAST #0 #0 #0 IDENTIFIED #1   // Heavy Crossbow +2
  ADD_STORE_ITEM XBOW09   LAST #0 #0 #0 IDENTIFIED #1   // Light Crossbow +2
  ADD_STORE_ITEM CHAN08   LAST #0 #0 #0 IDENTIFIED #1   // Chain Mail +2
  ADD_STORE_ITEM PLAT10   LAST #0 #0 #0 IDENTIFIED #1   // Plate Mail +2
  ADD_STORE_ITEM PLAT14   LAST #0 #0 #0 IDENTIFIED #1   // Full Plate Mail +1
  ADD_STORE_ITEM SHLD29   LAST #0 #0 #0 IDENTIFIED #1   // Medium Shield +2
  ADD_STORE_ITEM SHLD30   LAST #0 #0 #0 IDENTIFIED #1   // Large Shield +2

  ADD_STORE_ITEM SCRLPET  LAST #1 #0 #0 IDENTIFIED #1   // Stone to Flesh Scroll
  ADD_STORE_ITEM RESTORE  LAST #1 #0 #0 IDENTIFIED #3   // Restoration
  ADD_STORE_ITEM SCRL63   LAST #1 #0 #0 IDENTIFIED #3   // Raise Dead
  ADD_STORE_ITEM SCRL09   LAST #1 #0 #0 IDENTIFIED #2   // Protection from Undead

  ADD_STORE_ITEM BOLT02   LAST #40 #0 #0 IDENTIFIED #4  // Bolt +1
  ADD_STORE_ITEM BOLT06   LAST #20 #0 #0 IDENTIFIED #3  // Bolt +2
  PATCH_IF comp_ir=1 BEGIN
    ADD_STORE_ITEM BOLT05   LAST #10 #0 #0 IDENTIFIED #2  // Blessed Bolt
  END

  ADD_STORE_ITEM POTN08   LAST #1 #0 #0 IDENTIFIED #25  // Potion of Healing
  ADD_STORE_ITEM POTN52   LAST #1 #0 #0 IDENTIFIED #8   // Potion of Extra Healing
  ADD_STORE_ITEM POTN55   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Superior Healing
  ADD_STORE_ITEM POTN17   LAST #1 #0 #0 IDENTIFIED #3   // Elixir of Health
  ADD_STORE_ITEM POTN44   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Strength
  ADD_STORE_ITEM POTN28   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Fortitude
  ADD_STORE_ITEM POTN43   LAST #1 #0 #0 IDENTIFIED #3   // Potion of Insight 
  ADD_STORE_ITEM POTN03   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Hill Giant Strength
  ADD_STORE_ITEM POTN09   LAST #1 #0 #0 IDENTIFIED #5   // Potion of Heroism
  ADD_STORE_ITEM POTN24   LAST #1 #0 #0 IDENTIFIED #2   // Potion of Defense
  ADD_STORE_ITEM POTN11   LAST #1 #0 #0 IDENTIFIED #1   // Potion of Invulnerability

  ADD_STORE_ITEM AX1H10   LAST #0 #0 #0 IDENTIFIED #1   // Azuredge
  ADD_STORE_ITEM HELM06   LAST #0 #0 #0 IDENTIFIED #1   // Helm of Charm Protection
  ADD_STORE_ITEM plat09   LAST #0 #0 #0 IDENTIFIED #1   // Mithral Field Plate Mail +2
  ADD_STORE_ITEM halb04   LAST #0 #0 #0 IDENTIFIED #1   // Wyrmcleaver +3
  ADD_STORE_ITEM SW2H07   LAST #0 #0 #0 IDENTIFIED #1   // Harbinger +3

END BUT_ONLY

//////////////
// Dump Can //
//////////////

/////////////////

// WMART1 - Joluv
// 
// most of bonus merchant stuff is unavailable within IR v3 - due to the lack of unique
// BAMs and concepts, - but if somebody wants them anyway, then go ahead and install Joluv
// with BG2Tweakpack or similar. he'll have all the trash left untouched by us

COPY_EXISTING wmart1.sto override PATCH_IF SOURCE_SIZE>0x9b BEGIN
  REMOVE_STORE_ITEM 
    WAWAK     // Kachiko's Wakizashi +3
    WAFLAIL   // Defender of Easthaven +2

  ADD_STORE_ITEM WA2AMU   LAST #1 #0 #0 IDENTIFIED #0   // Sensate Amulet
  ADD_STORE_ITEM WA2HARP  LAST #1 #0 #0 IDENTIFIED #3   // Harp of Pandemonium
  ADD_STORE_ITEM WA2HALB  LAST #1 #0 #0 IDENTIFIED #0   // Harmonium Halberd
  ADD_STORE_ITEM WA2RING  LAST #1 #0 #0 IDENTIFIED #0   // Mercykiller Ring

END BUT_ONLY

///////////////////////////////////////////////////////////////////













